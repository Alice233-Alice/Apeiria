const e=z,r=['ç»ƒæ°”','ç­‘åŸº','é‡‘ä¸¹','å…ƒå©´','åŒ–ç¥','ç‚¼è™š','åˆä½“','å¤§ä¹˜','æ¸¡åŠ«'],t=['åˆæœŸ','ä¸­æœŸ','åæœŸ','å¤§åœ†æ»¡'],n=[100,100,100,100,200,200,200,200,400,400,400,400,800,800,800,800,1600,1600,1600,1600,3200,3200,3200,3200,6400,6400,6400,6400,12800,12800,12800,12800,25600,25600,25600,25600],s=[100,100,100,100,200,200,200,200,500,500,500,500,1e3,1e3,1e3,1e3,2e3,2e3,2e3,2e3,5e3,5e3,5e3,5e3,1e4,1e4,1e4,1e4,5e4,5e4,5e4,5e4,1e5,1e5,1e5,1e5],o=e.z.object({åç§°:e.z.string().prefault(''),æè¿°:e.z.string().prefault(''),å“é˜¶:e.z.string().prefault(''),æ•°é‡:e.z.coerce.number().transform(e=>Math.max(1,e)).prefault(1)}),a=e.z.object({åœ°:e.z.string().describe('æ‰€åœ¨åœ°'),ç‰¹:e.z.string().describe('æ ¸å¿ƒç‰¹ç‚¹'),åŠ›:e.z.string().describe('æœ€é«˜æˆ˜åŠ›'),è¥:e.z.enum(['æ­£','é­”','ä¸­']),æ¨¡:e.z.enum(['è¶…å¤§','å¤§','å°','å¾®','ç‰¹'])}),c=e.z.object({é˜¶:e.z.enum(['å‡¡','é»„','ç„','åœ°','å¤©','ä»™','åœ£']),æ€§:e.z.string().describe('å±æ€§'),æ•ˆ:e.z.string().describe('æ•ˆæœ')}),l=e.z.object({é˜¶:e.z.enum(['å‡¡å™¨','æ³•å™¨','çµå™¨','æ³•å®','çµå®','ä»™å™¨','åœ£å™¨','é“å™¨']),ç±»:e.z.string().describe('ç±»å‹')}).transform(e=>({...e,ç‰¹:'ä»™å™¨'===e.é˜¶?'é¡¶çº§':'çµå®'===e.é˜¶?'å¼º':'æ³•å®'===e.é˜¶?'ä¸­':'æ™®é€š'})),i=e.z.object({åŸŸ:e.z.enum(['å¤©å±‚','ç¥å·','ä¸œè‹','å—ç‚','è¥¿åºš','åŒ—å†¥','ä¸‹å±‚','å››æµ·']),ç±»:e.z.enum(['ç§˜å¢ƒ','åŸé•‡','å®—é—¨','ç¦åœ°','é—è¿¹','åœ°å½¢']),å±:e.z.coerce.number().transform(e=>_.clamp(e,0,100)),ç‰¹:e.z.string().describe('ç‰¹ç‚¹'),èµ„:e.z.array(e.z.string()).prefault([])}),u=e.z.object({è´¨:e.z.enum(['åŠ£','ä¸‹','ä¸­','ä¸Š','æ','å¤©','å¼‚']),æ€§:e.z.string().describe('å±æ€§'),ç¨€:e.z.enum(['å¸¸','å°‘','ç½•','ç¨€','ä¼ '])}).transform(e=>({...e,é€Ÿ:{åŠ£:'0.3å€',ä¸‹:'0.5å€',ä¸­:'1å€',ä¸Š:'2å€',æ:'3å€',å¤©:'5å€',å¼‚:'4å€'}[e.è´¨]||'1å€',ç‰¹:'å¤©'===e.è´¨?'å•ç³»é¡¶çº§':'å¼‚'===e.è´¨?'å˜å¼‚ç¨€æœ‰':'æ'===e.è´¨?'åŒç³»ä¼˜ç§€':'å¸¸è§„'})),g=e.z.object({è´¨:e.z.enum(['å‡¡','çµ','é“','åœ£','ç¥']),ç‰¹:e.z.string().describe('ç‰¹æ€§'),ç¨€:e.z.enum(['å¸¸','å°‘','ç½•','ç¨€','ä¼ '])}).transform(e=>({...e,ä¼˜:'ç¥'===e.è´¨?'è‡³é«˜':'åœ£'===e.è´¨?'æå¼º':'é“'===e.è´¨?'å¼º':'çµ'===e.è´¨?'ä¸­':'æ— '})),f=e.z.object({ä¸–ç•Œæ—¶é’Ÿ:e.z.object({çºªå…ƒ:e.z.string().prefault('æœ«æ³•æ—¶ä»£'),å¹´ä»½:e.z.coerce.number().prefault(1),æœˆä»½:e.z.coerce.number().transform(e=>_.clamp(e,1,12)).prefault(1),æ—¥æœŸ:e.z.coerce.number().transform(e=>_.clamp(e,1,30)).prefault(1),æ—¶è¾°:e.z.string().prefault('å­æ—¶')}).prefault({çºªå…ƒ:'æœ«æ³•æ—¶ä»£',å¹´ä»½:1,æœˆä»½:1,æ—¥æœŸ:1,æ—¶è¾°:'å­æ—¶'}),ä¸–ç•Œåœ°å›¾:e.z.record(e.z.string().describe('åŒºåŸŸå'),e.z.object({layer:e.z.enum(['å¤©å±‚','åœ°å±‚','ä¸‹å±‚']).prefault('åœ°å±‚'),danger:e.z.coerce.number().transform(e=>_.clamp(e,0,100)),desc:e.z.string().prefault(''),connections:e.z.array(e.z.string()).prefault([])})).prefault({}),ä¸–ç•Œå›¾å¿—:e.z.record(e.z.string().describe('äº‹ä»¶å'),e.z.object({çŠ¶æ€:e.z.string().prefault(''),äº‹ä»¶:e.z.string().prefault('')})).prefault({}),å®—é—¨åŠ¿åŠ›åº“:e.z.record(e.z.string().describe('å®—é—¨å'),a).prefault({å‰‘é˜:{åœ°:'ç¥å·å‰‘é—¨å…³',ç‰¹:'å‰‘é“æºå¤´',åŠ›:'æ¸¡åŠ«åæœŸ',è¥:'æ­£',æ¨¡:'è¶…å¤§'},ä¸‡æ³•å®—:{åœ°:'ç¥å·é—®é“å³°',ç‰¹:'ä¸‡æ³•æœ¬æº',åŠ›:'æ¸¡åŠ«åˆæœŸ',è¥:'æ­£',æ¨¡:'è¶…å¤§'},é‡‘åˆšå¯º:{åœ°:'è¥¿å¤©ä½›å±±',ç‰¹:'ä½›ä¿®ç‚¼ä½“',åŠ›:'å¤§ä¹˜ä¸­æœŸ',è¥:'æ­£',æ¨¡:'å¤§'},è¯ç‹è°·:{åœ°:'ç¥å†œæ¶',ç‰¹:'åŒ»ç‚¼ä¸¹è¯',åŠ›:'å¤§ä¹˜åˆæœŸ',è¥:'æ­£',æ¨¡:'å¤§'},å„’é—¨:{åœ°:'æ–‡åœ£å±±',ç‰¹:'æµ©ç„¶æ­£æ°”',åŠ›:'å¤§ä¹˜ä¸­æœŸ',è¥:'æ­£',æ¨¡:'å¤§'},é’é¾™æ®¿:{åœ°:'ä¸œè‹é’é¾™å±±',ç‰¹:'å®ˆæŠ¤é’å¸',åŠ›:'å¤§ä¹˜åˆæœŸ',è¥:'æ­£',æ¨¡:'å¤§'},ç„æ­¦å®—:{åœ°:'åŒ—å†¥ç„å†°å±±',ç‰¹:'é•‡å®ˆå½’å¢Ÿ',åŠ›:'å¤§ä¹˜åæœŸ',è¥:'æ­£',æ¨¡:'å¤§'},å»ºæœ¨å®—:{åœ°:'ä¸œè‹å»ºæœ¨æ ‘',ç‰¹:'æœ¨ç³»é“æ³•',åŠ›:'åˆä½“ä¸­æœŸ',è¥:'æ­£',æ¨¡:'å°'},ç™¾èŠ±è°·:{åœ°:'ç™¾èŠ±ç§˜å¢ƒ',ç‰¹:'å¥³ä¿®èŠ±é“',åŠ›:'åˆä½“åæœŸ',è¥:'æ­£',æ¨¡:'å°'},è¡€ç¥æ•™:{åœ°:'è¡€é­”æ¸Š',ç‰¹:'è¡€é“ç‚¼æ³•',åŠ›:'æ¸¡åŠ«ä¸­æœŸ',è¥:'é­”',æ¨¡:'è¶…å¤§'},å¤©é­”å®—:{åœ°:'å¤©é­”å±±',ç‰¹:'å¤©é­”å¤§é“',åŠ›:'å¤§ä¹˜ä¸­æœŸ',è¥:'é­”',æ¨¡:'å¤§'},å¦–ç›Ÿ:{åœ°:'ä¸‡å¦–æ£®æ—',ç‰¹:'å¦–æ—è”ç›Ÿ',åŠ›:'æ¸¡åŠ«ä¸­æœŸ',è¥:'ä¸­',æ¨¡:'è¶…å¤§'},å¤§å¤ç‹æœ:{åœ°:'ä¸­å·çš‡åŸ',ç‰¹:'ä¸–ä¿—ç»Ÿæ²»',åŠ›:'å¤§ä¹˜åˆæœŸ',è¥:'ä¸­',æ¨¡:'å¤§'},ä¹å·å•†ä¼š:{åœ°:'ä¹å¤§ä¸»åŸ',ç‰¹:'å•†ä¸šè”ç›Ÿ',åŠ›:'å¤§ä¹˜åˆæœŸ',è¥:'ä¸­',æ¨¡:'å¤§'},ç¦»ç«å®«:{åœ°:'å—ç‚ç«å±±',ç‰¹:'æœ±é›€ä¾›å¥‰',åŠ›:'åˆä½“åœ†æ»¡',è¥:'ä¸­',æ¨¡:'å°'},é“¸å‰‘å±±åº„:{åœ°:'å—ç‚åœ°ç«',ç‰¹:'ç‚¼å™¨ç¬¬ä¸€',åŠ›:'åˆä½“åæœŸ',è¥:'ä¸­',æ¨¡:'å°'}}),åŠŸæ³•åº“:e.z.record(e.z.string().describe('åŠŸæ³•å'),c).prefault({å¼•æ°”è¯€:{é˜¶:'å‡¡',æ€§:'é€šç”¨',æ•ˆ:'å…¥é—¨'},ç­‘åŸºçœŸè§£:{é˜¶:'ç„',æ€§:'é€šç”¨',æ•ˆ:'ç­‘åŸº'},é‡‘ä¸¹å¤§é“:{é˜¶:'åœ°',æ€§:'é€šç”¨',æ•ˆ:'ç»“ä¸¹'},ä¸‡å‰‘å½’å®—è¯€:{é˜¶:'å¤©',æ€§:'é‡‘å‰‘',æ•ˆ:'å‰‘é˜é•‡å®—'},å»ºæœ¨é€šå¤©è¯€:{é˜¶:'å¤©',æ€§:'æœ¨',æ•ˆ:'å»ºæœ¨é•‡å®—'},åŒ—å†¥çœŸç»:{é˜¶:'å¤©',æ€§:'æ°´',æ•ˆ:'ç„æ­¦åå™¬'},æœ±é›€æ¶…æ§ƒç»:{é˜¶:'å¤©',æ€§:'ç«',æ•ˆ:'ç¦»ç«æ¶…æ§ƒ'},ä¸åŠ¨æ˜ç‹èº«:{é˜¶:'å¤©',æ€§:'åœŸä½›',æ•ˆ:'é‡‘åˆšé˜²å¾¡'},ä¸‡æœ¨æœå®—:{é˜¶:'ä»™',æ€§:'æœ¨',æ•ˆ:'é’å¸é—æ³•'},æµ·çº³ç™¾å·:{é˜¶:'ä»™',æ€§:'æ°´',æ•ˆ:'å½’å¢Ÿæœ¬æº'},ç¥èç¥ç«:{é˜¶:'ä»™',æ€§:'ç«',æ•ˆ:'ç«ç¥é—æ³•'},è½®å›ç»:{é˜¶:'ä»™',æ€§:'è½®å›',æ•ˆ:'{{user}}ä¸“å±'},æ–©è½®å›å‰‘å…¸:{é˜¶:'ä»™',æ€§:'å‰‘è½®å›',æ•ˆ:'{{user}}å‰ä¸–'},å‰‘æ„é€šç¥:{é˜¶:'ä»™',æ€§:'å‰‘é“',æ•ˆ:'å‰‘æ„åŒ–å½¢'},ä¹å¤©é›·ç¥è¯€:{é˜¶:'å¤©',æ€§:'é›·',æ•ˆ:'é›·éœ†'},è™šç©ºç»:{é˜¶:'å¤©',æ€§:'ç©ºé—´',æ•ˆ:'ç©ºé—´'},ä¸‡æ³•å½’å®—:{é˜¶:'å¤©',æ€§:'é€šç”¨',æ•ˆ:'æ¨¡æ‹Ÿ'},åŒ»ä»™å®å…¸:{é˜¶:'å¤©',æ€§:'åŒ»é“',æ•ˆ:'åŒ»é“'},å¤©é­”ç­–:{é˜¶:'å¤©',æ€§:'é­”é“',æ•ˆ:'é€Ÿæˆ'}}),æ³•å®åº“:e.z.record(e.z.string().describe('æ³•å®å'),l).prefault({é•‡æ¸Šå‰‘:{é˜¶:'ä»™å™¨',ç±»:'å‰‘'},åŒé±¼ä½©:{é˜¶:'ä»™å™¨',ç±»:'æŠ¤èº«'},é’é”‹å‰‘:{é˜¶:'æ³•å™¨',ç±»:'å‰‘'},å‚¨ç‰©æˆ’:{é˜¶:'çµå™¨',ç±»:'å‚¨ç‰©'},é’é¾™å‰‘:{é˜¶:'çµå®',ç±»:'å‰‘'},ç™½è™å‰‘:{é˜¶:'çµå®',ç±»:'å‰‘'},æœ±é›€å‰‘:{é˜¶:'çµå®',ç±»:'å‰‘'},ç„æ­¦å‰‘:{é˜¶:'çµå®',ç±»:'å‰‘'}}),åœ°ç‚¹åº“:e.z.record(e.z.string().describe('åœ°ç‚¹å'),i).prefault({å¤©æ¸Š:{åŸŸ:'å¤©å±‚',ç±»:'ç¦åœ°',å±:95,ç‰¹:'æ˜Ÿè¾°è£‚éš™',èµ„:['æ˜Ÿè¾°ç¢ç‰‡','é™¨é“']},ç½¡é£å¸¦:{åŸŸ:'å¤©å±‚',ç±»:'ç¦åœ°',å±:90,ç‰¹:'ç½¡é£å±éšœ',èµ„:['ç½¡é£ç²¾å']},é—®é“å³°:{åŸŸ:'ç¥å·',ç±»:'å®—é—¨',å±:10,ç‰¹:'ä¸‡æ³•å®—',èµ„:['åŠŸæ³•','çµè¯']},å‰‘é—¨å…³:{åŸŸ:'ç¥å·',ç±»:'å®—é—¨',å±:15,ç‰¹:'å‰‘é˜',èµ„:['å‰‘æ„','é£å‰‘']},è—ä¹¦é˜:{åŸŸ:'ç¥å·',ç±»:'å®—é—¨',å±:5,ç‰¹:'å¤ç±',èµ„:['åŠŸæ³•','ç§˜æœ¯']},é…†éƒ½åŸ:{åŸŸ:'ç¥å·',ç±»:'åŸé•‡',å±:30,ç‰¹:'é¬¼å¸‚',èµ„:['å¹½å†¥ææ–™']},é¾™é—¨ç€‘:{åŸŸ:'ç¥å·',ç±»:'ç§˜å¢ƒ',å±:40,ç‰¹:'åŒ–é¾™',èµ„:['é¾™æ°”']},å»ºæœ¨æ—:{åŸŸ:'ä¸œè‹',ç±»:'åœ°å½¢',å±:50,ç‰¹:'å¤æ ‘ç²¾',èµ„:['çµæœ¨','å¦–ä¸¹']},é’å¸é™µ:{åŸŸ:'ä¸œè‹',ç±»:'é—è¿¹',å±:85,ç‰¹:'é’å¸ä¼ æ‰¿',èµ„:['é’å¸ä¼ æ‰¿']},ç™¾èŠ±å¢ƒ:{åŸŸ:'ä¸œè‹',ç±»:'ç§˜å¢ƒ',å±:20,ç‰¹:'èŠ±æµ·',èµ„:['çµèŠ±']},ä¸ç­ç«å±±:{åŸŸ:'å—ç‚',ç±»:'åœ°å½¢',å±:80,ç‰¹:'æœ±é›€æ¶…æ§ƒ',èµ„:['æœ±é›€ç«']},æ¶…æ§ƒå°:{åŸŸ:'å—ç‚',ç±»:'é—è¿¹',å±:70,ç‰¹:'æ¶…æ§ƒ',èµ„:['æ¶…æ§ƒæ„Ÿæ‚Ÿ']},ä¸‡å‰‘å†¢:{åŸŸ:'è¥¿åºš',ç±»:'ç¦åœ°',å±:85,ç‰¹:'å‰‘æ„',èµ„:['å‰‘æ„','å¤å‰‘']},ç„å†°å±±:{åŸŸ:'åŒ—å†¥',ç±»:'å®—é—¨',å±:50,ç‰¹:'ç„æ­¦å®—',èµ„:['ç„å†°']},å½’å¢Ÿçœ¼:{åŸŸ:'åŒ—å†¥',ç±»:'ç¦åœ°',å±:99,ç‰¹:'å½’å¢Ÿ',èµ„:['å½’å¢Ÿæ„Ÿæ‚Ÿ']},é»„æ³‰è¿¹:{åŸŸ:'ä¸‹å±‚',ç±»:'é—è¿¹',å±:90,ç‰¹:'å¹½å†¥',èµ„:['é»„æ³‰æ°´']},ç‚æ¸Š:{åŸŸ:'ä¸‹å±‚',ç±»:'ç¦åœ°',å±:95,ç‰¹:'åœ°å¿ƒç«',èµ„:['åœ°å¿ƒç«']}}),çµæ ¹åº“:e.z.record(e.z.string().describe('çµæ ¹å'),u).prefault({é‡‘å¤©æ ¹:{è´¨:'å¤©',æ€§:'é‡‘',ç¨€:'ä¼ '},æœ¨å¤©æ ¹:{è´¨:'å¤©',æ€§:'æœ¨',ç¨€:'ä¼ '},æ°´å¤©æ ¹:{è´¨:'å¤©',æ€§:'æ°´',ç¨€:'ä¼ '},ç«å¤©æ ¹:{è´¨:'å¤©',æ€§:'ç«',ç¨€:'ä¼ '},åœŸå¤©æ ¹:{è´¨:'å¤©',æ€§:'åœŸ',ç¨€:'ä¼ '},ä¸‰çµæ ¹:{è´¨:'ä¸Š',æ€§:'ä¸‰ç³»',ç¨€:'ç½•'},å››çµæ ¹:{è´¨:'ä¸­',æ€§:'å››ç³»',ç¨€:'å°‘'},äº”è¡Œæ‚æ ¹:{è´¨:'ä¸‹',æ€§:'äº”è¡Œ',ç¨€:'å¸¸'},å†°æ ¹:{è´¨:'å¼‚',æ€§:'å†°',ç¨€:'ä¼ '},é›·æ ¹:{è´¨:'å¼‚',æ€§:'é›·',ç¨€:'ä¼ '},ç¦»ç«æ ¹:{è´¨:'å¼‚',æ€§:'ç¦»ç«',ç¨€:'ä¼ '},ç©ºé—´æ ¹:{è´¨:'å¼‚',æ€§:'ç©ºé—´',ç¨€:'ä¼ '},æ—¶é—´æ ¹:{è´¨:'å¼‚',æ€§:'æ—¶é—´',ç¨€:'ä¼ '},æ··æ²Œæ ¹:{è´¨:'å¼‚',æ€§:'æ··æ²Œ',ç¨€:'ä¼ '},è½®å›æ ¹:{è´¨:'å¼‚',æ€§:'è½®å›',ç¨€:'ä¼ '}}),ä½“è´¨åº“:e.z.record(e.z.string().describe('ä½“è´¨å'),g).prefault({å‡¡ä½“:{è´¨:'å‡¡',ç‰¹:'æ™®é€š',ç¨€:'å¸¸'},ç„å†°ä½“:{è´¨:'çµ',ç‰¹:'å†°ç³»å¢å¼º',ç¨€:'ç½•'},ç¦»ç«ä½“:{è´¨:'çµ',ç‰¹:'ç«ç³»å¢å¼º',ç¨€:'ç½•'},æœ¨çµä½“:{è´¨:'çµ',ç‰¹:'æ¢å¤å¢å¼º',ç¨€:'ç½•'},å¤©ç±ä½“:{è´¨:'çµ',ç‰¹:'éŸ³å¾‹ç¥é€š',ç¨€:'ç½•'},èŠ±å¦–ä½“:{è´¨:'çµ',ç‰¹:'é­…æƒ‘æ§åˆ¶',ç¨€:'ç¨€'},æœ±é›€è„‰:{è´¨:'é“',ç‰¹:'ç«ç³»æ¶…æ§ƒ',ç¨€:'ä¼ '},çœŸé¾™è„‰:{è´¨:'é“',ç‰¹:'é¾™æ—ç¥é€š',ç¨€:'ä¼ '},æˆ˜ä½“:{è´¨:'é“',ç‰¹:'æˆ˜åŠ›å€å¢',ç¨€:'ä¼ '},æ¢¦é­‡ä½“:{è´¨:'é“',ç‰¹:'å¹»æœ¯æŒæ§',ç¨€:'ä¼ '},é›ªé­‚ä½“:{è´¨:'é“',ç‰¹:'å†°ç³»æè‡´',ç¨€:'ä¼ '},æ··æ²Œä½“:{è´¨:'åœ£',ç‰¹:'ä¸‡æ³•æ— é˜»',ç¨€:'ä¼ '},é“ä½“:{è´¨:'åœ£',ç‰¹:'æ‚Ÿæ€§æé«˜',ç¨€:'ä¼ '},é‡‘èº«:{è´¨:'åœ£',ç‰¹:'é˜²å¾¡æ— æ•Œ',ç¨€:'ä¼ '},è½®å›ä½“:{è´¨:'ç¥',ç‰¹:'{{user}}ä¸“å±è½®å›',ç¨€:'ä¼ '},æ—¶ç©ºä½“:{è´¨:'ç¥',ç‰¹:'æ—¶ç©ºæŒæ§',ç¨€:'ä¼ '}}),æœ¬å°Š:e.z.object({ç­‰çº§:e.z.coerce.number().transform(e=>_.clamp(e,1,36)).prefault(1),ä¿®ä¸º:e.z.coerce.number().transform(e=>Math.max(0,e)).prefault(0),çµæ ¹:e.z.string().prefault('äº”è¡Œæ‚çµæ ¹'),ä½“è´¨:e.z.string().prefault('å‡¡ä½“'),åŠŸæ³•:e.z.string().prefault('æ— '),æœ¬å‘½å…µå™¨:e.z.string().prefault('æ— '),ç¥é€šåˆ—è¡¨:e.z.record(e.z.string().describe('ç¥é€šå'),e.z.string().describe('ç¥é€šæè¿°')).prefault({}),çµçŸ³:e.z.coerce.number().transform(e=>Math.max(0,e)).prefault(0),å·²æ´»å²æœˆ:e.z.coerce.number().transform(e=>Math.max(0,e)).prefault(0),å°è¯•çªç ´:e.z.boolean().prefault(!1),è¡Œè¸ª:e.z.object({å½“å‰åŒºåŸŸ:e.z.string().prefault('æœªçŸ¥ä¹‹åœ°'),æ‰€å±å±‚çº§:e.z.string().prefault('åœ°å±‚'),ç¯å¢ƒæè¿°:e.z.string().prefault(''),å±é™©åº¦:e.z.coerce.number().prefault(10),å¯ç”¨é€šé“:e.z.array(e.z.string()).prefault([]),å¯¼èˆªä¿¡æ¯:e.z.string().prefault('')}).prefault({å½“å‰åŒºåŸŸ:'æœªçŸ¥ä¹‹åœ°',æ‰€å±å±‚çº§:'åœ°å±‚',ç¯å¢ƒæè¿°:'',å±é™©åº¦:10,å¯ç”¨é€šé“:[],å¯¼èˆªä¿¡æ¯:''}),èº«ä»½:e.z.object({å§“å:e.z.string().prefault('æ— åæ°'),å®—é—¨:e.z.string().prefault('æ•£ä¿®'),å‡ºèº«:e.z.string().prefault('å‡¡äºº')}).prefault({å§“å:'æ— åæ°',å®—é—¨:'æ•£ä¿®',å‡ºèº«:'å‡¡äºº'}),èƒŒåŒ…:e.z.record(e.z.string().describe('ç‰©å“å'),o).prefault({}).transform(e=>_.pickBy(e,({æ•°é‡:e})=>e>0)),æ³•å®:e.z.record(e.z.string().describe('æ³•å®å'),o).prefault({}).transform(e=>_.pickBy(e,({æ•°é‡:e})=>e>0)),æ‚ç‰©è¢‹:e.z.record(e.z.string().describe('æ‚ç‰©å'),o).prefault({}).transform(e=>_.pickBy(e,({æ•°é‡:e})=>e>0))}).prefault({ç­‰çº§:1,ä¿®ä¸º:0,çµæ ¹:'äº”è¡Œæ‚çµæ ¹',ä½“è´¨:'å‡¡ä½“',åŠŸæ³•:'æ— ',æœ¬å‘½å…µå™¨:'æ— ',ç¥é€šåˆ—è¡¨:{},çµçŸ³:0,å·²æ´»å²æœˆ:0,å°è¯•çªç ´:!1,è¡Œè¸ª:{å½“å‰åŒºåŸŸ:'æœªçŸ¥ä¹‹åœ°',æ‰€å±å±‚çº§:'åœ°å±‚',ç¯å¢ƒæè¿°:'',å±é™©åº¦:10,å¯ç”¨é€šé“:[],å¯¼èˆªä¿¡æ¯:''},èº«ä»½:{å§“å:'æ— åæ°',å®—é—¨:'æ•£ä¿®',å‡ºèº«:'å‡¡äºº'},èƒŒåŒ…:{},æ³•å®:{},æ‚ç‰©è¢‹:{}}).transform(e=>{const o=e.ç­‰çº§,a=n[o-1]??100,c=s[o-1]??100,l=Math.floor((o-1)/4),i=`${r[l]??'ç»ƒæ°”'}${t[(o-1)%4]??'åˆæœŸ'}`,u=`${e.å·²æ´»å²æœˆ}/${c}`,g=e.å°è¯•çªç ´?'çªç ´ä¸­':e.ä¿®ä¸º>=a?'ç“¶é¢ˆæœŸ':'ä¿®ç‚¼ä¸­',f=`${(e.ä¿®ä¸º/a*100).toFixed(1)}%`;return{...e,çªç ´é˜ˆå€¼:a,å¯¿å…ƒä¸Šé™:c,å¢ƒç•Œæè¿°:i,å¯¿å…ƒçŠ¶æ€:u,çŠ¶æ€:g,è¿›åº¦:f}}),çº¢é¢œè§’è‰²åº“:e.z.record(e.z.string().describe('è§’è‰²å'),e.z.object({çº§:e.z.coerce.number().transform(e=>_.clamp(e,1,36)),æ ¹:e.z.string().describe('çµæ ¹'),è´¨:e.z.string().describe('ä½“è´¨'),é¾„:e.z.string().describe('å¹´é¾„'),å±:e.z.string().describe('æ‰€å±'),æ³•:e.z.string().describe('åŠŸæ³•'),å™¨:e.z.string().describe('æœ¬å‘½å…µå™¨'),é€š:e.z.array(e.z.string()).prefault([]),å‹:e.z.enum(['æ ¸å¿ƒ','é‡è¦','æ¬¡è¦'])})).prefault({è®¸å¬é›¨:{çº§:28,æ ¹:'æ°´æœ¬æºå¤©',è´¨:'å½’å¢Ÿç¥ä½“',é¾„:'å¤–26å®12000',å±:'å½’å¢Ÿä¹‹ä¸»',æ³•:'ä¸‡æ°´å½’æºå…ˆå¤©',å™¨:'æ²§æµ·é—ç å…ˆå¤©',é€š:['å½’å¢Ÿæ­Œ','é€†æµè™šå¦„','å¯‚ç­æµ·åŸŸ','ä¸‡æ°´åŒæº'],å‹:'æ ¸å¿ƒ'},è™æ±é¢œ:{çº§:12,æ ¹:'æ°´é˜´é˜³å¼‚',è´¨:'åŒé±¼ä½“',é¾„:'åŒ–å½¢0å¹´',å±:'{{user}}ç‰ä½©',æ³•:'åŒç”Ÿå¤©æ/é˜´é˜³',å™¨:'åŒé±¼ä½©æœ¬ä½“',é€š:['æ¯æœ¨æ˜¥','å¤ºå‘½å¦†','åŒé±¼æ¢¦'],å‹:'æ ¸å¿ƒ'},ç™½æ¸…å¼¦:{çº§:29,æ ¹:'é‡‘å¤©æ ¹',è´¨:'å‰‘ä½“',é¾„:'å¤–30å®1000+',å±:'æ•£ä¿®å‰‘å®—å¸ˆ',æ³•:'å‰‘æ„ä»™/å¤©éŸ³å¤©',å™¨:'æ¸…å¼¦ç´å‰‘çµå®',é€š:['ç´å‰‘æ€','å‰‘æ„æ­Œ','ä¸‡å‰‘å¿ƒ'],å‹:'æ ¸å¿ƒ'},ç„°ç»¯æœˆ:{çº§:12,æ ¹:'ç¦»ç«æ ¹æ',è´¨:'æœ±é›€è„‰',é¾„:'25',å±:'ç¦»ç«å®«åœ£å¥³',æ³•:'æœ±é›€å¤©',å™¨:'ç»¯æœˆå¼“æ³•å®',é€š:['ç¦»ç«å¤©','æœ±é›€èº«','å‡¤å‡°æ§ƒ'],å‹:'é‡è¦'},å¹»åƒä¸:{çº§:13,æ ¹:'æš—å¹»åŒæ ¹',è´¨:'æ¢¦é­‡ä½“',é¾„:'å¤–20æœªçŸ¥',å±:'æ•£ä¿®å¹½å†¥',æ³•:'ç»‡æ¢¦å¤©',å™¨:'åƒä¸ç½‘çµå®',é€š:['ç»‡æ¢¦ç¬¼','å¿ƒé­”å¢ƒ','åƒä¸ç¼š'],å‹:'é‡è¦'},èŠ±æƒ³å®¹:{çº§:8,æ ¹:'æœ¨æ ¹',è´¨:'èŠ±å¦–ä½“',é¾„:'å¤–12',å±:'å»ºæœ¨å®—',æ³•:'ç™¾èŠ±åœ°',å™¨:'ç‰¡ä¸¹ç“£',é€š:['èŠ±æµ·åŸŸ','æ²»æ„ˆç²‰','é­…æƒ‘é¦™'],å‹:'æ¬¡è¦'},æ•–æ¸…éœœ:{çº§:14,æ ¹:'æ°´é¾™åŒæ ¹',è´¨:'çœŸé¾™è„‰',é¾„:'å¤–20å®150',å±:'é¾™å®«ä¸‰å…¬ä¸»',æ³•:'æ²§æµ·å¤©',å™¨:'é¾™é³ç”²çµå®',é€š:['é¾™å˜åŒ–','å‘¼é£é›¨','é¾™å¨æ…‘'],å‹:'æ¬¡è¦'}}),çº¢é¢œ:e.z.record(e.z.string().describe('çº¢é¢œå'),e.z.object({ç­‰çº§:e.z.coerce.number().transform(e=>_.clamp(e,1,36)).prefault(1),ä¿®ä¸º:e.z.coerce.number().transform(e=>Math.max(0,e)).prefault(0),çµæ ¹:e.z.string().prefault('äº”è¡Œæ‚çµæ ¹'),ä½“è´¨:e.z.string().prefault('å‡¡ä½“'),åŠŸæ³•:e.z.string().prefault('æ— '),æœ¬å‘½å…µå™¨:e.z.string().prefault('æ— '),ç¥é€šåˆ—è¡¨:e.z.record(e.z.string().describe('ç¥é€šå'),e.z.string().describe('ç¥é€šæè¿°')).prefault({}),çµçŸ³:e.z.coerce.number().transform(e=>Math.max(0,e)).prefault(0),å·²æ´»å²æœˆ:e.z.coerce.number().transform(e=>Math.max(0,e)).prefault(0),å°è¯•çªç ´:e.z.boolean().prefault(!1),å¥½æ„Ÿåº¦:e.z.coerce.number().transform(e=>_.clamp(e,-100,100)).prefault(0),å…³ç³»:e.z.string().prefault('é™Œç”Ÿäºº'),é‡è¦æ€§:e.z.string().prefault('è·¯äºº')}).prefault({ç­‰çº§:1,ä¿®ä¸º:0,çµæ ¹:'äº”è¡Œæ‚çµæ ¹',ä½“è´¨:'å‡¡ä½“',åŠŸæ³•:'æ— ',æœ¬å‘½å…µå™¨:'æ— ',ç¥é€šåˆ—è¡¨:{},çµçŸ³:0,å·²æ´»å²æœˆ:0,å°è¯•çªç ´:!1,å¥½æ„Ÿåº¦:0,å…³ç³»:'é™Œç”Ÿäºº',é‡è¦æ€§:'è·¯äºº'}).transform(e=>{const o=e.ç­‰çº§,a=n[o-1]??100,c=s[o-1]??100,l=Math.floor((o-1)/4),i=`${r[l]??'ç»ƒæ°”'}${t[(o-1)%4]??'åˆæœŸ'}`,u=`${e.å·²æ´»å²æœˆ}/${c}`,g=e.å°è¯•çªç ´?'çªç ´ä¸­':e.ä¿®ä¸º>=a?'ç“¶é¢ˆæœŸ':'ä¿®ç‚¼ä¸­',f=`${(e.ä¿®ä¸º/a*100).toFixed(1)}%`;return{...e,çªç ´é˜ˆå€¼:a,å¯¿å…ƒä¸Šé™:c,å¢ƒç•Œæè¿°:i,å¯¿å…ƒçŠ¶æ€:u,çŠ¶æ€:g,è¿›åº¦:f}})).prefault({}),NPCå›¾é‰´:e.z.record(e.z.string().describe('NPCå'),e.z.object({ç­‰çº§:e.z.coerce.number().transform(e=>_.clamp(e,1,36)).prefault(1),æ‰€åœ¨å®—é—¨:e.z.string().prefault('æ•£ä¿®'),å¤‡æ³¨:e.z.string().prefault('')})).prefault({}),ä»»åŠ¡åˆ—è¡¨:e.z.record(e.z.string().describe('ä»»åŠ¡å'),e.z.object({ç±»å‹:e.z.enum(['ä¸»çº¿','æ”¯çº¿','æ¯æ—¥','ä¸´å±å—å‘½']),ç›®æ ‡:e.z.string(),çŠ¶æ€:e.z.enum(['è¿›è¡Œä¸­','å·²å®Œæˆ','å·²å¤±è´¥']).prefault('è¿›è¡Œä¸­')})).prefault({}),å£°æœ›ç³»ç»Ÿ:e.z.record(e.z.string().describe('åŠ¿åŠ›å'),e.z.object({å€¼:e.z.coerce.number().transform(e=>_.clamp(e,-100,100)),å…³ç³»:e.z.string()})).prefault({})});const p={WORLDBOOK_NAME:'current',DEBUG:!0,CONTEXT_WINDOW:2,STRATEGY:'balanced',MVU_INIT_TIMEOUT:3e3,DEBOUNCE_DELAY:500,CHARACTER_ALIASES:{è™æ±é¢œ:['è™æ±','è™é¢œ']},KEEP_ENABLED_AFTER_REPLY:[/^\[ç³»ç»Ÿ\]/,/^\[mvu_update\]/,/^\[mvu\]å˜é‡åˆ—è¡¨$/,/^\[çº¢é¢œç´¢å¼•\]$/,/^\[åœ°å›¾\]/,/^\[å¢ƒç•Œ\]/]},E=[{entryPattern:/^\[ç³»ç»Ÿ\]/,shouldEnable:()=>!0,priority:100},{entryPattern:/^\[mvu_update\]/,shouldEnable:()=>!0,priority:100},{entryPattern:/^\[mvu\]å˜é‡åˆ—è¡¨$/,shouldEnable:()=>!0,priority:100},{entryPattern:/^\[åœ°å›¾\]\s*(.+)$/,shouldEnable:(e,r)=>{if(!r||!e.currentRegion)return!1;const t=r.match(/^\[åœ°å›¾\]\s*(.+)$/);if(!t)return!1;const n=t[1].trim(),s=e.currentRegion===n;return p.DEBUG&&s&&console.log(`[åŠ¨æ€ä¸–ç•Œä¹¦] åœ°å›¾åŒ¹é…æˆåŠŸ: ${n} === ${e.currentRegion}`),s},priority:10},{entryPattern:/^\[è§’è‰²\]\s*(.+?)\s*-\s*(é™Œç”ŸæœŸ|å¥½æ„ŸæœŸ|å¿ƒåŠ¨æœŸ|ç¡®è®¤æœŸ|æ·±çˆ±æœŸ)$/,shouldEnable:(e,r)=>{if(!r)return!1;const t=r.match(/^\[è§’è‰²\]\s*(.+?)\s*-\s*(é™Œç”ŸæœŸ|å¥½æ„ŸæœŸ|å¿ƒåŠ¨æœŸ|ç¡®è®¤æœŸ|æ·±çˆ±æœŸ)$/);if(!t)return!1;const n=t[1].trim(),s=t[2],o=e.mvuData?.çº¢é¢œ?.[n];if(!o)return p.DEBUG&&console.log(`[åŠ¨æ€ä¸–ç•Œä¹¦] è§’è‰²ä¸åœ¨çº¢é¢œåˆ—è¡¨ä¸­: ${n}`),!1;if(e.recentMessages.length>0){const r=[n];p.CHARACTER_ALIASES[n]&&r.push(...p.CHARACTER_ALIASES[n]);let t=!1;for(const s of r){const r=s.replace(/[.*+?^${}()|[\]\\]/g,'\\$&'),o=new RegExp(`(?:^|[^\\p{Script=Han}\\w])(${r})(?:[^\\p{Script=Han}\\w]|$)`,'u');if(e.recentMessages.some(e=>o.test(e))){t=!0,p.DEBUG&&console.log(`[åŠ¨æ€ä¸–ç•Œä¹¦] åŒ¹é…åˆ°åˆ«å: ${s} -> ${n}`);break}}if(!t)return p.DEBUG&&console.log(`[åŠ¨æ€ä¸–ç•Œä¹¦] è§’è‰²æœªåœ¨è¿‘æœŸæ¶ˆæ¯ä¸­æåŠ: ${n} (å«åˆ«å)`),!1}else p.DEBUG&&console.log(`[åŠ¨æ€ä¸–ç•Œä¹¦] å¼€å±€æ— æ¶ˆæ¯ï¼Œç›´æ¥æ ¹æ®å¥½æ„Ÿåº¦é˜¶æ®µå¼€å¯: ${n}`);const a={é™Œç”ŸæœŸ:[-100,20],å¥½æ„ŸæœŸ:[21,40],å¿ƒåŠ¨æœŸ:[41,60],ç¡®è®¤æœŸ:[61,80],æ·±çˆ±æœŸ:[81,100]}[s];if(!a)return!1;const c=o.å¥½æ„Ÿåº¦??0,l=c>=a[0]&&c<=a[1];return p.DEBUG&&console.log(`[åŠ¨æ€ä¸–ç•Œä¹¦] è§’è‰²é˜¶æ®µåŒ¹é…: ${n} - ${s}, å¥½æ„Ÿåº¦=${c}, èŒƒå›´=[${a[0]}, ${a[1]}], åŒ¹é…=${l}`),l},priority:9},{entryPattern:/^\[è§’è‰²\]\s*([^-]+)$/,shouldEnable:(e,r)=>{if(!r)return!1;const t=r.match(/^\[è§’è‰²\]\s*([^-]+)$/);if(!t)return!1;const n=t[1].trim();p.DEBUG&&(console.log(`[åŠ¨æ€ä¸–ç•Œä¹¦] ğŸ” æ£€æŸ¥è§’è‰²: ${n}`),console.log(`[åŠ¨æ€ä¸–ç•Œä¹¦] ğŸ” æœ€è¿‘æ¶ˆæ¯ (${e.recentMessages.length}æ¡):`,e.recentMessages));let s=n,o=!1;for(const[e,r]of Object.entries(p.CHARACTER_ALIASES))if(r.includes(n)){s=e,o=!0,p.DEBUG&&console.log(`[åŠ¨æ€ä¸–ç•Œä¹¦] ğŸ”— è¯†åˆ«åˆ°åˆ«åæ¡ç›®: ${n} -> ä¸»è§’è‰²: ${e}`);break}if(!(e.recentMessages.length>0)){const r=void 0!==e.mvuData?.çº¢é¢œ?.[s];return p.DEBUG&&(r?console.log(`[åŠ¨æ€ä¸–ç•Œä¹¦] âœ… å¼€å±€-åº”è¯¥å¼€å¯: ${n}${o?` (ä¸»è§’è‰²: ${s})`:''} (åœ¨çº¢é¢œåˆ—è¡¨ä¸­)`):console.log(`[åŠ¨æ€ä¸–ç•Œä¹¦] âŒ å¼€å±€-ä¸åº”å¼€å¯: ${n}${o?` (ä¸»è§’è‰²: ${s})`:''} (ä¸åœ¨çº¢é¢œåˆ—è¡¨ä¸­)`)),r}let a;o?a=[n]:(a=[n],p.CHARACTER_ALIASES[n]&&a.push(...p.CHARACTER_ALIASES[n]));let c=0;const l=[];for(const r of a){const t=r.replace(/[.*+?^${}()|[\]\\]/g,'\\$&'),n=new RegExp(`(?:^|[^\\p{Script=Han}\\w])(${t})(?:[^\\p{Script=Han}\\w]|$)`,'u'),s=e.recentMessages.filter(e=>n.test(e)).length;s>0&&(c+=s,l.push(`${r}(${s}æ¬¡)`),p.DEBUG&&console.log(`[åŠ¨æ€ä¸–ç•Œä¹¦] ğŸ” åŒ¹é…åˆ°: ${r}, æ­£åˆ™=${n}, æ¬¡æ•°=${s}`))}const i=c>=1;if(p.DEBUG){const e=o?` [åˆ«åæ¡ç›® -> ${s}]`:'',r=!o&&p.CHARACTER_ALIASES[n]?` [åˆ«å: ${p.CHARACTER_ALIASES[n].join(', ')}]`:'',t=l.length>0?` æåŠè¯¦æƒ…: ${l.join(', ')}`:'';i?console.log(`[åŠ¨æ€ä¸–ç•Œä¹¦] âœ… åº”è¯¥å¼€å¯: ${n}${e}${r}, ç´¯è®¡æåŠ=${c}æ¬¡${t}`):console.log(`[åŠ¨æ€ä¸–ç•Œä¹¦] âŒ ä¸åº”å¼€å¯: ${n}${e}${r}, ç´¯è®¡æåŠ=${c}æ¬¡ (éœ€â‰¥1æ¬¡)`)}return i},priority:8},{entryPattern:/^\[å¢ƒç•Œ\]\s*(.+)$/,shouldEnable:(e,r)=>{if(!r)return!1;const t=r.match(/^\[å¢ƒç•Œ\]\s*(.+)$/);if(!t)return!1;const n=t[1].trim(),s=e.mvuData?.æœ¬å°Š?.ç­‰çº§??1,o={ç»ƒæ°”:[1,4],ç­‘åŸº:[5,8],é‡‘ä¸¹:[9,12],å…ƒå©´:[13,16],åŒ–ç¥:[17,20],ç‚¼è™š:[21,24],åˆä½“:[25,28],å¤§ä¹˜:[29,32],æ¸¡åŠ«:[33,36]}[n];if(!o)return p.DEBUG&&console.log(`[åŠ¨æ€ä¸–ç•Œä¹¦] æœªçŸ¥å¢ƒç•Œåç§°: ${n}`),!1;const a=s>=o[0]&&s<=o[1];return p.DEBUG&&console.log(`[åŠ¨æ€ä¸–ç•Œä¹¦] å¢ƒç•ŒåŒ¹é…: ${n}, ç­‰çº§=${s}, èŒƒå›´=[${o[0]}, ${o[1]}], åŒ¹é…=${a}`),a},priority:7},{entryPattern:/^\[äº‹ä»¶\]\s*(.+)$/,shouldEnable:(e,r)=>{if(!r)return!1;const t=r.match(/^\[äº‹ä»¶\]\s*(.+)$/);if(!t)return!1;const n=t[1].trim(),s=n.replace(/[.*+?^${}()|[\]\\]/g,'\\$&'),o=new RegExp(`(?:^|[\\s\\p{P}ï¼Œã€‚ï¼ï¼Ÿï¼›ï¼š""''ã€Œã€ã€ã€ã€ã€‘ã€Šã€‹ã€ˆã€‰ï¼ˆï¼‰])(${s})(?:[\\s\\p{P}ï¼Œã€‚ï¼ï¼Ÿï¼›ï¼š""''ã€Œã€ã€ã€ã€ã€‘ã€Šã€‹ã€ˆã€‰ï¼ˆï¼‰]|$)`,'u'),a=e.recentMessages.some(e=>o.test(e));return p.DEBUG&&a&&console.log(`[åŠ¨æ€ä¸–ç•Œä¹¦] äº‹ä»¶åŒ¹é…æˆåŠŸ: ${n}`),a},priority:3},{entryPattern:/^\[çº¢é¢œç´¢å¼•\]$/,shouldEnable:()=>!0,priority:100},{entryPattern:/^\[(ç‰©å“|æ³•å®|åŠŸæ³•|åŠ¿åŠ›|åœ°ç‚¹|çµæ ¹|ä½“è´¨)\]\s*(.+)$/,shouldEnable:(e,r)=>{if(!r)return!1;const t=r.match(/^\[(ç‰©å“|æ³•å®|åŠŸæ³•|åŠ¿åŠ›|åœ°ç‚¹|çµæ ¹|ä½“è´¨)\]\s*(.+)$/);if(!t)return!1;const n=t[1],s=t[2].trim(),o=s.replace(/[.*+?^${}()|[\]\\]/g,'\\$&'),a=new RegExp(o,'u'),c=e.recentMessages.filter(e=>a.test(e)).length,l=c>=2;return p.DEBUG&&c>0&&console.log(`[åŠ¨æ€ä¸–ç•Œä¹¦] ${n}åŒ¹é…: ${s}, æåŠæ¬¡æ•°=${c}, å¯ç”¨=${l}`),l},priority:5}];let m=!1,b=0;async function d(){try{const e=new Promise(e=>{setTimeout(()=>e(!1),p.MVU_INIT_TIMEOUT)}),r=(async()=>(await waitGlobalInitialized('Mvu'),!0))();return await Promise.race([r,e])}catch(e){return console.warn('[åŠ¨æ€ä¸–ç•Œä¹¦] MVU åˆå§‹åŒ–ç­‰å¾…å¤±è´¥',e),!1}}async function A(e='enable'){const r=Date.now();if(r-b<p.DEBOUNCE_DELAY)p.DEBUG&&console.log('[åŠ¨æ€ä¸–ç•Œä¹¦] è§¦å‘è¿‡äºé¢‘ç¹,è·³è¿‡æœ¬æ¬¡æ›´æ–°');else if(b=r,m)p.DEBUG&&console.log('[åŠ¨æ€ä¸–ç•Œä¹¦] æ­£åœ¨å¤„ç†ä¸­ï¼Œè·³è¿‡æœ¬æ¬¡æ›´æ–°');else{m=!0;try{const r=await async function(){if(!await d())return p.DEBUG&&console.log('[åŠ¨æ€ä¸–ç•Œä¹¦] MVU æœªå°±ç»ª,è·³è¿‡æœ¬æ¬¡æ›´æ–°'),null;let e=[];try{const r=getLastMessageId();if(r>=0){const t=getChatMessages(`0-${r}`);t&&t.length>0&&(e=t.slice(-p.CONTEXT_WINDOW).map(e=>{let r=e.message||'';return r=r.replace(/\[åŠ¨æ€ä¸–ç•Œä¹¦\][^\n]*/g,''),r=r.replace(/ã€[^ã€‘]*ã€‘/g,''),r=r.replace(/<UpdateVariable>[\s\S]*?<\/UpdateVariable>/g,''),r=r.replace(/```mvu_update[\s\S]*?```/g,''),r=r.replace(/```[\s\S]*?```/g,''),r.trim()}).filter(e=>e.length>0),p.DEBUG&&console.log('[åŠ¨æ€ä¸–ç•Œä¹¦] ğŸ” è¿‡æ»¤åçš„æ¶ˆæ¯å†…å®¹:',e))}}catch(r){p.DEBUG&&console.warn('[åŠ¨æ€ä¸–ç•Œä¹¦] è·å–æ¶ˆæ¯å¤±è´¥',r),e=[]}let r=null;try{if(getLastMessageId()>=0){const e=getVariables({type:'message',message_id:-1}),t=_.get(e,'stat_data',null);t&&(r=f.parse(t))}if(!r)return p.DEBUG&&console.log('[åŠ¨æ€ä¸–ç•Œä¹¦] MVU æ•°æ®æœªå°±ç»ª,è·³è¿‡æœ¬æ¬¡æ›´æ–°'),null}catch(e){return console.warn('[åŠ¨æ€ä¸–ç•Œä¹¦] è·å– MVU æ•°æ®å¤±è´¥',e),null}const t=r?.æœ¬å°Š?.è¡Œè¸ª?.å½“å‰åŒºåŸŸ??'æœªçŸ¥';return p.DEBUG&&console.log(`[åŠ¨æ€ä¸–ç•Œä¹¦] ä¸Šä¸‹æ–‡: åŒºåŸŸ="${t}", æ¶ˆæ¯æ•°=${e.length}`),{currentRegion:t,recentMessages:e,mvuData:r}}();if(!r)return void(p.DEBUG&&console.log('[åŠ¨æ€ä¸–ç•Œä¹¦] ä¸Šä¸‹æ–‡æœªå°±ç»ª,è·³è¿‡æœ¬æ¬¡æ›´æ–°'));let t=p.WORLDBOOK_NAME;if('current'===t){const e=getCharWorldbookNames('current');if(t=e.primary||'',!t)return void console.warn('[åŠ¨æ€ä¸–ç•Œä¹¦] å½“å‰è§’è‰²å¡æ²¡æœ‰ç»‘å®šä¸»ä¸–ç•Œä¹¦')}let n=0,s=0,o=0;const a=[...E].sort((e,r)=>(r.priority??0)-(e.priority??0));if(await updateWorldbookWith(t,c=>{p.DEBUG&&(console.log(`[åŠ¨æ€ä¸–ç•Œä¹¦] å¼€å§‹å¤„ç†ä¸–ç•Œä¹¦ [${e}æ¨¡å¼]: ${t}, å…± ${c.length} ä¸ªæ¡ç›®`),console.log(`[åŠ¨æ€ä¸–ç•Œä¹¦] å½“å‰ä¸Šä¸‹æ–‡: åŒºåŸŸ="${r.currentRegion}", ç­‰çº§=${r.mvuData?.æœ¬å°Š?.ç­‰çº§??'æœªçŸ¥'}, æ¶ˆæ¯æ•°=${r.recentMessages.length}`));for(const t of c){if(!t.enabled)continue;const c=t.name||'';if(!c){p.DEBUG&&console.warn('[åŠ¨æ€ä¸–ç•Œä¹¦] å‘ç°æ— åç§°æ¡ç›®ï¼Œè·³è¿‡');continue}let l=null;for(const e of a){if('string'==typeof e.entryPattern?c.includes(e.entryPattern):e.entryPattern.test(c)){l=e;break}}if(!l)continue;const i=t.strategy.type;if('enable'===e){let e=!1;try{e=l.shouldEnable(r,c)}catch(e){console.error(`[åŠ¨æ€ä¸–ç•Œä¹¦] è¯„ä¼°æ¡ç›® "${c}" æ—¶å‡ºé”™:`,e);continue}const a=/^\[ç³»ç»Ÿ\]/.test(c)||/^\[mvu_update\]/.test(c)||/^\[mvu\]å˜é‡åˆ—è¡¨$/.test(c)||/^\[çº¢é¢œç´¢å¼•\]$/.test(c);e&&'constant'!==i?(t.strategy.type='constant',n++,o++,p.DEBUG&&console.log(`[åŠ¨æ€ä¸–ç•Œä¹¦] âœ… å¼€å¯(ç»¿â†’è“): ${c}`)):e||'constant'!==i||a||(t.strategy.type='selective',s++,o++,p.DEBUG&&console.log(`[åŠ¨æ€ä¸–ç•Œä¹¦] âš ï¸ å…³é—­(è“â†’ç»¿): ${c}`))}else if('constant'===i){let e=!1;e='conservative'===p.STRATEGY||('balanced'===p.STRATEGY?p.KEEP_ENABLED_AFTER_REPLY.some(e=>e.test(c)):/^\[ç³»ç»Ÿ\]/.test(c)||/^\[mvu_update\]/.test(c)||/^\[mvu\]å˜é‡åˆ—è¡¨$/.test(c)),e||(t.strategy.type='selective',s++,o++,p.DEBUG&&console.log(`[åŠ¨æ€ä¸–ç•Œä¹¦] âš ï¸ æ”¹ä¸ºç»¿ç¯: ${c}`))}}return p.DEBUG&&console.log(`[åŠ¨æ€ä¸–ç•Œä¹¦] å¤„ç†å®Œæˆ [${e}æ¨¡å¼]ï¼Œä¿®æ”¹ ${o} ä¸ªæ¡ç›® (å¯ç”¨ ${n} ä¸ª, ç¦ç”¨ ${s} ä¸ª)`),c}),n>0||s>0){const r=`${'enable'===e?'å‡†å¤‡AIå›å¤':'AIå›å¤å®Œæˆ'}: å¯ç”¨ ${n} ä¸ª, ç¦ç”¨ ${s} ä¸ª`;console.info(`[åŠ¨æ€ä¸–ç•Œä¹¦] ${r}`),p.DEBUG&&toastr.info(r,'åŠ¨æ€ä¸–ç•Œä¹¦')}else p.DEBUG&&console.log(`[åŠ¨æ€ä¸–ç•Œä¹¦] æœ¬æ¬¡æ— éœ€æ›´æ–°æ¡ç›®çŠ¶æ€ [${e}æ¨¡å¼]`)}catch(e){e instanceof Error&&e.message.includes('MVU')||e instanceof Error&&e.message.includes('åˆå§‹åŒ–')?p.DEBUG&&console.log('[åŠ¨æ€ä¸–ç•Œä¹¦] MVU ç›¸å…³é”™è¯¯,å¯èƒ½æ˜¯æ­£åœ¨åˆå§‹åŒ–,è·³è¿‡'):(console.error('[åŠ¨æ€ä¸–ç•Œä¹¦] æ›´æ–°å¤±è´¥',e),p.DEBUG&&toastr.error(`æ›´æ–°å¤±è´¥: ${e instanceof Error?e.message:'æœªçŸ¥é”™è¯¯'}`,'åŠ¨æ€ä¸–ç•Œä¹¦'))}finally{m=!1}}}$(()=>{errorCatched(async()=>{console.info('[åŠ¨æ€ä¸–ç•Œä¹¦] è„šæœ¬å·²åŠ è½½'),console.info(`[åŠ¨æ€ä¸–ç•Œä¹¦] å½“å‰ç­–ç•¥: ${p.STRATEGY}`);const e=await d();e?(console.info('[åŠ¨æ€ä¸–ç•Œä¹¦] MVU æ¡†æ¶å·²åˆå§‹åŒ–'),await new Promise(e=>setTimeout(e,1500)),await A('enable'),console.info('[åŠ¨æ€ä¸–ç•Œä¹¦] åˆå§‹åŒ–æ£€æŸ¥å®Œæˆ')):console.warn('[åŠ¨æ€ä¸–ç•Œä¹¦] MVU åˆå§‹åŒ–è¶…æ—¶,å°†åœ¨åç»­äº‹ä»¶ä¸­å°è¯•'),eventOn(tavern_events.MESSAGE_SENT,async()=>{p.DEBUG&&console.log('[åŠ¨æ€ä¸–ç•Œä¹¦] ğŸŸ¢ ç”¨æˆ·å‘é€æ¶ˆæ¯ï¼Œå¯ç”¨ç›¸å…³ä¸–ç•Œä¹¦æ¡ç›®'),await A('enable')}),eventOn(tavern_events.MESSAGE_SWIPED,async e=>{p.DEBUG&&console.log(`[åŠ¨æ€ä¸–ç•Œä¹¦] ğŸ”„ æ¶ˆæ¯ #${e} é‡rollï¼Œå¯ç”¨ç›¸å…³ä¸–ç•Œä¹¦æ¡ç›®`),await new Promise(e=>setTimeout(e,300)),await A('enable')}),eventOn(tavern_events.MESSAGE_RECEIVED,async()=>{p.DEBUG&&console.log('[åŠ¨æ€ä¸–ç•Œä¹¦] ğŸ”´ AI å›å¤å®Œæˆï¼Œç¦ç”¨éæ ¸å¿ƒä¸–ç•Œä¹¦æ¡ç›®'),await new Promise(e=>setTimeout(e,200)),await A('disable')}),eventOn(tavern_events.CHAT_CHANGED,async()=>{p.DEBUG&&console.log('[åŠ¨æ€ä¸–ç•Œä¹¦] è§¦å‘äº‹ä»¶: CHAT_CHANGED'),await new Promise(e=>setTimeout(e,2e3)),await A('enable')}),eventOn(tavern_events.CHAT_CREATED,async()=>{p.DEBUG&&console.log('[åŠ¨æ€ä¸–ç•Œä¹¦] è§¦å‘äº‹ä»¶: CHAT_CREATED'),await new Promise(e=>setTimeout(e,2e3)),await A('enable')}),eventOn(tavern_events.CHARACTER_PAGE_LOADED,async()=>{p.DEBUG&&console.log('[åŠ¨æ€ä¸–ç•Œä¹¦] è§¦å‘äº‹ä»¶: CHARACTER_PAGE_LOADED'),await new Promise(e=>setTimeout(e,2e3)),await A('enable')}),e&&eventOn(Mvu.events.VARIABLE_UPDATE_ENDED,async()=>{p.DEBUG&&console.log('[åŠ¨æ€ä¸–ç•Œä¹¦] è§¦å‘äº‹ä»¶: VARIABLE_UPDATE_ENDED'),await new Promise(e=>setTimeout(e,100)),await A('enable')});const r='aggressive'===p.STRATEGY?'æ¿€è¿›æ¨¡å¼ï¼ˆæœ€çœtokenï¼‰':'balanced'===p.STRATEGY?'å¹³è¡¡æ¨¡å¼ï¼ˆæ¨èï¼‰':'ä¿å®ˆæ¨¡å¼ï¼ˆæœ€å®‰å…¨ï¼‰';console.info(`[åŠ¨æ€ä¸–ç•Œä¹¦] ç›‘å¬å™¨å·²è®¾ç½®ï¼Œç­–ç•¥ï¼š${r}`),e?toastr.success(`åŠ¨æ€ä¸–ç•Œä¹¦å·²å¯ç”¨ - ${r}`,'è¸æœˆå¯»ä»™'):toastr.info('åŠ¨æ€ä¸–ç•Œä¹¦å·²åŠ è½½ï¼Œç­‰å¾…MVUåˆå§‹åŒ–...','è¸æœˆå¯»ä»™')})()});
//# sourceMappingURL=index.js.map