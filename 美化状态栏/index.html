<head><script type="module">import{createPinia as e,defineStore as t}from'https://testingcf.jsdelivr.net/npm/pinia/+esm';var a={502(e,t){t.A=(e,t)=>{const a=e.__vccOpts||e;for(const[e,r]of t)a[e]=r;return a}}},r={};function n(e){var t=r[e];if(void 0!==t)return t.exports;var o=r[e]={exports:{}};return a[e](o,o.exports,n),o.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);const o=Vue,c=z,l=['练气','筑基','金丹','元婴','化神','炼虚','合体','大乘','渡劫'],s=['初期','中期','后期','大圆满'],i=[100,100,100,100,200,200,200,200,400,400,400,400,800,800,800,800,1600,1600,1600,1600,3200,3200,3200,3200,6400,6400,6400,6400,12800,12800,12800,12800,25600,25600,25600,25600],d=[100,100,100,100,200,200,200,200,500,500,500,500,1e3,1e3,1e3,1e3,2e3,2e3,2e3,2e3,5e3,5e3,5e3,5e3,1e4,1e4,1e4,1e4,5e4,5e4,5e4,5e4,1e5,1e5,1e5,1e5],b=c.z.object({名称:c.z.string().prefault(''),描述:c.z.string().prefault(''),品阶:c.z.string().prefault(''),数量:c.z.coerce.number().transform(e=>Math.max(1,e)).prefault(1)}),g=c.z.object({地:c.z.string().describe('所在地'),特:c.z.string().describe('核心特点'),力:c.z.string().describe('最高战力'),营:c.z.enum(['正','魔','中']),模:c.z.enum(['超大','大','小','微','特'])}),p=c.z.object({阶:c.z.enum(['凡','黄','玄','地','天','仙','圣']),性:c.z.string().describe('属性'),效:c.z.string().describe('效果')}),f=c.z.object({阶:c.z.enum(['凡器','法器','灵器','法宝','灵宝','仙器','圣器','道器']),类:c.z.string().describe('类型'),特:c.z.string().describe('特性')}),u=c.z.object({域:c.z.enum(['天层','神州','东苍','南炎','西庚','北冥','下层','四海']),类:c.z.enum(['秘境','城镇','宗门','禁地','遗迹','地形']),危:c.z.coerce.number().transform(e=>_.clamp(e,0,100)),特:c.z.string().describe('特点'),资:c.z.array(c.z.string()).prefault([])}),m=c.z.object({质:c.z.enum(['劣','下','中','上','极','天','异']),性:c.z.string().describe('属性'),速:c.z.string().describe('修炼倍率'),特:c.z.string().describe('特性'),稀:c.z.enum(['常','少','罕','稀','传'])}),v=c.z.object({质:c.z.enum(['凡','灵','道','圣','神']),特:c.z.string().describe('特性'),优:c.z.string().describe('优势'),稀:c.z.enum(['常','少','罕','稀','传'])}),y=c.z.object({世界时钟:c.z.object({纪元:c.z.string().prefault('末法时代'),年份:c.z.coerce.number().prefault(1),月份:c.z.coerce.number().transform(e=>_.clamp(e,1,12)).prefault(1),日期:c.z.coerce.number().transform(e=>_.clamp(e,1,30)).prefault(1),时辰:c.z.string().prefault('子时')}),世界地图:c.z.record(c.z.string().describe('区域名'),c.z.object({layer:c.z.enum(['天层','地层','下层']).prefault('地层'),danger:c.z.coerce.number().transform(e=>_.clamp(e,0,100)),desc:c.z.string().prefault(''),connections:c.z.array(c.z.string()).prefault([])})).prefault({}),世界图志:c.z.record(c.z.string().describe('事件名'),c.z.object({状态:c.z.string().prefault(''),事件:c.z.string().prefault('')})).prefault({}),宗门势力库:c.z.record(c.z.string().describe('宗门名'),g).prefault({剑阁:{地:'神州剑门关',特:'剑道源头',力:'渡劫后期',营:'正',模:'超大'},万法宗:{地:'神州问道峰',特:'万法本源',力:'渡劫初期',营:'正',模:'超大'},金刚寺:{地:'西天佛山',特:'佛修炼体',力:'大乘中期',营:'正',模:'大'},药王谷:{地:'神农架',特:'医炼丹药',力:'大乘初期',营:'正',模:'大'},儒门:{地:'文圣山',特:'浩然正气',力:'大乘中期',营:'正',模:'大'},青龙殿:{地:'东苍青龙山',特:'守护青帝',力:'大乘初期',营:'正',模:'大'},玄武宗:{地:'北冥玄冰山',特:'镇守归墟',力:'大乘后期',营:'正',模:'大'},建木宗:{地:'东苍建木树',特:'木系道法',力:'合体中期',营:'正',模:'小'},百花谷:{地:'百花秘境',特:'女修花道',力:'合体后期',营:'正',模:'小'},血神教:{地:'血魔渊',特:'血道炼法',力:'渡劫中期',营:'魔',模:'超大'},天魔宗:{地:'天魔山',特:'天魔大道',力:'大乘中期',营:'魔',模:'大'},妖盟:{地:'万妖森林',特:'妖族联盟',力:'渡劫中期',营:'中',模:'超大'},大夏王朝:{地:'中州皇城',特:'世俗统治',力:'大乘初期',营:'中',模:'大'},九州商会:{地:'九大主城',特:'商业联盟',力:'大乘初期',营:'中',模:'大'},离火宫:{地:'南炎火山',特:'朱雀供奉',力:'合体圆满',营:'中',模:'小'},铸剑山庄:{地:'南炎地火',特:'炼器第一',力:'合体后期',营:'中',模:'小'}}),功法库:c.z.record(c.z.string().describe('功法名'),p).prefault({引气诀:{阶:'凡',性:'通用',效:'基础入门'},五行诀:{阶:'黄',性:'五行',效:'平衡五行'},筑基真解:{阶:'玄',性:'通用',效:'完美筑基'},金丹大道:{阶:'地',性:'通用',效:'凝结金丹'},万剑归宗诀:{阶:'天',性:'金剑',效:'剑阁镇宗御万剑'},庚金神雷:{阶:'天',性:'金雷',效:'金雷双修'},百花真经:{阶:'地',性:'木',效:'百花谷以花入道'},建木通天诀:{阶:'天',性:'木',效:'建木宗镇宗'},万木朝宗:{阶:'仙',性:'木',效:'青帝遗留掌控万木'},玄冰诀:{阶:'地',性:'水冰',效:'万法宗心如冰清'},北冥真经:{阶:'天',性:'水',效:'玄武宗吞噬转化'},海纳百川:{阶:'仙',性:'水',效:'归墟容纳万物'},朱雀涅槃经:{阶:'天',性:'火',效:'离火宫涅槃重生'},太阳真火:{阶:'天',性:'火',效:'极致阳火'},祝融神火:{阶:'仙',性:'火',效:'火神遗留'},不动明王身:{阶:'天',性:'土佛',效:'金刚寺防御无敌'},九天雷神诀:{阶:'天',性:'雷',效:'代天行罚'},虚空经:{阶:'天',性:'空间',效:'空间属性罕见'},轮回经:{阶:'仙',性:'轮回',效:'{{user}}专属因果重大'},万法归宗:{阶:'天',性:'通用',效:'万法宗模拟万法'},医仙宝典:{阶:'天',性:'医道',效:'药王谷活死人'},天魔策:{阶:'天',性:'魔道',效:'速成隐患大'},斩轮回剑典:{阶:'仙',性:'剑轮回',效:'{{user}}前世斩因果'},剑意通神:{阶:'仙',性:'剑道',效:'意即为剑'}}),法宝库:c.z.record(c.z.string().describe('法宝名'),f).prefault({青锋剑:{阶:'法器',类:'剑',特:'制式长剑'},秋水剑:{阶:'灵器',类:'剑',特:'水系剑修'},离火剑:{阶:'法宝',类:'剑',特:'火焰剑气'},寒镜剑:{阶:'法宝',类:'剑',特:'映照人心'},红绡枪:{阶:'法宝',类:'枪',特:'破军杀阵'},青龙剑:{阶:'灵宝',类:'剑',特:'青龙魂木性'},白虎剑:{阶:'灵宝',类:'剑',特:'杀伐金性'},朱雀剑:{阶:'灵宝',类:'剑',特:'火焰化形'},玄武剑:{阶:'灵宝',类:'剑',特:'防御水性'},斩轮回:{阶:'仙器',类:'剑',特:'斩因果残破'},镇渊剑:{阶:'仙器',类:'剑',特:'{{user}}本命可成长'},双鱼佩:{阶:'仙器',类:'护身',特:'时空小世界'},绯月神弓:{阶:'法宝',类:'弓',特:'朱雀远程'},碧玉瑶琴:{阶:'法宝',类:'琴',特:'治愈心魔'},千丝罗网:{阶:'灵宝',类:'法器',特:'织梦幻术'},雪魄琉璃炉:{阶:'灵宝',类:'丹炉',特:'冰雪炼丹'},龙鳞护甲:{阶:'灵宝',类:'防御',特:'真龙鳞片'},储物袋:{阶:'法器',类:'储物',特:'基础空间小'},储物戒:{阶:'灵器',类:'储物',特:'空间大便携'},乾坤袋:{阶:'法宝',类:'储物',特:'巨大装活物'},洞天宝:{阶:'灵宝',类:'储物',特:'小世界可居'}}),地点库:c.z.record(c.z.string().describe('地点名'),u).prefault({天渊:{域:'天层',类:'禁地',危:95,特:'星辰裂隙连域外',资:['星辰碎片','陨铁']},罡风带:{域:'天层',类:'禁地',危:90,特:'罡风元婴难越',资:['罡风精华']},问道峰:{域:'神州',类:'宗门',危:10,特:'万法宗高九千丈',资:['功法','灵药']},剑门关:{域:'神州',类:'宗门',危:15,特:'剑阁悬空天堑',资:['剑意','飞剑']},藏书阁:{域:'神州',类:'宗门',危:5,特:'九层古籍守护灵',资:['功法','秘术']},酆都城:{域:'神州',类:'城镇',危:30,特:'阴阳交汇鬼市',资:['幽冥材料']},龙门瀑:{域:'神州',类:'秘境',危:40,特:'鲤鱼跃龙门',资:['龙气','化龙机缘']},建木林:{域:'东苍',类:'地形',危:50,特:'原始林古树精',资:['灵木','妖丹']},青帝陵:{域:'东苍',类:'遗迹',危:85,特:'青帝传承考验',资:['青帝传承']},百花境:{域:'东苍',类:'秘境',危:20,特:'四季花开',资:['灵花','花粉']},不灭火山:{域:'南炎',类:'地形',危:80,特:'朱雀涅槃处',资:['朱雀火']},地火窟:{域:'南炎',类:'地形',危:60,特:'地火炼器',资:['地心火']},涅槃台:{域:'南炎',类:'遗迹',危:70,特:'涅槃真意',资:['涅槃感悟']},万剑冢:{域:'西庚',类:'禁地',危:85,特:'战场剑意不散',资:['剑意','古剑']},庚金脉:{域:'西庚',类:'地形',危:40,特:'庚金炼剑',资:['庚金']},玄冰山:{域:'北冥',类:'宗门',危:50,特:'玄武宗冰山',资:['玄冰']},归墟眼:{域:'北冥',类:'禁地',危:99,特:'吞噬万物终结',资:['归墟感悟']},黄泉迹:{域:'下层',类:'遗迹',危:90,特:'天河通幽冥',资:['黄泉水']},炎渊:{域:'下层',类:'禁地',危:95,特:'地心火狱',资:['地心火']}}),灵根库:c.z.record(c.z.string().describe('灵根名'),m).prefault({金天根:{质:'天',性:'金',速:'5倍',特:'锋锐攻击强',稀:'传'},木天根:{质:'天',性:'木',速:'5倍',特:'生息恢复强',稀:'传'},水天根:{质:'天',性:'水',速:'5倍',特:'包容适应强',稀:'传'},火天根:{质:'天',性:'火',速:'5倍',特:'爆发威力大',稀:'传'},土天根:{质:'天',性:'土',速:'5倍',特:'厚重防御强',稀:'传'},金木双根:{质:'极',性:'金木',速:'3倍',特:'克生特殊法',稀:'稀'},水火双根:{质:'极',性:'水火',速:'3倍',特:'既济阴阳和',稀:'稀'},金火双根:{质:'极',性:'金火',速:'3倍',特:'炼金器战斗',稀:'稀'},木水双根:{质:'极',性:'木水',速:'3倍',特:'水生木恢复',稀:'稀'},三灵根:{质:'上',性:'三系',速:'2倍',特:'均衡多功法',稀:'罕'},四灵根:{质:'中',性:'四系',速:'1倍',特:'缓慢但全面',稀:'少'},五行杂根:{质:'下',性:'五行',速:'0.5倍',特:'杂乱修炼慢',稀:'常'},冰根:{质:'异',性:'冰',速:'4倍',特:'水变极寒冻',稀:'传'},雷根:{质:'异',性:'雷',速:'4倍',特:'金变雷霆灭',稀:'传'},风根:{质:'异',性:'风',速:'4倍',特:'木变速度快',稀:'传'},暗根:{质:'异',性:'暗',速:'4倍',特:'水变幽暗蚀',稀:'传'},光根:{质:'异',性:'光',速:'4倍',特:'火变圣光净',稀:'传'},离火根:{质:'异',性:'离火',速:'4倍',特:'朱雀涅槃生',稀:'传'},空间根:{质:'异',性:'空间',速:'5倍',特:'至高掌空间',稀:'传'},时间根:{质:'异',性:'时间',速:'5倍',特:'至高控时间',稀:'传'},混沌根:{质:'异',性:'混沌',速:'5倍',特:'至高混沌容',稀:'传'},轮回根:{质:'异',性:'轮回',速:'5倍',特:'{{user}}专属',稀:'传'},冰火双根:{质:'异',性:'冰火',速:'3.5倍',特:'两极对立统',稀:'传'},冰雷双根:{质:'异',性:'冰雷',速:'3.5倍',特:'冻结后粉碎',稀:'传'},暗幻双根:{质:'异',性:'暗幻',速:'3.5倍',特:'暗影幻术诡',稀:'传'},水龙双根:{质:'异',性:'水龙',速:'4倍',特:'龙脉掌水系',稀:'传'},冰丹双根:{质:'异',性:'冰丹',速:'3.5倍',特:'冰丹独特组',稀:'传'}}),体质库:c.z.record(c.z.string().describe('体质名'),v).prefault({凡体:{质:'凡',特:'普通无特殊',优:'无',稀:'常'},玄冰体:{质:'灵',特:'冰系法威+50%抗+80%',优:'冰系强',稀:'罕'},离火体:{质:'灵',特:'火系法威+50%抗+80%',优:'火系强',稀:'罕'},木灵体:{质:'灵',特:'恢复+100%木法+50%',优:'恢复强',稀:'罕'},天籁体:{质:'灵',特:'音律治愈心魔',优:'音律神通',稀:'罕'},花妖体:{质:'灵',特:'倾城魅惑控花草',优:'魅惑控制',稀:'稀'},朱雀脉:{质:'道',特:'火法+100%涅槃生',优:'涅槃重生',稀:'传'},真龙脉:{质:'道',特:'体质+200%龙神通',优:'龙族神通',稀:'传'},战体:{质:'道',特:'战力+100%战意厉',优:'战斗天赋',稀:'传'},梦魇体:{质:'道',特:'操梦幻术情报',优:'幻术神通',稀:'传'},雪魂体:{质:'道',特:'冰法+150%雪神通',优:'冰系至强',稀:'传'},混沌体:{质:'圣',特:'修任何法无限制',优:'包容万物',稀:'传'},道体:{质:'圣',特:'悟+300%速+200%',优:'悟性无双',稀:'传'},金身:{质:'圣',特:'防+500%几乎不死',优:'防御无敌',稀:'传'},轮回体:{质:'神',特:'{{user}}专属轮回通',优:'斩因果',稀:'传'},时空体:{质:'神',特:'时空通逆因果',优:'时空神通',稀:'传'}}),本尊:c.z.object({等级:c.z.coerce.number().transform(e=>_.clamp(e,1,36)),修为:c.z.coerce.number().transform(e=>Math.max(0,e)),灵根:c.z.string().prefault('五行杂灵根'),体质:c.z.string().prefault('凡体'),功法:c.z.string().prefault('无'),本命兵器:c.z.string().prefault('无'),神通列表:c.z.record(c.z.string().describe('神通名'),c.z.string().describe('神通描述')).prefault({}),灵石:c.z.coerce.number().transform(e=>Math.max(0,e)),已活岁月:c.z.coerce.number().transform(e=>Math.max(0,e)),尝试突破:c.z.boolean().prefault(!1),行踪:c.z.object({当前区域:c.z.string().prefault('未知之地'),所属层级:c.z.string().optional(),环境描述:c.z.string().optional(),危险度:c.z.coerce.number().optional(),可用通道:c.z.array(c.z.string()).optional(),导航信息:c.z.string().optional()}),身份:c.z.object({姓名:c.z.string().prefault('无名氏'),宗门:c.z.string().prefault('散修'),出身:c.z.string().prefault('凡人')}),背包:c.z.record(c.z.string().describe('物品名'),b).prefault({}).transform(e=>_.pickBy(e,({数量:e})=>e>0)),法宝:c.z.record(c.z.string().describe('法宝名'),b).prefault({}).transform(e=>_.pickBy(e,({数量:e})=>e>0)),杂物袋:c.z.record(c.z.string().describe('杂物名'),b).prefault({}).transform(e=>_.pickBy(e,({数量:e})=>e>0))}).transform(e=>{const t=e.等级,a=i[t-1]??100,r=d[t-1]??100,n=Math.floor((t-1)/4),o=`${l[n]??'练气'}${s[(t-1)%4]??'初期'}`,c=`${e.已活岁月}/${r}`,b=e.尝试突破?'突破中':e.修为>=a?'瓶颈期':'修炼中',g=`${(e.修为/a*100).toFixed(1)}%`;return{...e,突破阈值:a,寿元上限:r,境界描述:o,寿元状态:c,状态:b,进度:g}}),红颜角色库:c.z.record(c.z.string().describe('角色名'),c.z.object({级:c.z.coerce.number().transform(e=>_.clamp(e,1,36)),根:c.z.string().describe('灵根'),质:c.z.string().describe('体质'),龄:c.z.string().describe('年龄'),属:c.z.string().describe('所属'),法:c.z.string().describe('功法'),器:c.z.string().describe('本命兵器'),通:c.z.array(c.z.string()).prefault([]),型:c.z.enum(['核心','重要','次要'])})).prefault({凌寒镜:{级:11,根:'冰根极',质:'玄冰体',龄:'24',属:'万法宗真传',法:'玄冰诀地/心镜天',器:'北冥弓灵',通:['冰镜映心','千里冰封'],型:'核心'},虞汐颜:{级:12,根:'水阴阳异',质:'双鱼体',龄:'化形3年',属:'{{user}}玉佩',法:'双生天极/阴阳',器:'双鱼佩本体',通:['枯木春','夺命妆','双鱼梦'],型:'核心'},白清弦:{级:29,根:'金天根',质:'剑体',龄:'外30实328',属:'散修剑宗师',法:'剑意仙/天音天',器:'清弦琴剑灵宝',通:['琴剑杀','剑意歌','万剑心'],型:'核心'},焰绯月:{级:12,根:'离火根极',质:'朱雀脉',龄:'25',属:'离火宫圣女',法:'朱雀天',器:'绯月弓法宝',通:['离火天','朱雀身','凤凰槃'],型:'重要'},幻千丝:{级:13,根:'暗幻双根',质:'梦魇体',龄:'外20未知',属:'散修幽冥',法:'织梦天',器:'千丝网灵宝',通:['织梦笼','心魔境','千丝缚'],型:'重要'},花想容:{级:8,根:'木根',质:'花妖体',龄:'外12',属:'建木宗',法:'百花地',器:'牡丹瓣',通:['花海域','治愈粉','魅惑香'],型:'次要'},敖清霜:{级:14,根:'水龙双根',质:'真龙脉',龄:'外20实150',属:'龙宫三公主',法:'沧海天',器:'龙鳞甲灵宝',通:['龙变化','呼风雨','龙威慑'],型:'次要'}}),红颜:c.z.record(c.z.string().describe('红颜名'),c.z.object({等级:c.z.coerce.number().transform(e=>_.clamp(e,1,36)).prefault(1),修为:c.z.coerce.number().transform(e=>Math.max(0,e)).prefault(0),灵根:c.z.string().prefault('五行杂灵根'),体质:c.z.string().prefault('凡体'),功法:c.z.string().prefault('无'),本命兵器:c.z.string().prefault('无'),神通列表:c.z.record(c.z.string().describe('神通名'),c.z.string().describe('神通描述')).prefault({}),灵石:c.z.coerce.number().transform(e=>Math.max(0,e)).prefault(0),已活岁月:c.z.coerce.number().transform(e=>Math.max(0,e)).prefault(0),尝试突破:c.z.boolean().prefault(!1),好感度:c.z.coerce.number().transform(e=>_.clamp(e,-100,100)).prefault(0),关系:c.z.string().prefault('陌生人'),重要性:c.z.string().prefault('路人')}).transform(e=>{const t=e.等级,a=i[t-1]??100,r=d[t-1]??100,n=Math.floor((t-1)/4),o=`${l[n]??'练气'}${s[(t-1)%4]??'初期'}`,c=`${e.已活岁月}/${r}`,b=e.尝试突破?'突破中':e.修为>=a?'瓶颈期':'修炼中',g=`${(e.修为/a*100).toFixed(1)}%`;return{...e,突破阈值:a,寿元上限:r,境界描述:o,寿元状态:c,状态:b,进度:g}})).prefault({}),NPC图鉴:c.z.record(c.z.string().describe('NPC名'),c.z.object({等级:c.z.coerce.number().transform(e=>_.clamp(e,1,36)).prefault(1),修为:c.z.coerce.number().transform(e=>Math.max(0,e)).prefault(0),灵根:c.z.string().prefault('五行杂灵根'),体质:c.z.string().prefault('凡体'),功法:c.z.string().prefault('无'),本命兵器:c.z.string().prefault('无'),神通列表:c.z.record(c.z.string().describe('神通名'),c.z.string().describe('神通描述')).prefault({}),灵石:c.z.coerce.number().transform(e=>Math.max(0,e)).prefault(0),已活岁月:c.z.coerce.number().transform(e=>Math.max(0,e)).prefault(0),尝试突破:c.z.boolean().prefault(!1),所在宗门:c.z.string().prefault('散修')})).prefault({}),任务列表:c.z.record(c.z.string().describe('任务名'),c.z.object({类型:c.z.enum(['主线','支线','每日','临危受命']),说明:c.z.string().describe('面向{{user}}的任务背景或细则'),目标:c.z.string().describe('明确可执行的目标描述'),奖励:c.z.string(),惩罚:c.z.string().describe('失败后触发的负面效果'),状态:c.z.enum(['进行中','已完成','已失败']).prefault('进行中')})).prefault({}),声望系统:c.z.record(c.z.string().describe('势力名'),c.z.object({声望值:c.z.coerce.number().transform(e=>_.clamp(e,-100,100)),称号:c.z.string().optional(),关系描述:c.z.string()})).prefault({})}),h={火:{effect:'灼烧',visual:'烈焰',nature:'爆裂',color:'#ff4444'},水:{effect:'缠绕',visual:'激流',nature:'柔韧',color:'#4488ff'},冰:{effect:'冻结',visual:'寒霜',nature:'极寒',color:'#88ddff'},雷:{effect:'麻痹',visual:'紫电',nature:'狂暴',color:'#aa44ff'},风:{effect:'切割',visual:'罡风',nature:'无形',color:'#88ff88'},土:{effect:'镇压',visual:'岩铠',nature:'厚重',color:'#aa8844'},木:{effect:'寄生',visual:'藤蔓',nature:'生生不息',color:'#44aa44'},金:{effect:'穿透',visual:'锐金',nature:'锋利',color:'#ffdd44'},暗:{effect:'腐蚀',visual:'黑雾',nature:'诡谲',color:'#442244'},光:{effect:'净化',visual:'圣辉',nature:'神圣',color:'#ffffaa'},混沌:{effect:'湮灭',visual:'灰光',nature:'虚无',color:'#888888'}};function N(e){return['#888888','#44aa44','#4488ff','#aa44ff','#ff4444','#ffaa00','#ffdd44','#ffffff','#ff88ff'][Math.floor((e-1)/4)]||'#888888'}function E(e){return e>=90?'#ff0000':e>=70?'#ff4400':e>=50?'#ff8800':e>=30?'#ffcc00':'#44aa44'}const V=_;var k=n.n(V);const B={孟十七:{normal:{front:'https://files.catbox.moe/c1su29.jpg',back:'https://files.catbox.moe/c1su29.jpg'},shy:'https://files.catbox.moe/8doe0f.jpg',smile:'https://files.catbox.moe/8doe0f.jpg',angry:'https://files.catbox.moe/c1su29.jpg',cry:'https://files.catbox.moe/c1su29.jpg',surprise:'https://files.catbox.moe/8doe0f.jpg'},白清弦:{normal:{front:'random_front',back:'random_back'}},虞汐颜:{normal:{front:'random_dual_front',back:'random_dual_back'}}},x={白清弦:{front:['https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/白清弦1.png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/白清弦2.png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/白清弦3.png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/白清弦4.png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/白清弦5.png'],back:['https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/白清弦6.png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/白清弦7.png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/白清弦8.png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/白清弦9.png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/白清弦10.png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/白清弦11.png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/白清弦12.png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/白清弦13.png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/白清弦14.png']},虞汐颜:{虞汐_front:['https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/虞汐 (1).png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/虞汐 (15).png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/虞汐 (16).png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/虞汐 (6).png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/虞汐 (5).png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/虞汐 (3).png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/虞汐 (2).png'],虞汐_back:['https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/虞汐 (17).png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/虞汐 (8).png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/虞汐 (7).png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/虞汐 (4).png'],虞颜_front:['https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/虞颜 (15).png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/虞颜 (14).png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/虞颜 (13).png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/虞颜 (12).png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/虞颜 (11).png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/虞颜 (10).png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/虞颜 (9).png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/虞颜 (8).png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/虞颜 (7).png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/虞颜 (6).png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/虞颜 (1).png'],虞颜_back:['https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/虞颜 (5).png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/虞颜 (4).png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/虞颜 (3).png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/虞颜 (2).png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/虞颜 (18).png']}},S='normal',C='https://files.catbox.moe/placeholder.jpg';let M=null,D=!1;function w(e,t){const a=x[e];if(!a)return console.warn(`[图鉴] 未找到角色 "${e}" 的图片池`),C;const r=a[t];if(!r||0===r.length)return console.warn(`[图鉴] 角色 "${e}" 的 ${t} 图片池为空`),C;return r[Math.floor(Math.random()*r.length)]}function A(e){const t=x['虞汐颜'];if(!t)return console.warn('[图鉴] 未找到虞汐颜的图片池'),{url:C,soulName:'虞汐颜'};if('front'===e){if(D)return console.info('[图鉴] 虞汐颜卡片已生成，跳过重复生成'),null;D=!0;const e=Math.random()<.5?'虞汐':'虞颜';M=e;const a=t[`${e}_front`];if(!a||0===a.length)return console.warn(`[图鉴] 虞汐颜的 ${e} 正面图片池为空`),{url:C,soulName:e};const r=Math.floor(Math.random()*a.length);return console.info(`[图鉴] 虞汐颜正面选择: ${e}`),{url:a[r],soulName:e}}{const e='虞汐'===M?'虞颜':'虞汐',a=t[`${e}_back`];if(!a||0===a.length)return console.warn(`[图鉴] 虞汐颜的 ${e} 背面图片池为空`),{url:C,soulName:e};const r=Math.floor(Math.random()*a.length);return console.info(`[图鉴] 虞汐颜背面选择: ${e}`),{url:a[r],soulName:e}}}function j(e,t){if('string'==typeof e)return{front:e,back:e};if('虞汐颜'===t&&'random_dual_front'===e.front){const e=A('front');if(null===e)return null;const t=A('back');return null===t?null:{front:e.url,back:t.url,frontName:e.soulName,backName:t.soulName}}let a=e.front,r=e.back??e.front;return'random_front'===a&&(a=w(t,'front')),'random_back'===r&&(r=w(t,'back')),{front:a,back:r}}function T(e,t,a){const r=B[e];if(!r)return{front:C,back:C};const n=r[t]??r[S];if(!n)return{front:C,back:C};const o=j(n,e);return null===o?null:{front:o.front,back:o.back,frontName:o.frontName,backName:o.backName}}const P={cloudImage:'url(https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/古风祥云云朵85.png)',cloudsMulti:'\n    url(https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/古风祥云云朵85.png),\n    url(https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/古风祥云云朵85.png),\n    url(https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/古风祥云云朵85.png),\n    url(https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/古风祥云云朵85.png),\n    url(https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/古风祥云云朵85.png)\n  ',cloudsWithStars:'\n    url(https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/古风祥云云朵85.png),\n    url(https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/古风祥云云朵85.png),\n    url(https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/古风祥云云朵85.png),\n    url(https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/古风祥云云朵85.png),\n    url(https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/古风祥云云朵85.png),\n    radial-gradient(circle at 25% 20%, rgba(255, 255, 255, 0.15) 1px, transparent 1px),\n    radial-gradient(circle at 75% 35%, rgba(255, 255, 255, 0.12) 1.5px, transparent 1.5px),\n    radial-gradient(circle at 35% 75%, rgba(255, 255, 255, 0.1) 1px, transparent 1px)\n  ',stars:'\n    radial-gradient(circle at 20% 30%, rgba(255, 255, 255, 0.3) 1px, transparent 1px),\n    radial-gradient(circle at 80% 60%, rgba(255, 255, 255, 0.25) 1.5px, transparent 1.5px),\n    radial-gradient(circle at 40% 80%, rgba(255, 255, 255, 0.2) 1px, transparent 1px),\n    radial-gradient(circle at 60% 20%, rgba(255, 255, 255, 0.15) 2px, transparent 2px)\n  ',texture:'\n    repeating-linear-gradient(\n      45deg,\n      transparent,\n      transparent 10px,\n      rgba(255, 255, 255, 0.03) 10px,\n      rgba(255, 255, 255, 0.03) 20px\n    )\n  ',landscape:'\n    linear-gradient(180deg,\n      transparent 0%,\n      rgba(255, 255, 255, 0.02) 30%,\n      rgba(255, 255, 255, 0.05) 50%,\n      rgba(255, 255, 255, 0.02) 70%,\n      transparent 100%\n    )\n  ',lotus:'\n    radial-gradient(ellipse 120px 80px at 50% 50%, rgba(255, 255, 255, 0.08) 0%, transparent 50%)\n  '},F=[{id:'default',name:'玄青仙境',description:'深邃玄青，如夜空星辰',colors:{bgPrimary:'linear-gradient(180deg, rgba(49, 66, 117, 0.95) 0%, rgba(15, 20, 35, 0.98) 100%)',bgSecondary:'rgba(30, 40, 60, 0.5)',border:'rgba(100, 150, 200, 0.3)',borderActive:'rgba(100, 150, 200, 0.6)',textPrimary:'#e0e8f0',textSecondary:'#8090a0',textAccent:'#a0b8d0',accent:'#88aacc',accentGlow:'rgba(100, 150, 255, 0.3)',buttonBg:'rgba(100, 150, 200, 0.2)',buttonHover:'rgba(100, 150, 200, 0.3)',buttonActive:'linear-gradient(135deg, rgba(80, 120, 180, 0.3) 0%, rgba(100, 80, 160, 0.3) 100%)',progressBg:'rgba(50, 60, 80, 0.8)',headerBg:'linear-gradient(90deg, rgba(60, 80, 120, 0.4) 0%, rgba(80, 60, 100, 0.4) 100%)',tabBg:'rgba(30, 40, 60, 0.5)',tabActive:'linear-gradient(135deg, rgba(80, 120, 180, 0.3) 0%, rgba(100, 80, 160, 0.3) 100%)',footerBg:'rgba(20, 30, 45, 0.8)'},patterns:{overlay:P.cloudsWithStars}},{id:'purple',name:'紫霞仙踪',description:'紫气东来，霞光万道',colors:{bgPrimary:'linear-gradient(180deg, rgba(80, 40, 100, 0.95) 0%, rgba(30, 15, 40, 0.98) 100%)',bgSecondary:'rgba(50, 30, 70, 0.5)',border:'rgba(150, 100, 200, 0.3)',borderActive:'rgba(180, 120, 220, 0.6)',textPrimary:'#f0e0f8',textSecondary:'#a080b0',textAccent:'#c0a0d0',accent:'#aa88cc',accentGlow:'rgba(150, 100, 255, 0.4)',buttonBg:'rgba(150, 100, 200, 0.2)',buttonHover:'rgba(150, 100, 200, 0.3)',buttonActive:'linear-gradient(135deg, rgba(120, 80, 160, 0.3) 0%, rgba(140, 60, 180, 0.3) 100%)',progressBg:'rgba(60, 40, 80, 0.8)',headerBg:'linear-gradient(90deg, rgba(80, 50, 100, 0.4) 0%, rgba(100, 40, 120, 0.4) 100%)',tabBg:'rgba(50, 30, 70, 0.5)',tabActive:'linear-gradient(135deg, rgba(120, 80, 160, 0.3) 0%, rgba(140, 60, 180, 0.3) 100%)',footerBg:'rgba(30, 20, 50, 0.8)'},patterns:{overlay:P.cloudsMulti}},{id:'red',name:'赤炎烈焰',description:'烈火焚天，赤炎千里',colors:{bgPrimary:'linear-gradient(180deg, rgba(100, 40, 40, 0.95) 0%, rgba(40, 15, 15, 0.98) 100%)',bgSecondary:'rgba(70, 30, 30, 0.5)',border:'rgba(200, 100, 100, 0.3)',borderActive:'rgba(220, 120, 120, 0.6)',textPrimary:'#f8e0e0',textSecondary:'#b08080',textAccent:'#d0a0a0',accent:'#cc8888',accentGlow:'rgba(255, 100, 100, 0.4)',buttonBg:'rgba(200, 100, 100, 0.2)',buttonHover:'rgba(200, 100, 100, 0.3)',buttonActive:'linear-gradient(135deg, rgba(160, 80, 80, 0.3) 0%, rgba(180, 60, 60, 0.3) 100%)',progressBg:'rgba(80, 40, 40, 0.8)',headerBg:'linear-gradient(90deg, rgba(100, 50, 50, 0.4) 0%, rgba(120, 40, 40, 0.4) 100%)',tabBg:'rgba(70, 30, 30, 0.5)',tabActive:'linear-gradient(135deg, rgba(160, 80, 80, 0.3) 0%, rgba(180, 60, 60, 0.3) 100%)',footerBg:'rgba(50, 20, 20, 0.8)'},patterns:{overlay:P.cloudsMulti}},{id:'cyan',name:'碧海青天',description:'碧波荡漾，海天一色',colors:{bgPrimary:'linear-gradient(180deg, rgba(40, 80, 100, 0.95) 0%, rgba(15, 30, 40, 0.98) 100%)',bgSecondary:'rgba(30, 60, 70, 0.5)',border:'rgba(100, 180, 200, 0.3)',borderActive:'rgba(120, 200, 220, 0.6)',textPrimary:'#e0f0f8',textSecondary:'#80a0b0',textAccent:'#a0c0d0',accent:'#88ccdd',accentGlow:'rgba(100, 200, 255, 0.4)',buttonBg:'rgba(100, 180, 200, 0.2)',buttonHover:'rgba(100, 180, 200, 0.3)',buttonActive:'linear-gradient(135deg, rgba(80, 140, 160, 0.3) 0%, rgba(60, 160, 180, 0.3) 100%)',progressBg:'rgba(40, 60, 80, 0.8)',headerBg:'linear-gradient(90deg, rgba(50, 80, 100, 0.4) 0%, rgba(40, 100, 120, 0.4) 100%)',tabBg:'rgba(30, 60, 70, 0.5)',tabActive:'linear-gradient(135deg, rgba(80, 140, 160, 0.3) 0%, rgba(60, 160, 180, 0.3) 100%)',footerBg:'rgba(20, 40, 50, 0.8)'},patterns:{overlay:P.cloudsWithStars}},{id:'gold',name:'金辉灿烂',description:'金光璀璨，辉映九天',colors:{bgPrimary:'linear-gradient(180deg, rgba(80, 70, 40, 0.95) 0%, rgba(30, 25, 15, 0.98) 100%)',bgSecondary:'rgba(60, 50, 30, 0.5)',border:'rgba(200, 180, 100, 0.3)',borderActive:'rgba(220, 200, 120, 0.6)',textPrimary:'#f8f0e0',textSecondary:'#b0a080',textAccent:'#d0c0a0',accent:'#ccaa88',accentGlow:'rgba(255, 200, 100, 0.4)',buttonBg:'rgba(200, 180, 100, 0.2)',buttonHover:'rgba(200, 180, 100, 0.3)',buttonActive:'linear-gradient(135deg, rgba(160, 140, 80, 0.3) 0%, rgba(180, 160, 60, 0.3) 100%)',progressBg:'rgba(60, 50, 40, 0.8)',headerBg:'linear-gradient(90deg, rgba(80, 70, 50, 0.4) 0%, rgba(100, 80, 40, 0.4) 100%)',tabBg:'rgba(60, 50, 30, 0.5)',tabActive:'linear-gradient(135deg, rgba(160, 140, 80, 0.3) 0%, rgba(180, 160, 60, 0.3) 100%)',footerBg:'rgba(40, 35, 20, 0.8)'},patterns:{overlay:P.cloudsMulti}},{id:'green',name:'翠竹清风',description:'竹影婆娑，清风徐来',colors:{bgPrimary:'linear-gradient(180deg, rgba(40, 80, 60, 0.95) 0%, rgba(15, 30, 25, 0.98) 100%)',bgSecondary:'rgba(30, 60, 50, 0.5)',border:'rgba(100, 180, 150, 0.3)',borderActive:'rgba(120, 200, 170, 0.6)',textPrimary:'#e0f8f0',textSecondary:'#80b0a0',textAccent:'#a0d0c0',accent:'#88ccaa',accentGlow:'rgba(100, 255, 200, 0.4)',buttonBg:'rgba(100, 180, 150, 0.2)',buttonHover:'rgba(100, 180, 150, 0.3)',buttonActive:'linear-gradient(135deg, rgba(80, 140, 120, 0.3) 0%, rgba(60, 160, 140, 0.3) 100%)',progressBg:'rgba(40, 60, 50, 0.8)',headerBg:'linear-gradient(90deg, rgba(50, 80, 70, 0.4) 0%, rgba(40, 100, 80, 0.4) 100%)',tabBg:'rgba(30, 60, 50, 0.5)',tabActive:'linear-gradient(135deg, rgba(80, 140, 120, 0.3) 0%, rgba(60, 160, 140, 0.3) 100%)',footerBg:'rgba(20, 40, 35, 0.8)'},patterns:{overlay:P.cloudsMulti}}];function I(e){return F.find(t=>t.id===e)}function O(e){D=!1,M=null,console.info('[图鉴] 虞汐颜会话缓存已重置');const t=[];for(const a of e){const e=T(a.name,a.img_code,a.back_img_code);null!==e?t.push({name:a.name,front:e.front,back:e.back,backText:a.back_text||'',isFlipped:!1,frontName:e.frontName,backName:e.backName}):console.info(`[图鉴] 跳过重复的 ${a.name} 卡片`)}return t}const G=t('data',errorCatched(()=>{const e=getCurrentMessageId(),t=(0,o.ref)(null),a=(0,o.ref)([]),r=new Map,n=(a=0)=>{try{const a=getVariables({type:'message',message_id:e}),r=k().get(a,'stat_data',null);if(r&&Object.keys(r).length>0)t.value=y.parse(r);else if(null==r){const e=y.parse({});return t.value=e,console.info('[踏月寻仙] 使用默认值初始化变量数据',{等级:e.本尊.等级,灵根:e.本尊.灵根,体质:e.本尊.体质,功法:e.本尊.功法}),toastr.info('当前楼层无数据，已使用默认值初始化','踏月寻仙'),void i()}console.info('[踏月寻仙] 成功加载变量数据',{等级:t.value?.本尊.等级,灵根:t.value?.本尊.灵根,体质:t.value?.本尊.体质,功法:t.value?.本尊.功法}),i()}catch(e){console.error('[踏月寻仙] 初始化数据失败',e),a<5?(console.info(`[踏月寻仙] 数据未就绪，200ms后第${a+1}次重试`),setTimeout(()=>{n(a+1)},200)):(console.warn('[踏月寻仙] 重试次数已用完，尝试手动触发MVU解析'),c())}},c=async()=>{try{await waitGlobalInitialized('Mvu');const a=getChatMessages(e);if(0===a.length)return console.warn('[踏月寻仙] 无法获取当前消息内容'),void l();const r=a[0].message||'';console.info('[踏月寻仙] 尝试手动触发MVU解析，消息长度:',r.length);const n=Mvu.getMvuData({type:'message',message_id:e}),o=await Mvu.parseMessage(r,n);await Mvu.replaceMvuData(o,{type:'message',message_id:e}),console.info('[踏月寻仙] MVU手动解析完成，重新加载数据'),setTimeout(()=>{const a=getVariables({type:'message',message_id:e}),r=k().get(a,'stat_data',null);r&&Object.keys(r).length>0?(t.value=y.parse(r),console.info('[踏月寻仙] ✅ 手动解析后成功加载数据'),toastr.success('已成功初始化状态数据','踏月寻仙'),i()):(console.warn('[踏月寻仙] 手动解析后仍无数据，使用备用方案'),l())},500)}catch(e){console.error('[踏月寻仙] 手动触发MVU解析失败',e),l()}},l=()=>{console.warn('[踏月寻仙] 启用备用方案');const e=s();e?(t.value=e,console.info('[踏月寻仙] 从上一楼层继承数据用于显示（不保存）'),toastr.info('正在显示上一楼层的状态数据','踏月寻仙')):(console.warn('[踏月寻仙] 无法继承数据，使用默认值'),t.value=y.parse({}),toastr.info('使用默认状态数据','踏月寻仙')),i()},s=()=>{try{const t=getChatMessages('0-{{lastMessageId}}'),a=t.findIndex(t=>t.message_id===e);if(-1===a)return console.warn('[踏月寻仙] 无法找到当前楼层索引'),null;for(let e=a-1;e>=0;e--){const a=t[e].message_id,r=getVariables({type:'message',message_id:a}),n=k().get(r,'stat_data',null);if(n){const e=y.parse(n);return console.info(`[踏月寻仙] 从第 ${a} 楼继承数据`),e}}return console.warn('[踏月寻仙] 前面的楼层都没有有效数据'),null}catch(e){return console.error('[踏月寻仙] 继承数据时出错',e),null}},i=()=>{try{const t=getChatMessages(e);if(t.length>0){const n=t[0].message||'',o=`${e}_${n.length}`;if(r.has(o))return a.value=r.get(o),void console.info('[图鉴] 使用缓存的角色卡片');const c=function(e){try{const t=e.match(/<visual_cards>\s*([\s\S]*?)\s*<\/visual_cards>/);if(!t)return[];const a=t[1].trim();if(!a)return[];const r=JSON.parse(a);return Array.isArray(r)?r.filter(e=>e.name&&e.img_code&&'string'==typeof e.back_text):(console.warn('[图鉴] visual_cards 不是数组'),[])}catch(e){return console.error('[图鉴] 解析 visual_cards 失败',e),[]}}(n);if(c.length>0){const e=O(c);a.value=e,r.set(o,e),d(e),console.info('[图鉴] 解析到角色卡片',e.length,'张')}else a.value=[]}}catch(e){console.error('[图鉴] 解析消息卡片失败',e),toastr.warning(`解析角色卡片失败: ${e instanceof Error?e.message:'未知错误'}`,'图鉴')}},d=e=>{e.forEach(e=>{(new Image).src=e.front;(new Image).src=e.back}),console.info('[图鉴] 开始预加载',2*e.length,'张图片')};waitGlobalInitialized('Mvu').then(()=>{console.info('[踏月寻仙] MVU 框架已初始化，开始加载数据'),n()}).catch(()=>{console.warn('[踏月寻仙] MVU 框架未加载，直接初始化'),n()}),eventOn(tavern_events.MESSAGE_UPDATED,t=>{t===e&&(console.info('[踏月寻仙] 检测到消息更新，重新加载数据'),setTimeout(()=>n(),200))}),eventOn(tavern_events.MESSAGE_DELETED,e=>{console.info('[踏月寻仙] 检测到消息删除（可能是重新roll），准备重新初始化')}),eventOn(tavern_events.MESSAGE_RECEIVED,t=>{t===e&&(console.info('[踏月寻仙] 检测到新消息接收，重新加载数据'),setTimeout(()=>n(),500))}),waitGlobalInitialized('Mvu').then(()=>{console.info('[踏月寻仙] 开始监听 MVU 变量更新事件'),eventOn(Mvu.events.VARIABLE_UPDATE_ENDED,(e,a)=>{try{const a=k().get(e,'stat_data',null);console.info('[踏月寻仙] MVU 变量更新事件触发',{has_stat_data:null!==a&&Object.keys(a).length>0,new_stat_data:a}),a&&Object.keys(a).length>0?(t.value=null,(0,o.nextTick)(()=>{const e=y.parse(a);t.value=e,console.info('[踏月寻仙] ✅ MVU 变量已强制更新',{等级:e.本尊.等级,灵根:e.本尊.灵根,体质:e.本尊.体质,功法:e.本尊.功法,本命兵器:e.本尊.本命兵器,灵石:e.本尊.灵石})})):console.warn('[踏月寻仙] stat_data 为空，跳过更新')}catch(e){console.error('[踏月寻仙] 处理 MVU 变量更新失败',e)}})}).catch(e=>{console.warn('[踏月寻仙] MVU 框架未加载，将仅显示静态数据',e)});const b=(0,o.computed)(()=>t.value?.世界时钟??{纪元:'末法时代',年份:1}),g=(0,o.computed)(()=>t.value?.世界地图??{}),p=(0,o.computed)(()=>t.value?.世界图志??{}),f=(0,o.computed)(()=>t.value?.本尊??y.parse({}).本尊),u=(0,o.computed)(()=>t.value?.红颜??{}),m=(0,o.computed)(()=>t.value?.NPC图鉴??{}),v=(0,o.computed)(()=>null!==t.value),h=(0,o.computed)(()=>a.value.length>0);return{rawData:t,世界时钟:b,世界地图:g,世界图志:p,本尊:f,红颜:u,NPC图鉴:m,hasData:v,refresh:n,galleryCards:a,hasGalleryCards:h,toggleCardFlip:e=>{a.value[e]&&(a.value[e].isFlipped=!a.value[e].isFlipped)},parseCurrentMessageCards:i}})),U=t('theme',()=>{const e=(0,o.ref)('default'),t=(0,o.computed)(()=>I(e.value)||F[0]),a=(0,o.computed)(()=>F);return(()=>{try{const t=getCurrentMessageId(),a=getVariables({type:'message',message_id:t}),r=k().get(a,'ui_theme_id','default');'string'==typeof r&&I(r)?(e.value=r,console.info('[主题] 加载已保存的主题:',r)):(e.value='default',console.info('[主题] 使用默认主题'))}catch(t){console.warn('[主题] 加载主题失败，使用默认主题',t),e.value='default'}})(),{currentThemeId:e,currentTheme:t,availableThemes:a,setTheme:a=>{if(I(a)){e.value=a;try{const e=getCurrentMessageId();updateVariablesWith(e=>(k().set(e,'ui_theme_id',a),e),{type:'message',message_id:e}),console.info('[主题] 主题已切换并保存:',a),toastr.success(`已切换至「${t.value.name}」主题`,'踏月寻仙')}catch(e){console.error('[主题] 保存主题失败',e),toastr.warning('主题切换成功，但保存失败','踏月寻仙')}}else console.warn('[主题] 无效的主题ID:',a)}}}),L={class:'header'},H={class:'header-left'},W=['title'],R={class:'world-time'},J={class:'theme-selector-header'},q={class:'theme-list'},K=['onClick'],Q={class:'theme-info'},X={class:'theme-name'},Y={class:'theme-desc'},Z={key:0,class:'fa-solid fa-check theme-check'},ee={class:'tab-nav'},te=['onClick'],ae={class:'content'},re={key:0,class:'panel cultivation-panel'},ne={class:'identity-section'},oe={class:'identity-name'},ce={class:'identity-info'},le={class:'realm-section'},se={class:'realm-status'},ie={class:'progress-section'},de={class:'progress-label'},be={class:'progress-bar'},ge={class:'progress-percent'},pe={class:'stats-grid'},fe={class:'stat-item'},ue={class:'stat-item'},me={class:'stat-value'},ve={class:'stat-item'},ye={class:'stat-value'},he={class:'stat-item'},Ne={class:'stat-value'},ze={class:'stat-item'},Ee={class:'stat-value gold'},Ve={class:'stat-item'},ke={class:'stat-value'},Be={class:'panel skills-panel'},xe={class:'skills-list'},Se={class:'skill-name'},_e={class:'skill-desc'},Ce={key:0,class:'empty-hint'},Me={class:'panel inventory-panel'},De={class:'inventory-section'},we={class:'items-grid'},Ae={class:'item-name'},je={class:'item-rank'},$e={class:'item-desc'},Te={key:0,class:'empty-hint'},Pe={class:'inventory-section'},Fe={class:'items-grid'},Ie={class:'item-header'},Oe={class:'item-name'},Ge={class:'item-count'},Ue={class:'item-rank'},Le={class:'item-desc'},He={key:0,class:'empty-hint'},We={class:'panel companions-panel'},Re={class:'companions-list'},Je={class:'companion-header'},qe={class:'companion-name'},Ke={class:'companion-relation'},Qe={class:'relation-value'},Xe={class:'companion-favor'},Ye={class:'favor-bar'},Ze={class:'favor-value'},et={key:0,class:'empty-hint'},tt={class:'panel map-panel'},at={class:'current-location'},rt={class:'location-name'},nt={class:'location-layer'},ot={class:'location-desc'},ct={class:'connections'},lt={class:'connections-list'},st={key:0,class:'empty-hint',style:{padding:'10px'}},it={class:'panel gallery-panel'},dt={key:0,class:'gallery-container'},bt=['onClick'],gt={class:'card-inner'},pt={class:'card-face card-front'},ft=['src','alt'],ut={class:'card-name-bar'},mt={class:'card-face card-back'},vt={class:'back-content'},yt=['src','alt'],ht={class:'back-info-panel'},Nt={class:'back-name'},zt={class:'back-text'},Et={key:1,class:'empty-hint'},Vt={class:'footer'},kt={class:'footer-item'},Bt={class:'footer-item'},xt=(0,o.defineComponent)({__name:'app',setup(e){const t=G(),a=U(),r=[{id:'cultivation',label:'修炼',icon:'fa-solid fa-yin-yang'},{id:'skills',label:'神通',icon:'fa-solid fa-hand-sparkles'},{id:'inventory',label:'储物',icon:'fa-solid fa-box-open'},{id:'companions',label:'红颜',icon:'fa-solid fa-heart'},{id:'map',label:'行踪',icon:'fa-solid fa-map'},{id:'gallery',label:'图鉴',icon:'fa-solid fa-images'}],n=(0,o.ref)('gallery'),c=(0,o.ref)(!1),l=(0,o.ref)(!1),s=()=>{c.value=!c.value},i=()=>{l.value=!l.value},d=(0,o.computed)(()=>{const e=a.currentTheme;return{'--bg-primary':e.colors.bgPrimary,'--bg-secondary':e.colors.bgSecondary,'--border-color':e.colors.border,'--border-active':e.colors.borderActive,'--text-primary':e.colors.textPrimary,'--text-secondary':e.colors.textSecondary,'--text-accent':e.colors.textAccent,'--accent-color':e.colors.accent,'--accent-glow':e.colors.accentGlow,'--button-bg':e.colors.buttonBg,'--button-hover':e.colors.buttonHover,'--button-active':e.colors.buttonActive,'--progress-bg':e.colors.progressBg,'--header-bg':e.colors.headerBg,'--tab-bg':e.colors.tabBg,'--tab-active':e.colors.tabActive,'--footer-bg':e.colors.footerBg,'--pattern-overlay':e.patterns.overlay||'none'}}),b=(0,o.computed)(()=>N(t.本尊.等级)),g=(0,o.computed)(()=>function(e){for(const[t,a]of Object.entries(h))if(e.includes(t))return a.color;return'#aaaaaa'}(t.本尊.灵根)),p=(0,o.computed)(()=>E(t.本尊.行踪.危险度??10)),f=(0,o.computed)(()=>{const e=t.本尊.行踪.所属层级;return'天层'===e?'#88ddff':'下层'===e?'#ff4444':'#44aa44'}),u=e=>{const a=t.世界地图[e];return a?E(a.danger):'#888888'};return(e,m)=>((0,o.openBlock)(),(0,o.createElementBlock)('div',{class:(0,o.normalizeClass)(['cultivation-status',{collapsed:(0,o.unref)(c)}]),style:(0,o.normalizeStyle)((0,o.unref)(d))},[(0,o.createCommentVNode)(' 背景图案层 '),m[24]||(m[24]=(0,o.createElementVNode)('div',{class:'pattern-overlay'},null,-1)),(0,o.createCommentVNode)(' 仙鹤装饰 - 顶部中央 '),m[25]||(m[25]=(0,o.createElementVNode)('div',{class:'crane-decoration'},[(0,o.createElementVNode)('img',{src:'https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/仙鹤.png',alt:'仙鹤'})],-1)),(0,o.createCommentVNode)(' 顶部：折叠按钮 + 世界时钟与位置 '),(0,o.createElementVNode)('div',L,[(0,o.createElementVNode)('div',H,[(0,o.createElementVNode)('button',{class:'collapse-btn',onClick:s,title:(0,o.unref)(c)?'展开状态栏':'收起状态栏'},[(0,o.createElementVNode)('i',{class:(0,o.normalizeClass)((0,o.unref)(c)?'fa-solid fa-chevron-down':'fa-solid fa-chevron-up')},null,2)],8,W),(0,o.createElementVNode)('button',{class:'theme-btn',onClick:i,title:'切换主题'},[...m[3]||(m[3]=[(0,o.createElementVNode)('i',{class:'fa-solid fa-palette'},null,-1)])])]),(0,o.createElementVNode)('div',R,[m[4]||(m[4]=(0,o.createElementVNode)('i',{class:'fa-solid fa-moon'},null,-1)),(0,o.createElementVNode)('span',null,(0,o.toDisplayString)((0,o.unref)(t).世界时钟.纪元)+' · 第'+(0,o.toDisplayString)((0,o.unref)(t).世界时钟.年份)+'年',1)]),(0,o.createElementVNode)('div',{class:'location',style:(0,o.normalizeStyle)({color:(0,o.unref)(f)})},[m[5]||(m[5]=(0,o.createElementVNode)('i',{class:'fa-solid fa-location-dot'},null,-1)),(0,o.createElementVNode)('span',null,(0,o.toDisplayString)((0,o.unref)(t).本尊.行踪.当前区域),1),(0,o.createElementVNode)('span',{class:'danger-badge',style:(0,o.normalizeStyle)({backgroundColor:(0,o.unref)(p)})},' 危险度 '+(0,o.toDisplayString)((0,o.unref)(t).本尊.行踪.危险度??10),5)],4)]),(0,o.createCommentVNode)(' 主题选择器弹窗 '),(0,o.createVNode)(o.Transition,{name:'theme-selector-fade'},{default:(0,o.withCtx)(()=>[(0,o.unref)(l)?((0,o.openBlock)(),(0,o.createElementBlock)('div',{key:0,class:'theme-selector-overlay',onClick:m[2]||(m[2]=e=>l.value=!1)},[(0,o.createElementVNode)('div',{class:'theme-selector',onClick:m[1]||(m[1]=(0,o.withModifiers)(()=>{},['stop']))},[(0,o.createElementVNode)('div',J,[m[7]||(m[7]=(0,o.createElementVNode)('h3',null,[(0,o.createElementVNode)('i',{class:'fa-solid fa-palette'}),(0,o.createTextVNode)(' 选择主题')],-1)),(0,o.createElementVNode)('button',{class:'close-btn',onClick:m[0]||(m[0]=e=>l.value=!1)},[...m[6]||(m[6]=[(0,o.createElementVNode)('i',{class:'fa-solid fa-times'},null,-1)])])]),(0,o.createElementVNode)('div',q,[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)((0,o.unref)(a).availableThemes,e=>((0,o.openBlock)(),(0,o.createElementBlock)('div',{key:e.id,class:(0,o.normalizeClass)(['theme-item',{active:e.id===(0,o.unref)(a).currentThemeId}]),onClick:t=>{return r=e.id,a.setTheme(r),void(l.value=!1);var r}},[(0,o.createElementVNode)('div',{class:'theme-preview',style:(0,o.normalizeStyle)({background:e.colors.bgPrimary})},[(0,o.createElementVNode)('div',{class:'theme-preview-border',style:(0,o.normalizeStyle)({borderColor:e.colors.border})},null,4)],4),(0,o.createElementVNode)('div',Q,[(0,o.createElementVNode)('div',X,(0,o.toDisplayString)(e.name),1),(0,o.createElementVNode)('div',Y,(0,o.toDisplayString)(e.description),1)]),e.id===(0,o.unref)(a).currentThemeId?((0,o.openBlock)(),(0,o.createElementBlock)('i',Z)):(0,o.createCommentVNode)('v-if',!0)],10,K))),128))])])])):(0,o.createCommentVNode)('v-if',!0)]),_:1}),(0,o.createCommentVNode)(' 主体：标签页导航 '),(0,o.createElementVNode)('div',ee,[((0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(r,e=>(0,o.createElementVNode)('button',{key:e.id,class:(0,o.normalizeClass)(['tab-btn',{active:(0,o.unref)(n)===e.id}]),onClick:t=>n.value=e.id},[(0,o.createElementVNode)('i',{class:(0,o.normalizeClass)(e.icon)},null,2),(0,o.createTextVNode)(' '+(0,o.toDisplayString)(e.label),1)],10,te)),64))]),(0,o.createCommentVNode)(' 内容区域 '),(0,o.createElementVNode)('div',ae,[(0,o.createCommentVNode)(' 修炼面板 '),'cultivation'===(0,o.unref)(n)?((0,o.openBlock)(),(0,o.createElementBlock)('div',re,[(0,o.createElementVNode)('div',ne,[(0,o.createElementVNode)('div',oe,(0,o.toDisplayString)((0,o.unref)(t).本尊.身份.姓名),1),(0,o.createElementVNode)('div',ce,[(0,o.createElementVNode)('span',null,(0,o.toDisplayString)((0,o.unref)(t).本尊.身份.宗门),1),m[8]||(m[8]=(0,o.createElementVNode)('span',{class:'divider'},'·',-1)),(0,o.createElementVNode)('span',null,(0,o.toDisplayString)((0,o.unref)(t).本尊.身份.出身),1)])]),(0,o.createElementVNode)('div',le,[(0,o.createElementVNode)('div',{class:'realm-title',style:(0,o.normalizeStyle)({color:(0,o.unref)(b)})},[m[9]||(m[9]=(0,o.createElementVNode)('i',{class:'fa-solid fa-yin-yang'},null,-1)),(0,o.createTextVNode)(' '+(0,o.toDisplayString)((0,o.unref)(t).本尊.境界描述),1)],4),(0,o.createElementVNode)('div',se,(0,o.toDisplayString)((0,o.unref)(t).本尊.状态),1)]),(0,o.createElementVNode)('div',ie,[(0,o.createElementVNode)('div',de,[m[10]||(m[10]=(0,o.createElementVNode)('span',null,'修为进度',-1)),(0,o.createElementVNode)('span',null,(0,o.toDisplayString)((0,o.unref)(t).本尊.修为)+' / '+(0,o.toDisplayString)((0,o.unref)(t).本尊.突破阈值),1)]),(0,o.createElementVNode)('div',be,[(0,o.createElementVNode)('div',{class:'progress-fill',style:(0,o.normalizeStyle)({width:(0,o.unref)(t).本尊.进度,backgroundColor:(0,o.unref)(b)})},null,4)]),(0,o.createElementVNode)('div',ge,(0,o.toDisplayString)((0,o.unref)(t).本尊.进度),1)]),(0,o.createElementVNode)('div',pe,[(0,o.createElementVNode)('div',fe,[m[11]||(m[11]=(0,o.createElementVNode)('div',{class:'stat-label'},'灵根',-1)),(0,o.createElementVNode)('div',{class:'stat-value',style:(0,o.normalizeStyle)({color:(0,o.unref)(g)})},(0,o.toDisplayString)((0,o.unref)(t).本尊.灵根),5)]),(0,o.createElementVNode)('div',ue,[m[12]||(m[12]=(0,o.createElementVNode)('div',{class:'stat-label'},'体质',-1)),(0,o.createElementVNode)('div',me,(0,o.toDisplayString)((0,o.unref)(t).本尊.体质),1)]),(0,o.createElementVNode)('div',ve,[m[13]||(m[13]=(0,o.createElementVNode)('div',{class:'stat-label'},'功法',-1)),(0,o.createElementVNode)('div',ye,(0,o.toDisplayString)((0,o.unref)(t).本尊.功法),1)]),(0,o.createElementVNode)('div',he,[m[14]||(m[14]=(0,o.createElementVNode)('div',{class:'stat-label'},'本命兵器',-1)),(0,o.createElementVNode)('div',Ne,(0,o.toDisplayString)((0,o.unref)(t).本尊.本命兵器),1)]),(0,o.createElementVNode)('div',ze,[m[15]||(m[15]=(0,o.createElementVNode)('div',{class:'stat-label'},'灵石',-1)),(0,o.createElementVNode)('div',Ee,(0,o.toDisplayString)((0,o.unref)(t).本尊.灵石),1)]),(0,o.createElementVNode)('div',Ve,[m[16]||(m[16]=(0,o.createElementVNode)('div',{class:'stat-label'},'寿元',-1)),(0,o.createElementVNode)('div',ke,(0,o.toDisplayString)((0,o.unref)(t).本尊.寿元状态),1)])])])):'skills'===(0,o.unref)(n)?((0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,{key:1},[(0,o.createCommentVNode)(' 神通面板 '),(0,o.createElementVNode)('div',Be,[(0,o.createElementVNode)('div',xe,[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)((0,o.unref)(t).本尊.神通列表,(e,t)=>((0,o.openBlock)(),(0,o.createElementBlock)('div',{key:t,class:'skill-item'},[(0,o.createElementVNode)('div',Se,(0,o.toDisplayString)(t),1),(0,o.createElementVNode)('div',_e,(0,o.toDisplayString)(e),1)]))),128)),(0,o.unref)(t).本尊.神通列表&&0!==Object.keys((0,o.unref)(t).本尊.神通列表).length?(0,o.createCommentVNode)('v-if',!0):((0,o.openBlock)(),(0,o.createElementBlock)('div',Ce,' 尚未领悟任何神通 '))])])],2112)):'inventory'===(0,o.unref)(n)?((0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,{key:2},[(0,o.createCommentVNode)(' 储物面板 '),(0,o.createElementVNode)('div',Me,[(0,o.createElementVNode)('div',De,[m[17]||(m[17]=(0,o.createElementVNode)('div',{class:'section-title'},[(0,o.createElementVNode)('i',{class:'fa-solid fa-gem'}),(0,o.createTextVNode)(' 法宝 ')],-1)),(0,o.createElementVNode)('div',we,[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)((0,o.unref)(t).本尊.法宝,(e,t)=>((0,o.openBlock)(),(0,o.createElementBlock)('div',{key:t,class:'item-card treasure'},[(0,o.createElementVNode)('div',Ae,(0,o.toDisplayString)(e.名称),1),(0,o.createElementVNode)('div',je,(0,o.toDisplayString)(e.品阶),1),(0,o.createElementVNode)('div',$e,(0,o.toDisplayString)(e.描述),1)]))),128)),0===Object.keys((0,o.unref)(t).本尊.法宝).length?((0,o.openBlock)(),(0,o.createElementBlock)('div',Te,'空空如也')):(0,o.createCommentVNode)('v-if',!0)])]),(0,o.createElementVNode)('div',Pe,[m[18]||(m[18]=(0,o.createElementVNode)('div',{class:'section-title'},[(0,o.createElementVNode)('i',{class:'fa-solid fa-box-open'}),(0,o.createTextVNode)(' 储物戒 ')],-1)),(0,o.createElementVNode)('div',Fe,[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)((0,o.unref)(t).本尊.背包,(e,t)=>((0,o.openBlock)(),(0,o.createElementBlock)('div',{key:t,class:'item-card'},[(0,o.createElementVNode)('div',Ie,[(0,o.createElementVNode)('span',Oe,(0,o.toDisplayString)(e.名称),1),(0,o.createElementVNode)('span',Ge,'×'+(0,o.toDisplayString)(e.数量),1)]),(0,o.createElementVNode)('div',Ue,(0,o.toDisplayString)(e.品阶),1),(0,o.createElementVNode)('div',Le,(0,o.toDisplayString)(e.描述),1)]))),128)),0===Object.keys((0,o.unref)(t).本尊.背包).length?((0,o.openBlock)(),(0,o.createElementBlock)('div',He,'空空如也')):(0,o.createCommentVNode)('v-if',!0)])])])],2112)):'companions'===(0,o.unref)(n)?((0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,{key:3},[(0,o.createCommentVNode)(' 红颜面板 '),(0,o.createElementVNode)('div',We,[(0,o.createElementVNode)('div',Re,[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)((0,o.unref)(t).红颜,(e,t)=>((0,o.openBlock)(),(0,o.createElementBlock)('div',{key:t,class:'companion-card'},[(0,o.createElementVNode)('div',Je,[(0,o.createElementVNode)('span',qe,(0,o.toDisplayString)(t),1),(0,o.createElementVNode)('span',{class:'companion-realm',style:(0,o.normalizeStyle)({color:(0,o.unref)(N)(e.等级)})},(0,o.toDisplayString)(e.境界描述),5)]),(0,o.createElementVNode)('div',Ke,[m[19]||(m[19]=(0,o.createElementVNode)('span',{class:'relation-label'},'关系:',-1)),(0,o.createElementVNode)('span',Qe,(0,o.toDisplayString)(e.关系),1)]),(0,o.createElementVNode)('div',Xe,[m[20]||(m[20]=(0,o.createElementVNode)('div',{class:'favor-label'},'好感度',-1)),(0,o.createElementVNode)('div',Ye,[(0,o.createElementVNode)('div',{class:'favor-fill',style:(0,o.normalizeStyle)({width:`${Math.abs(e.好感度)}%`,backgroundColor:e.好感度>=0?'#ff6b9d':'#6b7fff'})},null,4)]),(0,o.createElementVNode)('div',Ze,(0,o.toDisplayString)(e.好感度),1)])]))),128)),0===Object.keys((0,o.unref)(t).红颜).length?((0,o.openBlock)(),(0,o.createElementBlock)('div',et,'孑然一身，尚无红颜知己')):(0,o.createCommentVNode)('v-if',!0)])])],2112)):'map'===(0,o.unref)(n)?((0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,{key:4},[(0,o.createCommentVNode)(' 地图面板 '),(0,o.createElementVNode)('div',tt,[(0,o.createElementVNode)('div',at,[(0,o.createElementVNode)('div',rt,(0,o.toDisplayString)((0,o.unref)(t).本尊.行踪.当前区域),1),(0,o.createElementVNode)('div',nt,(0,o.toDisplayString)((0,o.unref)(t).本尊.行踪.所属层级),1),(0,o.createElementVNode)('div',ot,(0,o.toDisplayString)((0,o.unref)(t).本尊.行踪.环境描述),1)]),(0,o.createElementVNode)('div',ct,[m[21]||(m[21]=(0,o.createElementVNode)('div',{class:'connections-title'},'可通往：',-1)),(0,o.createElementVNode)('div',lt,[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)((0,o.unref)(t).本尊.行踪.可用通道,e=>((0,o.openBlock)(),(0,o.createElementBlock)('span',{key:e,class:'connection-item',style:(0,o.normalizeStyle)({borderColor:u(e)})},(0,o.toDisplayString)(e),5))),128)),(0,o.unref)(t).本尊.行踪.可用通道&&0!==(0,o.unref)(t).本尊.行踪.可用通道.length?(0,o.createCommentVNode)('v-if',!0):((0,o.openBlock)(),(0,o.createElementBlock)('div',st,' 尚未探明通道 '))])])])],2112)):'gallery'===(0,o.unref)(n)?((0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,{key:5},[(0,o.createCommentVNode)(' 图鉴面板 - 按比例展示卡片 '),(0,o.createElementVNode)('div',it,[(0,o.unref)(t).hasGalleryCards?((0,o.openBlock)(),(0,o.createElementBlock)('div',dt,[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)((0,o.unref)(t).galleryCards,(e,a)=>((0,o.openBlock)(),(0,o.createElementBlock)('div',{key:a,class:(0,o.normalizeClass)(['gallery-card',{flipped:e.isFlipped}]),onClick:e=>(0,o.unref)(t).toggleCardFlip(a)},[(0,o.createElementVNode)('div',gt,[(0,o.createCommentVNode)(' 正面 '),(0,o.createElementVNode)('div',pt,[(0,o.createElementVNode)('img',{src:e.front,alt:e.frontName||e.name},null,8,ft),(0,o.createElementVNode)('div',ut,(0,o.toDisplayString)(e.frontName||e.name),1)]),(0,o.createCommentVNode)(' 背面 '),(0,o.createElementVNode)('div',mt,[(0,o.createElementVNode)('div',vt,[(0,o.createElementVNode)('img',{src:e.back,alt:e.backName||e.name,class:'back-image'},null,8,yt),(0,o.createElementVNode)('div',ht,[(0,o.createElementVNode)('div',Nt,(0,o.toDisplayString)(e.backName||e.name),1),(0,o.createElementVNode)('div',zt,'「'+(0,o.toDisplayString)(e.backText)+'」',1)])])])])],10,bt))),128))])):((0,o.openBlock)(),(0,o.createElementBlock)('div',Et,' 当前场景暂无角色卡片 '))])],2112)):(0,o.createCommentVNode)('v-if',!0)]),(0,o.createCommentVNode)(' 底部：快捷信息 '),(0,o.createElementVNode)('div',Vt,[(0,o.createElementVNode)('div',kt,[m[22]||(m[22]=(0,o.createElementVNode)('i',{class:'fa-solid fa-coins'},null,-1)),(0,o.createElementVNode)('span',null,(0,o.toDisplayString)((0,o.unref)(t).本尊.灵石)+' 灵石',1)]),(0,o.createElementVNode)('div',Bt,[m[23]||(m[23]=(0,o.createElementVNode)('i',{class:'fa-solid fa-heart'},null,-1)),(0,o.createElementVNode)('span',null,(0,o.toDisplayString)((0,o.unref)(t).本尊.寿元状态),1)])])],6))}});const St=(0,n(502).A)(xt,[['__scopeId','data-v-7c4d25d8']]);$(()=>{const t=e(),a=(0,o.createApp)(St);a.use(t),a.mount('#app'),console.info('[踏月寻仙] 状态栏界面已加载')});
//# sourceMappingURL=index.js.map</script><style>.cultivation-status[data-v-7c4d25d8]{width:100%;margin:0 auto;font-family:"Microsoft YaHei","PingFang SC",sans-serif;background:var(--bg-primary);border:1px solid var(--border-color);border-radius:12px;overflow:hidden;color:var(--text-primary);font-size:14px;transition:all .3s ease;display:flex;flex-direction:column;position:relative}.cultivation-status .pattern-overlay[data-v-7c4d25d8]{position:absolute;top:0;left:0;right:0;bottom:0;background-image:var(--pattern-overlay);background-size:100px 65px,85px 55px,110px 70px,90px 60px,75px 50px;background-position:5% 15%,85% 25%,15% 65%,75% 70%,45% 85%;background-repeat:no-repeat;pointer-events:none;opacity:.25;z-index:0}.cultivation-status .crane-decoration[data-v-7c4d25d8]{position:absolute;top:22px;left:50%;transform:translateX(-50%);width:60px;height:60px;z-index:3;pointer-events:none;animation:crane-float-7c4d25d8 4s ease-in-out infinite}.cultivation-status .crane-decoration img[data-v-7c4d25d8]{width:100%;height:100%;object-fit:contain;filter:drop-shadow(0 3px 12px rgba(0,0,0,0.4))}@keyframes crane-float-7c4d25d8{0%,100%{transform:translateX(-50%) translateY(0)}50%{transform:translateX(-50%) translateY(-8px)}}.cultivation-status[data-v-7c4d25d8]>*{position:relative;z-index:1}.cultivation-status.collapsed .tab-nav[data-v-7c4d25d8],.cultivation-status.collapsed .content[data-v-7c4d25d8]{display:none}.cultivation-status.collapsed .header[data-v-7c4d25d8]{border-bottom:none}.header[data-v-7c4d25d8]{display:flex;justify-content:space-between;align-items:center;padding:20px 16px 12px 16px;min-height:80px;background:var(--header-bg);border-bottom:1px solid var(--border-color)}.header .header-left[data-v-7c4d25d8]{display:flex;gap:8px;align-items:center}.header .collapse-btn[data-v-7c4d25d8],.header .theme-btn[data-v-7c4d25d8]{display:flex;align-items:center;justify-content:center;width:28px;height:28px;background:var(--button-bg);border:1px solid var(--border-color);border-radius:6px;color:var(--text-accent);cursor:pointer;transition:all .2s}.header .collapse-btn[data-v-7c4d25d8]:hover,.header .theme-btn[data-v-7c4d25d8]:hover{background:var(--button-hover);color:var(--text-primary);border-color:var(--border-active)}.header .collapse-btn i[data-v-7c4d25d8],.header .theme-btn i[data-v-7c4d25d8]{font-size:12px}.header .world-time[data-v-7c4d25d8]{display:flex;align-items:center;gap:6px;color:var(--text-accent)}.header .world-time i[data-v-7c4d25d8]{color:var(--accent-color)}.header .location[data-v-7c4d25d8]{display:flex;align-items:center;gap:8px;margin-left:auto}.header .location .danger-badge[data-v-7c4d25d8]{font-size:10px;padding:2px 6px;border-radius:10px;color:#fff}.theme-selector-overlay[data-v-7c4d25d8]{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.6);display:flex;align-items:center;justify-content:center;z-index:1000}.theme-selector[data-v-7c4d25d8]{background:var(--bg-primary);border:2px solid var(--border-active);border-radius:12px;width:90%;max-width:500px;max-height:80vh;overflow:hidden;display:flex;flex-direction:column;box-shadow:0 10px 40px rgba(0,0,0,.5)}.theme-selector .theme-selector-header[data-v-7c4d25d8]{display:flex;justify-content:space-between;align-items:center;padding:16px 20px;background:var(--header-bg);border-bottom:1px solid var(--border-color)}.theme-selector .theme-selector-header h3[data-v-7c4d25d8]{margin:0;font-size:16px;color:var(--text-primary);display:flex;align-items:center;gap:8px}.theme-selector .theme-selector-header h3 i[data-v-7c4d25d8]{color:var(--accent-color)}.theme-selector .theme-selector-header .close-btn[data-v-7c4d25d8]{width:28px;height:28px;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,0);border:1px solid var(--border-color);border-radius:6px;color:var(--text-secondary);cursor:pointer;transition:all .2s}.theme-selector .theme-selector-header .close-btn[data-v-7c4d25d8]:hover{background:var(--button-hover);color:var(--text-primary);border-color:var(--border-active)}.theme-selector .theme-list[data-v-7c4d25d8]{flex:1;overflow-y:auto;padding:12px}.theme-selector .theme-list[data-v-7c4d25d8]::-webkit-scrollbar{width:6px}.theme-selector .theme-list[data-v-7c4d25d8]::-webkit-scrollbar-track{background:var(--bg-secondary);border-radius:3px}.theme-selector .theme-list[data-v-7c4d25d8]::-webkit-scrollbar-thumb{background:var(--button-bg);border-radius:3px}.theme-selector .theme-list[data-v-7c4d25d8]::-webkit-scrollbar-thumb:hover{background:var(--button-hover)}.theme-selector .theme-item[data-v-7c4d25d8]{display:flex;align-items:center;gap:12px;padding:12px;margin-bottom:8px;background:var(--bg-secondary);border:2px solid rgba(0,0,0,0);border-radius:8px;cursor:pointer;transition:all .2s;position:relative}.theme-selector .theme-item[data-v-7c4d25d8]:hover{background:var(--button-bg);border-color:var(--border-color)}.theme-selector .theme-item.active[data-v-7c4d25d8]{border-color:var(--border-active);background:var(--button-active)}.theme-selector .theme-item .theme-preview[data-v-7c4d25d8]{width:60px;height:60px;border-radius:8px;display:flex;align-items:center;justify-content:center;flex-shrink:0}.theme-selector .theme-item .theme-preview .theme-preview-border[data-v-7c4d25d8]{width:40px;height:40px;border:2px solid;border-radius:6px}.theme-selector .theme-item .theme-info[data-v-7c4d25d8]{flex:1}.theme-selector .theme-item .theme-info .theme-name[data-v-7c4d25d8]{font-size:14px;font-weight:bold;color:var(--text-primary);margin-bottom:4px}.theme-selector .theme-item .theme-info .theme-desc[data-v-7c4d25d8]{font-size:12px;color:var(--text-secondary)}.theme-selector .theme-item .theme-check[data-v-7c4d25d8]{color:var(--accent-color);font-size:18px}.theme-selector-fade-enter-active[data-v-7c4d25d8],.theme-selector-fade-leave-active[data-v-7c4d25d8]{transition:opacity .3s}.theme-selector-fade-enter-from[data-v-7c4d25d8],.theme-selector-fade-leave-to[data-v-7c4d25d8]{opacity:0}.tab-nav[data-v-7c4d25d8]{display:flex;padding:8px 12px;gap:4px;background:var(--tab-bg);border-bottom:1px solid var(--border-color);overflow-x:auto}.tab-nav[data-v-7c4d25d8]::-webkit-scrollbar{display:none}.tab-nav .tab-btn[data-v-7c4d25d8]{flex:1;min-width:60px;padding:8px 12px;background:rgba(0,0,0,0);border:1px solid rgba(0,0,0,0);border-radius:6px;color:var(--text-secondary);font-size:12px;cursor:pointer;transition:all .2s;display:flex;align-items:center;justify-content:center;gap:4px;white-space:nowrap}.tab-nav .tab-btn[data-v-7c4d25d8]:hover{background:var(--button-bg);color:var(--text-accent)}.tab-nav .tab-btn.active[data-v-7c4d25d8]{background:var(--tab-active);border-color:var(--border-active);color:var(--text-primary)}.content[data-v-7c4d25d8]{flex:1;min-height:280px;max-height:600px;overflow-y:auto}.content[data-v-7c4d25d8]::-webkit-scrollbar{width:6px}.content[data-v-7c4d25d8]::-webkit-scrollbar-track{background:var(--bg-secondary);border-radius:3px}.content[data-v-7c4d25d8]::-webkit-scrollbar-thumb{background:var(--button-bg);border-radius:3px}.content[data-v-7c4d25d8]::-webkit-scrollbar-thumb:hover{background:var(--button-hover)}.panel[data-v-7c4d25d8]{padding:16px}.cultivation-panel .identity-section[data-v-7c4d25d8]{text-align:center;margin-bottom:16px}.cultivation-panel .identity-section .identity-name[data-v-7c4d25d8]{font-size:20px;font-weight:bold;color:var(--text-primary);text-shadow:0 0 10px var(--accent-glow)}.cultivation-panel .identity-section .identity-info[data-v-7c4d25d8]{color:var(--text-secondary);font-size:12px;margin-top:4px}.cultivation-panel .identity-section .identity-info .divider[data-v-7c4d25d8]{margin:0 6px;opacity:.5}.cultivation-panel .realm-section[data-v-7c4d25d8]{display:flex;justify-content:center;align-items:center;gap:12px;margin-bottom:16px}.cultivation-panel .realm-section .realm-title[data-v-7c4d25d8]{font-size:18px;font-weight:bold;display:flex;align-items:center;gap:6px}.cultivation-panel .realm-section .realm-title i[data-v-7c4d25d8]{animation:spin-7c4d25d8 10s linear infinite}.cultivation-panel .realm-section .realm-status[data-v-7c4d25d8]{font-size:12px;padding:3px 8px;background:var(--button-bg);border:1px solid var(--border-color);border-radius:4px;color:var(--accent-color)}.cultivation-panel .progress-section[data-v-7c4d25d8]{margin-bottom:20px}.cultivation-panel .progress-section .progress-label[data-v-7c4d25d8]{display:flex;justify-content:space-between;font-size:12px;color:var(--text-secondary);margin-bottom:6px}.cultivation-panel .progress-section .progress-bar[data-v-7c4d25d8]{height:8px;background:var(--progress-bg);border-radius:4px;overflow:hidden}.cultivation-panel .progress-section .progress-bar .progress-fill[data-v-7c4d25d8]{height:100%;border-radius:4px;transition:width .5s ease;box-shadow:0 0 10px currentColor}.cultivation-panel .progress-section .progress-percent[data-v-7c4d25d8]{text-align:right;font-size:11px;color:var(--text-secondary);margin-top:4px}.cultivation-panel .stats-grid[data-v-7c4d25d8]{display:grid;grid-template-columns:repeat(3,1fr);gap:12px}.cultivation-panel .stats-grid .stat-item[data-v-7c4d25d8]{text-align:center;padding:10px 8px;background:var(--bg-secondary);border:1px solid var(--border-color);border-radius:8px}.cultivation-panel .stats-grid .stat-item .stat-label[data-v-7c4d25d8]{font-size:11px;color:var(--text-secondary);margin-bottom:4px}.cultivation-panel .stats-grid .stat-item .stat-value[data-v-7c4d25d8]{font-size:13px;font-weight:500;color:var(--text-primary)}.cultivation-panel .stats-grid .stat-item .stat-value.gold[data-v-7c4d25d8]{color:gold}.skills-panel .skills-list[data-v-7c4d25d8]{display:flex;flex-direction:column;gap:12px}.skills-panel .skill-item[data-v-7c4d25d8]{padding:12px;background:var(--bg-secondary);border:1px solid var(--border-color);border-radius:8px}.skills-panel .skill-item .skill-name[data-v-7c4d25d8]{font-size:14px;font-weight:bold;color:var(--accent-color);margin-bottom:6px}.skills-panel .skill-item .skill-desc[data-v-7c4d25d8]{font-size:12px;color:var(--text-secondary);line-height:1.5}.inventory-panel .inventory-section[data-v-7c4d25d8]{margin-bottom:20px}.inventory-panel .inventory-section[data-v-7c4d25d8]:last-child{margin-bottom:0}.inventory-panel .section-title[data-v-7c4d25d8]{font-size:14px;font-weight:bold;color:var(--text-accent);margin-bottom:10px;display:flex;align-items:center;gap:6px}.inventory-panel .section-title i[data-v-7c4d25d8]{color:var(--accent-color)}.inventory-panel .items-grid[data-v-7c4d25d8]{display:flex;flex-direction:column;gap:8px}.inventory-panel .item-card[data-v-7c4d25d8]{padding:10px 12px;background:var(--bg-secondary);border:1px solid var(--border-color);border-radius:6px}.inventory-panel .item-card.treasure[data-v-7c4d25d8]{border-color:var(--border-active);background:var(--button-active)}.inventory-panel .item-card .item-header[data-v-7c4d25d8]{display:flex;justify-content:space-between;align-items:center}.inventory-panel .item-card .item-name[data-v-7c4d25d8]{font-weight:500;color:var(--text-primary)}.inventory-panel .item-card .item-count[data-v-7c4d25d8]{font-size:12px;color:var(--accent-color)}.inventory-panel .item-card .item-rank[data-v-7c4d25d8]{font-size:11px;color:#ffc864;margin:4px 0}.inventory-panel .item-card .item-desc[data-v-7c4d25d8]{font-size:11px;color:var(--text-secondary)}.companions-panel .companions-list[data-v-7c4d25d8]{display:flex;flex-direction:column;gap:12px}.companions-panel .companion-card[data-v-7c4d25d8]{padding:12px;background:var(--bg-secondary);border:1px solid var(--border-color);border-radius:8px}.companions-panel .companion-card .companion-header[data-v-7c4d25d8]{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}.companions-panel .companion-card .companion-header .companion-name[data-v-7c4d25d8]{font-size:15px;font-weight:bold;color:#ffb0c0}.companions-panel .companion-card .companion-header .companion-realm[data-v-7c4d25d8]{font-size:12px}.companions-panel .companion-card .companion-relation[data-v-7c4d25d8]{font-size:12px;color:var(--text-secondary);margin-bottom:8px}.companions-panel .companion-card .companion-relation .relation-value[data-v-7c4d25d8]{color:var(--text-accent);margin-left:4px}.companions-panel .companion-card .companion-favor[data-v-7c4d25d8]{display:flex;align-items:center;gap:8px}.companions-panel .companion-card .companion-favor .favor-label[data-v-7c4d25d8]{font-size:11px;color:var(--text-secondary);min-width:42px}.companions-panel .companion-card .companion-favor .favor-bar[data-v-7c4d25d8]{flex:1;height:6px;background:var(--progress-bg);border-radius:3px;overflow:hidden}.companions-panel .companion-card .companion-favor .favor-bar .favor-fill[data-v-7c4d25d8]{height:100%;border-radius:3px;transition:width .3s ease}.companions-panel .companion-card .companion-favor .favor-value[data-v-7c4d25d8]{font-size:12px;color:var(--text-accent);min-width:30px;text-align:right}.map-panel .current-location[data-v-7c4d25d8]{text-align:center;padding:20px;background:var(--bg-secondary);border:1px solid var(--border-color);border-radius:10px;margin-bottom:16px}.map-panel .current-location .location-name[data-v-7c4d25d8]{font-size:22px;font-weight:bold;color:#a0d0ff;margin-bottom:4px}.map-panel .current-location .location-layer[data-v-7c4d25d8]{font-size:12px;color:var(--accent-color);margin-bottom:10px}.map-panel .current-location .location-desc[data-v-7c4d25d8]{font-size:13px;color:var(--text-secondary);line-height:1.5}.map-panel .connections .connections-title[data-v-7c4d25d8]{font-size:13px;color:var(--text-secondary);margin-bottom:10px}.map-panel .connections .connections-list[data-v-7c4d25d8]{display:flex;flex-wrap:wrap;gap:8px}.map-panel .connections .connections-list .connection-item[data-v-7c4d25d8]{padding:6px 12px;background:var(--bg-secondary);border:1px solid;border-radius:15px;font-size:12px;color:var(--text-accent)}.gallery-panel[data-v-7c4d25d8]{padding:16px !important}.gallery-panel .gallery-container[data-v-7c4d25d8]{display:flex;flex-direction:row;justify-content:center;gap:20px;overflow-x:auto;overflow-y:hidden;padding-bottom:10px}.gallery-panel .gallery-container[data-v-7c4d25d8]::-webkit-scrollbar{height:8px}.gallery-panel .gallery-container[data-v-7c4d25d8]::-webkit-scrollbar-track{background:var(--bg-secondary);border-radius:4px}.gallery-panel .gallery-container[data-v-7c4d25d8]::-webkit-scrollbar-thumb{background:var(--button-bg);border-radius:4px}.gallery-panel .gallery-container[data-v-7c4d25d8]::-webkit-scrollbar-thumb:hover{background:var(--button-hover)}.gallery-panel .gallery-card[data-v-7c4d25d8]{flex-shrink:0;width:280px;aspect-ratio:2/3;perspective:1000px;cursor:pointer}.gallery-panel .card-inner[data-v-7c4d25d8]{position:relative;width:100%;height:100%;transition:transform .6s ease;transform-style:preserve-3d;border-radius:12px;box-shadow:0 8px 30px rgba(0,0,0,.5)}.gallery-panel .gallery-card.flipped .card-inner[data-v-7c4d25d8]{transform:rotateY(180deg)}.gallery-panel .card-face[data-v-7c4d25d8]{position:absolute;width:100%;height:100%;backface-visibility:hidden;border-radius:12px;overflow:hidden;border:2px solid var(--border-color)}.gallery-panel .card-front img[data-v-7c4d25d8]{width:100%;height:100%;object-fit:cover}.gallery-panel .card-front .card-name-bar[data-v-7c4d25d8]{position:absolute;bottom:0;left:0;right:0;padding:12px;background:linear-gradient(to top,rgba(0,0,0,0.85),transparent);color:#fff;font-size:16px;font-weight:bold;text-align:center;text-shadow:0 2px 6px rgba(0,0,0,.9)}.gallery-panel .card-back[data-v-7c4d25d8]{transform:rotateY(180deg);background:linear-gradient(135deg,#1a1a2e 0%,#16213e 100%)}.gallery-panel .card-back .back-content[data-v-7c4d25d8]{width:100%;height:100%;position:relative}.gallery-panel .card-back .back-content .back-image[data-v-7c4d25d8]{width:100%;height:100%;object-fit:cover}.gallery-panel .card-back .back-content .back-info-panel[data-v-7c4d25d8]{position:absolute;bottom:0;left:0;right:0;padding:20px 16px;background:linear-gradient(to top,rgba(0,0,0,0.9) 0%,rgba(0,0,0,0.7) 50%,transparent 100%);text-align:center}.gallery-panel .card-back .back-content .back-info-panel .back-name[data-v-7c4d25d8]{font-size:18px;font-weight:bold;color:#a0c0ff;margin-bottom:8px;text-shadow:0 0 15px rgba(100,150,255,.6),0 2px 4px rgba(0,0,0,.8)}.gallery-panel .card-back .back-content .back-info-panel .back-text[data-v-7c4d25d8]{font-size:14px;color:#d0e0f0;line-height:1.6;font-style:italic;text-shadow:0 1px 3px rgba(0,0,0,.8)}.gallery-panel .gallery-card[data-v-7c4d25d8]::after{content:"点击翻转";position:absolute;top:10px;right:10px;padding:4px 10px;background:rgba(0,0,0,.6);color:#a0b8d0;font-size:11px;border-radius:12px;opacity:0;transition:opacity .3s;pointer-events:none;z-index:10}.gallery-panel .gallery-card[data-v-7c4d25d8]:hover::after{opacity:1}.gallery-panel .gallery-card.flipped[data-v-7c4d25d8]::after{content:"点击翻回"}.empty-hint[data-v-7c4d25d8]{text-align:center;padding:20px;color:#506070;font-style:italic}.footer[data-v-7c4d25d8]{display:flex;justify-content:space-around;padding:10px 16px;background:var(--footer-bg);border-top:1px solid var(--border-color)}.footer .footer-item[data-v-7c4d25d8]{display:flex;align-items:center;gap:6px;font-size:12px;color:var(--text-secondary)}.footer .footer-item i[data-v-7c4d25d8]{color:var(--accent-color)}@keyframes spin-7c4d25d8{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}

/*# sourceMappingURL=main.css.map*/</style></head><body><div id="app"></div></body>