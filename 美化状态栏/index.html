<head><script type="module">import{createPinia as e,defineStore as a}from'https://testingcf.jsdelivr.net/npm/pinia/+esm';var t={502(e,a){a.A=(e,a)=>{const t=e.__vccOpts||e;for(const[e,r]of a)t[e]=r;return t}}},r={};function n(e){var a=r[e];if(void 0!==a)return a.exports;var o=r[e]={exports:{}};return t[e](o,o.exports,n),o.exports}n.n=e=>{var a=e&&e.__esModule?()=>e.default:()=>e;return n.d(a,{a}),a},n.d=(e,a)=>{for(var t in a)n.o(a,t)&&!n.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:a[t]})},n.o=(e,a)=>Object.prototype.hasOwnProperty.call(e,a);const o=Vue,c=z,l=['练气','筑基','金丹','元婴','化神','炼虚','合体','大乘','渡劫'],s=['初期','中期','后期','大圆满'],i=[100,100,100,100,200,200,200,200,400,400,400,400,800,800,800,800,1600,1600,1600,1600,3200,3200,3200,3200,6400,6400,6400,6400,12800,12800,12800,12800,25600,25600,25600,25600],d=[100,100,100,100,200,200,200,200,500,500,500,500,1e3,1e3,1e3,1e3,2e3,2e3,2e3,2e3,5e3,5e3,5e3,5e3,1e4,1e4,1e4,1e4,5e4,5e4,5e4,5e4,1e5,1e5,1e5,1e5],b=c.z.object({名称:c.z.string().prefault(''),描述:c.z.string().prefault(''),品阶:c.z.string().prefault(''),数量:c.z.coerce.number().transform(e=>Math.max(1,e)).prefault(1)}),p=c.z.object({地:c.z.string().describe('所在地'),特:c.z.string().describe('核心特点'),力:c.z.string().describe('最高战力'),营:c.z.enum(['正','魔','中']),模:c.z.enum(['超大','大','小','微','特'])}),g=c.z.object({阶:c.z.enum(['凡','黄','玄','地','天','仙','圣']),性:c.z.string().describe('属性'),效:c.z.string().describe('效果')}),f=c.z.object({阶:c.z.enum(['凡器','法器','灵器','法宝','灵宝','仙器','圣器','道器']),类:c.z.string().describe('类型')}).transform(e=>({...e,特:'仙器'===e.阶?'顶级':'灵宝'===e.阶?'强':'法宝'===e.阶?'中':'普通'})),u=c.z.object({域:c.z.enum(['天层','神州','东苍','南炎','西庚','北冥','下层','四海']),类:c.z.enum(['秘境','城镇','宗门','禁地','遗迹','地形']),危:c.z.coerce.number().transform(e=>_.clamp(e,0,100)),特:c.z.string().describe('特点'),资:c.z.array(c.z.string()).prefault([])}),m=c.z.object({质:c.z.enum(['劣','下','中','上','极','天','异']),性:c.z.string().describe('属性'),稀:c.z.enum(['常','少','罕','稀','传'])}).transform(e=>({...e,速:{劣:'0.3倍',下:'0.5倍',中:'1倍',上:'2倍',极:'3倍',天:'5倍',异:'4倍'}[e.质]||'1倍',特:'天'===e.质?'单系顶级':'异'===e.质?'变异稀有':'极'===e.质?'双系优秀':'常规'})),v=c.z.object({质:c.z.enum(['凡','灵','道','圣','神']),特:c.z.string().describe('特性'),稀:c.z.enum(['常','少','罕','稀','传'])}).transform(e=>({...e,优:'神'===e.质?'至高':'圣'===e.质?'极强':'道'===e.质?'强':'灵'===e.质?'中':'无'})),h=c.z.object({世界时钟:c.z.object({纪元:c.z.string().prefault('末法时代'),年份:c.z.coerce.number().prefault(1),月份:c.z.coerce.number().transform(e=>_.clamp(e,1,12)).prefault(1),日期:c.z.coerce.number().transform(e=>_.clamp(e,1,30)).prefault(1),时辰:c.z.string().prefault('子时')}).prefault({纪元:'末法时代',年份:1,月份:1,日期:1,时辰:'子时'}),世界地图:c.z.record(c.z.string().describe('区域名'),c.z.object({layer:c.z.enum(['天层','地层','下层']).prefault('地层'),danger:c.z.coerce.number().transform(e=>_.clamp(e,0,100)),desc:c.z.string().prefault(''),connections:c.z.array(c.z.string()).prefault([])})).prefault({}),世界图志:c.z.record(c.z.string().describe('事件名'),c.z.object({状态:c.z.string().prefault(''),事件:c.z.string().prefault('')})).prefault({}),宗门势力库:c.z.record(c.z.string().describe('宗门名'),p).prefault({剑阁:{地:'神州剑门关',特:'剑道源头',力:'渡劫后期',营:'正',模:'超大'},万法宗:{地:'神州问道峰',特:'万法本源',力:'渡劫初期',营:'正',模:'超大'},金刚寺:{地:'西天佛山',特:'佛修炼体',力:'大乘中期',营:'正',模:'大'},药王谷:{地:'神农架',特:'医炼丹药',力:'大乘初期',营:'正',模:'大'},儒门:{地:'文圣山',特:'浩然正气',力:'大乘中期',营:'正',模:'大'},青龙殿:{地:'东苍青龙山',特:'守护青帝',力:'大乘初期',营:'正',模:'大'},玄武宗:{地:'北冥玄冰山',特:'镇守归墟',力:'大乘后期',营:'正',模:'大'},建木宗:{地:'东苍建木树',特:'木系道法',力:'合体中期',营:'正',模:'小'},百花谷:{地:'百花秘境',特:'女修花道',力:'合体后期',营:'正',模:'小'},血神教:{地:'血魔渊',特:'血道炼法',力:'渡劫中期',营:'魔',模:'超大'},天魔宗:{地:'天魔山',特:'天魔大道',力:'大乘中期',营:'魔',模:'大'},妖盟:{地:'万妖森林',特:'妖族联盟',力:'渡劫中期',营:'中',模:'超大'},大夏王朝:{地:'中州皇城',特:'世俗统治',力:'大乘初期',营:'中',模:'大'},九州商会:{地:'九大主城',特:'商业联盟',力:'大乘初期',营:'中',模:'大'},离火宫:{地:'南炎火山',特:'朱雀供奉',力:'合体圆满',营:'中',模:'小'},铸剑山庄:{地:'南炎地火',特:'炼器第一',力:'合体后期',营:'中',模:'小'}}),功法库:c.z.record(c.z.string().describe('功法名'),g).prefault({引气诀:{阶:'凡',性:'通用',效:'入门'},筑基真解:{阶:'玄',性:'通用',效:'筑基'},金丹大道:{阶:'地',性:'通用',效:'结丹'},万剑归宗诀:{阶:'天',性:'金剑',效:'剑阁镇宗'},建木通天诀:{阶:'天',性:'木',效:'建木镇宗'},北冥真经:{阶:'天',性:'水',效:'玄武吞噬'},朱雀涅槃经:{阶:'天',性:'火',效:'离火涅槃'},不动明王身:{阶:'天',性:'土佛',效:'金刚防御'},万木朝宗:{阶:'仙',性:'木',效:'青帝遗法'},海纳百川:{阶:'仙',性:'水',效:'归墟本源'},祝融神火:{阶:'仙',性:'火',效:'火神遗法'},轮回经:{阶:'仙',性:'轮回',效:'{{user}}专属'},斩轮回剑典:{阶:'仙',性:'剑轮回',效:'{{user}}前世'},剑意通神:{阶:'仙',性:'剑道',效:'剑意化形'},九天雷神诀:{阶:'天',性:'雷',效:'雷霆'},虚空经:{阶:'天',性:'空间',效:'空间'},万法归宗:{阶:'天',性:'通用',效:'模拟'},医仙宝典:{阶:'天',性:'医道',效:'医道'},天魔策:{阶:'天',性:'魔道',效:'速成'}}),法宝库:c.z.record(c.z.string().describe('法宝名'),f).prefault({镇渊剑:{阶:'仙器',类:'剑'},双鱼佩:{阶:'仙器',类:'护身'},青锋剑:{阶:'法器',类:'剑'},储物戒:{阶:'灵器',类:'储物'},青龙剑:{阶:'灵宝',类:'剑'},白虎剑:{阶:'灵宝',类:'剑'},朱雀剑:{阶:'灵宝',类:'剑'},玄武剑:{阶:'灵宝',类:'剑'}}),地点库:c.z.record(c.z.string().describe('地点名'),u).prefault({天渊:{域:'天层',类:'禁地',危:95,特:'星辰裂隙',资:['星辰碎片','陨铁']},罡风带:{域:'天层',类:'禁地',危:90,特:'罡风屏障',资:['罡风精华']},问道峰:{域:'神州',类:'宗门',危:10,特:'万法宗',资:['功法','灵药']},剑门关:{域:'神州',类:'宗门',危:15,特:'剑阁',资:['剑意','飞剑']},藏书阁:{域:'神州',类:'宗门',危:5,特:'古籍',资:['功法','秘术']},酆都城:{域:'神州',类:'城镇',危:30,特:'鬼市',资:['幽冥材料']},龙门瀑:{域:'神州',类:'秘境',危:40,特:'化龙',资:['龙气']},建木林:{域:'东苍',类:'地形',危:50,特:'古树精',资:['灵木','妖丹']},青帝陵:{域:'东苍',类:'遗迹',危:85,特:'青帝传承',资:['青帝传承']},百花境:{域:'东苍',类:'秘境',危:20,特:'花海',资:['灵花']},不灭火山:{域:'南炎',类:'地形',危:80,特:'朱雀涅槃',资:['朱雀火']},涅槃台:{域:'南炎',类:'遗迹',危:70,特:'涅槃',资:['涅槃感悟']},万剑冢:{域:'西庚',类:'禁地',危:85,特:'剑意',资:['剑意','古剑']},玄冰山:{域:'北冥',类:'宗门',危:50,特:'玄武宗',资:['玄冰']},归墟眼:{域:'北冥',类:'禁地',危:99,特:'归墟',资:['归墟感悟']},黄泉迹:{域:'下层',类:'遗迹',危:90,特:'幽冥',资:['黄泉水']},炎渊:{域:'下层',类:'禁地',危:95,特:'地心火',资:['地心火']}}),灵根库:c.z.record(c.z.string().describe('灵根名'),m).prefault({金天根:{质:'天',性:'金',稀:'传'},木天根:{质:'天',性:'木',稀:'传'},水天根:{质:'天',性:'水',稀:'传'},火天根:{质:'天',性:'火',稀:'传'},土天根:{质:'天',性:'土',稀:'传'},三灵根:{质:'上',性:'三系',稀:'罕'},四灵根:{质:'中',性:'四系',稀:'少'},五行杂根:{质:'下',性:'五行',稀:'常'},冰根:{质:'异',性:'冰',稀:'传'},雷根:{质:'异',性:'雷',稀:'传'},离火根:{质:'异',性:'离火',稀:'传'},空间根:{质:'异',性:'空间',稀:'传'},时间根:{质:'异',性:'时间',稀:'传'},混沌根:{质:'异',性:'混沌',稀:'传'},轮回根:{质:'异',性:'轮回',稀:'传'}}),体质库:c.z.record(c.z.string().describe('体质名'),v).prefault({凡体:{质:'凡',特:'普通',稀:'常'},玄冰体:{质:'灵',特:'冰系增强',稀:'罕'},离火体:{质:'灵',特:'火系增强',稀:'罕'},木灵体:{质:'灵',特:'恢复增强',稀:'罕'},天籁体:{质:'灵',特:'音律神通',稀:'罕'},花妖体:{质:'灵',特:'魅惑控制',稀:'稀'},朱雀脉:{质:'道',特:'火系涅槃',稀:'传'},真龙脉:{质:'道',特:'龙族神通',稀:'传'},战体:{质:'道',特:'战力倍增',稀:'传'},梦魇体:{质:'道',特:'幻术掌控',稀:'传'},雪魂体:{质:'道',特:'冰系极致',稀:'传'},混沌体:{质:'圣',特:'万法无阻',稀:'传'},道体:{质:'圣',特:'悟性极高',稀:'传'},金身:{质:'圣',特:'防御无敌',稀:'传'},轮回体:{质:'神',特:'{{user}}专属轮回',稀:'传'},时空体:{质:'神',特:'时空掌控',稀:'传'}}),本尊:c.z.object({等级:c.z.coerce.number().transform(e=>_.clamp(e,1,36)).prefault(1),修为:c.z.coerce.number().transform(e=>Math.max(0,e)).prefault(0),灵根:c.z.string().prefault('五行杂灵根'),体质:c.z.string().prefault('凡体'),功法:c.z.string().prefault('无'),本命兵器:c.z.string().prefault('无'),神通列表:c.z.record(c.z.string().describe('神通名'),c.z.object({名称:c.z.string().prefault(''),描述:c.z.string().prefault(''),品阶:c.z.string().prefault(''),熟练度:c.z.string().prefault('入门')})).prefault({}),灵石:c.z.coerce.number().transform(e=>Math.max(0,e)).prefault(0),已活岁月:c.z.coerce.number().transform(e=>Math.max(0,e)).prefault(0),尝试突破:c.z.boolean().prefault(!1),行踪:c.z.object({当前区域:c.z.string().prefault('未知之地'),所属层级:c.z.string().prefault('地层'),环境描述:c.z.string().prefault(''),危险度:c.z.coerce.number().prefault(10),可用通道:c.z.array(c.z.string()).prefault([]),导航信息:c.z.string().prefault('')}).prefault({当前区域:'未知之地',所属层级:'地层',环境描述:'',危险度:10,可用通道:[],导航信息:''}),身份:c.z.object({姓名:c.z.string().prefault('无名氏'),宗门:c.z.string().prefault('散修'),出身:c.z.string().prefault('凡人')}).prefault({姓名:'无名氏',宗门:'散修',出身:'凡人'}),背包:c.z.record(c.z.string().describe('物品名'),b).prefault({}).transform(e=>_.pickBy(e,({数量:e})=>e>0)),法宝:c.z.record(c.z.string().describe('法宝名'),b).prefault({}).transform(e=>_.pickBy(e,({数量:e})=>e>0)),杂物袋:c.z.record(c.z.string().describe('杂物名'),b).prefault({}).transform(e=>_.pickBy(e,({数量:e})=>e>0))}).prefault({等级:1,修为:0,灵根:'五行杂灵根',体质:'凡体',功法:'无',本命兵器:'无',神通列表:{},灵石:0,已活岁月:0,尝试突破:!1,行踪:{当前区域:'未知之地',所属层级:'地层',环境描述:'',危险度:10,可用通道:[],导航信息:''},身份:{姓名:'无名氏',宗门:'散修',出身:'凡人'},背包:{},法宝:{},杂物袋:{}}).transform(e=>{const a=e.等级,t=i[a-1]??100,r=d[a-1]??100,n=Math.floor((a-1)/4),o=`${l[n]??'练气'}${s[(a-1)%4]??'初期'}`,c=`${e.已活岁月}/${r}`,b=e.尝试突破?'突破中':e.修为>=t?'瓶颈期':'修炼中',p=`${(e.修为/t*100).toFixed(1)}%`;return{...e,突破阈值:t,寿元上限:r,境界描述:o,寿元状态:c,状态:b,进度:p}}),红颜角色库:c.z.record(c.z.string().describe('角色名'),c.z.object({级:c.z.coerce.number().transform(e=>_.clamp(e,1,36)),根:c.z.string().describe('灵根'),质:c.z.string().describe('体质'),龄:c.z.string().describe('年龄'),属:c.z.string().describe('所属'),法:c.z.string().describe('功法'),器:c.z.string().describe('本命兵器'),通:c.z.array(c.z.string()).prefault([]),型:c.z.enum(['核心','重要','次要'])})).prefault({许听雨:{级:28,根:'水本源天',质:'归墟神体',龄:'外26实12000',属:'归墟之主',法:'万水归源先天',器:'沧海遗珠先天',通:['归墟歌','逆流虚妄','寂灭海域','万水同源'],型:'核心'},虞汐颜:{级:12,根:'水阴阳异',质:'双鱼体',龄:'化形0年',属:'{{user}}玉佩',法:'双生天极/阴阳',器:'双鱼佩本体',通:['枯木春','夺命妆','双鱼梦'],型:'核心'},白清弦:{级:29,根:'金天根',质:'剑体',龄:'外30实1000+',属:'散修剑宗师',法:'剑意仙/天音天',器:'清弦琴剑灵宝',通:['琴剑杀','剑意歌','万剑心'],型:'核心'},焰绯月:{级:12,根:'离火根极',质:'朱雀脉',龄:'25',属:'离火宫圣女',法:'朱雀天',器:'绯月弓法宝',通:['离火天','朱雀身','凤凰槃'],型:'重要'},幻千丝:{级:13,根:'暗幻双根',质:'梦魇体',龄:'外20未知',属:'散修幽冥',法:'织梦天',器:'千丝网灵宝',通:['织梦笼','心魔境','千丝缚'],型:'重要'},花想容:{级:8,根:'木根',质:'花妖体',龄:'外12',属:'建木宗',法:'百花地',器:'牡丹瓣',通:['花海域','治愈粉','魅惑香'],型:'次要'},敖清霜:{级:14,根:'水龙双根',质:'真龙脉',龄:'外20实150',属:'龙宫三公主',法:'沧海天',器:'龙鳞甲灵宝',通:['龙变化','呼风雨','龙威慑'],型:'次要'}}),红颜:c.z.record(c.z.string().describe('红颜名'),c.z.object({等级:c.z.coerce.number().transform(e=>_.clamp(e,1,36)).prefault(1),修为:c.z.coerce.number().transform(e=>Math.max(0,e)).prefault(0),灵根:c.z.string().prefault('五行杂灵根'),体质:c.z.string().prefault('凡体'),功法:c.z.string().prefault('无'),本命兵器:c.z.string().prefault('无'),神通列表:c.z.record(c.z.string().describe('神通名'),c.z.object({名称:c.z.string().prefault(''),描述:c.z.string().prefault(''),品阶:c.z.string().prefault(''),熟练度:c.z.string().prefault('入门')})).prefault({}),灵石:c.z.coerce.number().transform(e=>Math.max(0,e)).prefault(0),已活岁月:c.z.coerce.number().transform(e=>Math.max(0,e)).prefault(0),尝试突破:c.z.boolean().prefault(!1),好感度:c.z.coerce.number().transform(e=>_.clamp(e,-100,100)).prefault(0),关系:c.z.string().prefault('陌生人'),重要性:c.z.string().prefault('路人')}).prefault({等级:1,修为:0,灵根:'五行杂灵根',体质:'凡体',功法:'无',本命兵器:'无',神通列表:{},灵石:0,已活岁月:0,尝试突破:!1,好感度:0,关系:'陌生人',重要性:'路人'}).transform(e=>{const a=e.等级,t=i[a-1]??100,r=d[a-1]??100,n=Math.floor((a-1)/4),o=`${l[n]??'练气'}${s[(a-1)%4]??'初期'}`,c=`${e.已活岁月}/${r}`,b=e.尝试突破?'突破中':e.修为>=t?'瓶颈期':'修炼中',p=`${(e.修为/t*100).toFixed(1)}%`;return{...e,突破阈值:t,寿元上限:r,境界描述:o,寿元状态:c,状态:b,进度:p}})).prefault({}),NPC图鉴:c.z.record(c.z.string().describe('NPC名'),c.z.object({等级:c.z.coerce.number().transform(e=>_.clamp(e,1,36)).prefault(1),所在宗门:c.z.string().prefault('散修'),备注:c.z.string().prefault('')})).prefault({}),任务列表:c.z.record(c.z.string().describe('任务名'),c.z.object({类型:c.z.enum(['主线','支线','每日','临危受命']),目标:c.z.string(),状态:c.z.enum(['进行中','已完成','已失败']).prefault('进行中')})).prefault({}),声望系统:c.z.record(c.z.string().describe('势力名'),c.z.object({值:c.z.coerce.number().transform(e=>_.clamp(e,-100,100)),关系:c.z.string()})).prefault({})}),y={火:{effect:'灼烧',visual:'烈焰',nature:'爆裂',color:'#ff4444'},水:{effect:'缠绕',visual:'激流',nature:'柔韧',color:'#4488ff'},冰:{effect:'冻结',visual:'寒霜',nature:'极寒',color:'#88ddff'},雷:{effect:'麻痹',visual:'紫电',nature:'狂暴',color:'#aa44ff'},风:{effect:'切割',visual:'罡风',nature:'无形',color:'#88ff88'},土:{effect:'镇压',visual:'岩铠',nature:'厚重',color:'#aa8844'},木:{effect:'寄生',visual:'藤蔓',nature:'生生不息',color:'#44aa44'},金:{effect:'穿透',visual:'锐金',nature:'锋利',color:'#ffdd44'},暗:{effect:'腐蚀',visual:'黑雾',nature:'诡谲',color:'#442244'},光:{effect:'净化',visual:'圣辉',nature:'神圣',color:'#ffffaa'},混沌:{effect:'湮灭',visual:'灰光',nature:'虚无',color:'#888888'}};function N(e){return['#888888','#44aa44','#4488ff','#aa44ff','#ff4444','#ffaa00','#ffdd44','#ffffff','#ff88ff'][Math.floor((e-1)/4)]||'#888888'}function E(e){return e>=90?'#ff0000':e>=70?'#ff4400':e>=50?'#ff8800':e>=30?'#ffcc00':'#44aa44'}const V=_;var k=n.n(V);const B={孟十七:{normal:{front:'https://files.catbox.moe/c1su29.jpg',back:'https://files.catbox.moe/c1su29.jpg'},shy:'https://files.catbox.moe/8doe0f.jpg',smile:'https://files.catbox.moe/8doe0f.jpg',angry:'https://files.catbox.moe/c1su29.jpg',cry:'https://files.catbox.moe/c1su29.jpg',surprise:'https://files.catbox.moe/8doe0f.jpg'},白清弦:{normal:{front:'random_front',back:'random_back'}},虞汐颜:{normal:{front:'random_dual_front',back:'random_dual_back'}},许听雨:{normal:{front:'random_front',back:'random_back'}}},S={白清弦:{front:['https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/白清弦1.png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/白清弦2.png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/白清弦3.png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/白清弦4.png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/白清弦5.png'],back:['https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/白清弦6.png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/白清弦7.png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/白清弦8.png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/白清弦9.png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/白清弦10.png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/白清弦11.png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/白清弦12.png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/白清弦13.png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/白清弦14.png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/白清弦15.png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/白清弦16.png']},许听雨:{front:['https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/许听雨 (1).png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/许听雨 (2).png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/许听雨 (3).png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/许听雨 (4).png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/许听雨 (5).png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/许听雨 (12).png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/许听雨 (13).png'],back:['https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/许听雨 (6).png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/许听雨 (7).png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/许听雨 (9).png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/许听雨 (10).png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/许听雨 (11).png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/许听雨 (14).png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/许听雨 (15).png']},虞汐颜:{虞汐_front:['https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/虞汐 (1).png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/虞汐 (15).png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/虞汐 (16).png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/虞汐 (6).png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/虞汐 (5).png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/虞汐 (3).png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/虞汐 (2).png'],虞汐_back:['https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/虞汐 (17).png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/虞汐 (8).png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/虞汐 (7).png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/虞汐 (4).png'],虞颜_front:['https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/虞颜 (15).png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/虞颜 (14).png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/虞颜 (13).png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/虞颜 (12).png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/虞颜 (11).png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/虞颜 (10).png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/虞颜 (9).png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/虞颜 (8).png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/虞颜 (7).png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/虞颜 (6).png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/虞颜 (1).png'],虞颜_back:['https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/虞颜 (5).png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/虞颜 (4).png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/虞颜 (3).png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/虞颜 (2).png','https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/虞颜 (18).png']}},x='normal',C='https://files.catbox.moe/placeholder.jpg';let D=null,M=!1;function w(e,a){const t=S[e];if(!t)return console.warn(`[图鉴] 未找到角色 "${e}" 的图片池`),C;const r=t[a];if(!r||0===r.length)return console.warn(`[图鉴] 角色 "${e}" 的 ${a} 图片池为空`),C;return r[Math.floor(Math.random()*r.length)]}function j(e){const a=S['虞汐颜'];if(!a)return console.warn('[图鉴] 未找到虞汐颜的图片池'),{url:C,soulName:'虞汐颜'};if('front'===e){if(M)return console.info('[图鉴] 虞汐颜卡片已生成，跳过重复生成'),null;M=!0;const e=Math.random()<.5?'虞汐':'虞颜';D=e;const t=a[`${e}_front`];if(!t||0===t.length)return console.warn(`[图鉴] 虞汐颜的 ${e} 正面图片池为空`),{url:C,soulName:e};const r=Math.floor(Math.random()*t.length);return console.info(`[图鉴] 虞汐颜正面选择: ${e}`),{url:t[r],soulName:e}}{if(!D)return console.error('[图鉴] 错误：虞汐颜背面图片获取时，正面魂体未缓存'),{url:C,soulName:'虞汐颜'};const e='虞汐'===D?'虞颜':'虞汐',t=a[`${e}_back`];if(!t||0===t.length)return console.warn(`[图鉴] 虞汐颜的 ${e} 背面图片池为空`),{url:C,soulName:e};const r=Math.floor(Math.random()*t.length);return console.info(`[图鉴] 虞汐颜背面选择: ${e}`),{url:t[r],soulName:e}}}function A(e,a){if('string'==typeof e)return{front:e,back:e};if('虞汐颜'===a&&'random_dual_front'===e.front){const e=j('front');if(null===e)return null;const a=j('back');return null===a?null:{front:e.url,back:a.url,frontName:e.soulName,backName:a.soulName}}let t=e.front,r=e.back??e.front;return'random_front'===t&&(t=w(a,'front')),'random_back'===r&&(r=w(a,'back')),{front:t,back:r}}function P(e,a,t){const r=B[e];if(!r)return console.warn(`[图鉴] 未找到角色 "${e}" 的图片配置，使用占位图`),{front:C,back:C};const n=r[a]??r[x];if(!n)return console.warn(`[图鉴] 角色 "${e}" 没有表情 "${a}" 的图片，使用占位图`),{front:C,back:C};const o=A(n,e);if(null===o)return null;let c=o.back;if(t&&t!==a){const a=r[t]??r[x];if(a){const t=A(a,e);t&&t.back&&(c=t.back)}else console.warn(`[图鉴] 角色 "${e}" 没有背面表情 "${t}"，使用正面背面`)}return c||(console.warn(`[图鉴] 角色 "${e}" 背面图片缺失，使用正面图片`),c=o.front),{front:o.front,back:c,frontName:o.frontName,backName:o.backName}}const T={cloudImage:'url(https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/古风祥云云朵85.png)',cloudsMulti:'\n    url(https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/古风祥云云朵85.png),\n    url(https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/古风祥云云朵85.png),\n    url(https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/古风祥云云朵85.png),\n    url(https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/古风祥云云朵85.png),\n    url(https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/古风祥云云朵85.png)\n  ',cloudsWithStars:'\n    url(https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/古风祥云云朵85.png),\n    url(https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/古风祥云云朵85.png),\n    url(https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/古风祥云云朵85.png),\n    url(https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/古风祥云云朵85.png),\n    url(https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/古风祥云云朵85.png),\n    radial-gradient(circle at 25% 20%, rgba(255, 255, 255, 0.15) 1px, transparent 1px),\n    radial-gradient(circle at 75% 35%, rgba(255, 255, 255, 0.12) 1.5px, transparent 1.5px),\n    radial-gradient(circle at 35% 75%, rgba(255, 255, 255, 0.1) 1px, transparent 1px)\n  ',stars:'\n    radial-gradient(circle at 20% 30%, rgba(255, 255, 255, 0.3) 1px, transparent 1px),\n    radial-gradient(circle at 80% 60%, rgba(255, 255, 255, 0.25) 1.5px, transparent 1.5px),\n    radial-gradient(circle at 40% 80%, rgba(255, 255, 255, 0.2) 1px, transparent 1px),\n    radial-gradient(circle at 60% 20%, rgba(255, 255, 255, 0.15) 2px, transparent 2px)\n  ',texture:'\n    repeating-linear-gradient(\n      45deg,\n      transparent,\n      transparent 10px,\n      rgba(255, 255, 255, 0.03) 10px,\n      rgba(255, 255, 255, 0.03) 20px\n    )\n  ',landscape:'\n    linear-gradient(180deg,\n      transparent 0%,\n      rgba(255, 255, 255, 0.02) 30%,\n      rgba(255, 255, 255, 0.05) 50%,\n      rgba(255, 255, 255, 0.02) 70%,\n      transparent 100%\n    )\n  ',lotus:'\n    radial-gradient(ellipse 120px 80px at 50% 50%, rgba(255, 255, 255, 0.08) 0%, transparent 50%)\n  '},F=[{id:'default',name:'玄青仙境',description:'深邃玄青，如夜空星辰',colors:{bgPrimary:'linear-gradient(180deg, rgba(49, 66, 117, 0.95) 0%, rgba(15, 20, 35, 0.98) 100%)',bgSecondary:'rgba(30, 40, 60, 0.5)',border:'rgba(100, 150, 200, 0.3)',borderActive:'rgba(100, 150, 200, 0.6)',textPrimary:'#e0e8f0',textSecondary:'#8090a0',textAccent:'#a0b8d0',accent:'#88aacc',accentGlow:'rgba(100, 150, 255, 0.3)',buttonBg:'rgba(100, 150, 200, 0.2)',buttonHover:'rgba(100, 150, 200, 0.3)',buttonActive:'linear-gradient(135deg, rgba(80, 120, 180, 0.3) 0%, rgba(100, 80, 160, 0.3) 100%)',progressBg:'rgba(50, 60, 80, 0.8)',headerBg:'linear-gradient(90deg, rgba(60, 80, 120, 0.4) 0%, rgba(80, 60, 100, 0.4) 100%)',tabBg:'rgba(30, 40, 60, 0.5)',tabActive:'linear-gradient(135deg, rgba(80, 120, 180, 0.3) 0%, rgba(100, 80, 160, 0.3) 100%)',footerBg:'rgba(20, 30, 45, 0.8)'},patterns:{overlay:T.cloudsWithStars}},{id:'purple',name:'紫霞仙踪',description:'紫气东来，霞光万道',colors:{bgPrimary:'linear-gradient(180deg, rgba(80, 40, 100, 0.95) 0%, rgba(30, 15, 40, 0.98) 100%)',bgSecondary:'rgba(50, 30, 70, 0.5)',border:'rgba(150, 100, 200, 0.3)',borderActive:'rgba(180, 120, 220, 0.6)',textPrimary:'#f0e0f8',textSecondary:'#a080b0',textAccent:'#c0a0d0',accent:'#aa88cc',accentGlow:'rgba(150, 100, 255, 0.4)',buttonBg:'rgba(150, 100, 200, 0.2)',buttonHover:'rgba(150, 100, 200, 0.3)',buttonActive:'linear-gradient(135deg, rgba(120, 80, 160, 0.3) 0%, rgba(140, 60, 180, 0.3) 100%)',progressBg:'rgba(60, 40, 80, 0.8)',headerBg:'linear-gradient(90deg, rgba(80, 50, 100, 0.4) 0%, rgba(100, 40, 120, 0.4) 100%)',tabBg:'rgba(50, 30, 70, 0.5)',tabActive:'linear-gradient(135deg, rgba(120, 80, 160, 0.3) 0%, rgba(140, 60, 180, 0.3) 100%)',footerBg:'rgba(30, 20, 50, 0.8)'},patterns:{overlay:T.cloudsMulti}},{id:'red',name:'赤炎烈焰',description:'烈火焚天，赤炎千里',colors:{bgPrimary:'linear-gradient(180deg, rgba(100, 40, 40, 0.95) 0%, rgba(40, 15, 15, 0.98) 100%)',bgSecondary:'rgba(70, 30, 30, 0.5)',border:'rgba(200, 100, 100, 0.3)',borderActive:'rgba(220, 120, 120, 0.6)',textPrimary:'#f8e0e0',textSecondary:'#b08080',textAccent:'#d0a0a0',accent:'#cc8888',accentGlow:'rgba(255, 100, 100, 0.4)',buttonBg:'rgba(200, 100, 100, 0.2)',buttonHover:'rgba(200, 100, 100, 0.3)',buttonActive:'linear-gradient(135deg, rgba(160, 80, 80, 0.3) 0%, rgba(180, 60, 60, 0.3) 100%)',progressBg:'rgba(80, 40, 40, 0.8)',headerBg:'linear-gradient(90deg, rgba(100, 50, 50, 0.4) 0%, rgba(120, 40, 40, 0.4) 100%)',tabBg:'rgba(70, 30, 30, 0.5)',tabActive:'linear-gradient(135deg, rgba(160, 80, 80, 0.3) 0%, rgba(180, 60, 60, 0.3) 100%)',footerBg:'rgba(50, 20, 20, 0.8)'},patterns:{overlay:T.cloudsMulti}},{id:'cyan',name:'碧海青天',description:'碧波荡漾，海天一色',colors:{bgPrimary:'linear-gradient(180deg, rgba(40, 80, 100, 0.95) 0%, rgba(15, 30, 40, 0.98) 100%)',bgSecondary:'rgba(30, 60, 70, 0.5)',border:'rgba(100, 180, 200, 0.3)',borderActive:'rgba(120, 200, 220, 0.6)',textPrimary:'#e0f0f8',textSecondary:'#80a0b0',textAccent:'#a0c0d0',accent:'#88ccdd',accentGlow:'rgba(100, 200, 255, 0.4)',buttonBg:'rgba(100, 180, 200, 0.2)',buttonHover:'rgba(100, 180, 200, 0.3)',buttonActive:'linear-gradient(135deg, rgba(80, 140, 160, 0.3) 0%, rgba(60, 160, 180, 0.3) 100%)',progressBg:'rgba(40, 60, 80, 0.8)',headerBg:'linear-gradient(90deg, rgba(50, 80, 100, 0.4) 0%, rgba(40, 100, 120, 0.4) 100%)',tabBg:'rgba(30, 60, 70, 0.5)',tabActive:'linear-gradient(135deg, rgba(80, 140, 160, 0.3) 0%, rgba(60, 160, 180, 0.3) 100%)',footerBg:'rgba(20, 40, 50, 0.8)'},patterns:{overlay:T.cloudsWithStars}},{id:'gold',name:'金辉灿烂',description:'金光璀璨，辉映九天',colors:{bgPrimary:'linear-gradient(180deg, rgba(80, 70, 40, 0.95) 0%, rgba(30, 25, 15, 0.98) 100%)',bgSecondary:'rgba(60, 50, 30, 0.5)',border:'rgba(200, 180, 100, 0.3)',borderActive:'rgba(220, 200, 120, 0.6)',textPrimary:'#f8f0e0',textSecondary:'#b0a080',textAccent:'#d0c0a0',accent:'#ccaa88',accentGlow:'rgba(255, 200, 100, 0.4)',buttonBg:'rgba(200, 180, 100, 0.2)',buttonHover:'rgba(200, 180, 100, 0.3)',buttonActive:'linear-gradient(135deg, rgba(160, 140, 80, 0.3) 0%, rgba(180, 160, 60, 0.3) 100%)',progressBg:'rgba(60, 50, 40, 0.8)',headerBg:'linear-gradient(90deg, rgba(80, 70, 50, 0.4) 0%, rgba(100, 80, 40, 0.4) 100%)',tabBg:'rgba(60, 50, 30, 0.5)',tabActive:'linear-gradient(135deg, rgba(160, 140, 80, 0.3) 0%, rgba(180, 160, 60, 0.3) 100%)',footerBg:'rgba(40, 35, 20, 0.8)'},patterns:{overlay:T.cloudsMulti}},{id:'green',name:'翠竹清风',description:'竹影婆娑，清风徐来',colors:{bgPrimary:'linear-gradient(180deg, rgba(40, 80, 60, 0.95) 0%, rgba(15, 30, 25, 0.98) 100%)',bgSecondary:'rgba(30, 60, 50, 0.5)',border:'rgba(100, 180, 150, 0.3)',borderActive:'rgba(120, 200, 170, 0.6)',textPrimary:'#e0f8f0',textSecondary:'#80b0a0',textAccent:'#a0d0c0',accent:'#88ccaa',accentGlow:'rgba(100, 255, 200, 0.4)',buttonBg:'rgba(100, 180, 150, 0.2)',buttonHover:'rgba(100, 180, 150, 0.3)',buttonActive:'linear-gradient(135deg, rgba(80, 140, 120, 0.3) 0%, rgba(60, 160, 140, 0.3) 100%)',progressBg:'rgba(40, 60, 50, 0.8)',headerBg:'linear-gradient(90deg, rgba(50, 80, 70, 0.4) 0%, rgba(40, 100, 80, 0.4) 100%)',tabBg:'rgba(30, 60, 50, 0.5)',tabActive:'linear-gradient(135deg, rgba(80, 140, 120, 0.3) 0%, rgba(60, 160, 140, 0.3) 100%)',footerBg:'rgba(20, 40, 35, 0.8)'},patterns:{overlay:T.cloudsMulti}}];function O(e){return F.find(a=>a.id===e)}function I(e){M=!1,D=null,console.info('[图鉴] 虞汐颜会话缓存已重置');const a=[];for(const t of e){const e=P(t.name,t.img_code,t.back_img_code);null!==e?a.push({name:t.name,front:e.front,back:e.back,backText:t.back_text||'',isFlipped:!1,frontName:e.frontName,backName:e.backName}):console.info(`[图鉴] 跳过重复的 ${t.name} 卡片`)}return a}const G=a('data',errorCatched(()=>{const e=getCurrentMessageId(),a=(0,o.ref)(null),t=(0,o.ref)([]),r=new Map,n=(t=0)=>{try{const t=getVariables({type:'message',message_id:e}),r=k().get(t,'stat_data',null);if(r&&Object.keys(r).length>0)a.value=k().cloneDeep(h.parse(r));else if(null==r){const e=h.parse({});return a.value=e,console.info('[踏月寻仙] 使用默认值初始化变量数据',{等级:e.本尊.等级,灵根:e.本尊.灵根,体质:e.本尊.体质,功法:e.本尊.功法}),toastr.info('当前楼层无数据，已使用默认值初始化','踏月寻仙'),void i()}console.info('[踏月寻仙] 成功加载变量数据',{等级:a.value?.本尊.等级,灵根:a.value?.本尊.灵根,体质:a.value?.本尊.体质,功法:a.value?.本尊.功法}),i()}catch(e){console.error('[踏月寻仙] 初始化数据失败',e),t<5?(console.info(`[踏月寻仙] 数据未就绪，200ms后第${t+1}次重试`),setTimeout(()=>{n(t+1)},200)):(console.warn('[踏月寻仙] 重试次数已用完，尝试手动触发MVU解析'),c())}},c=async()=>{try{await waitGlobalInitialized('Mvu');const t=getChatMessages(e);if(0===t.length)return console.warn('[踏月寻仙] 无法获取当前消息内容'),void l();const r=t[0].message||'';console.info('[踏月寻仙] 尝试手动触发MVU解析，消息长度:',r.length);const n=Mvu.getMvuData({type:'message',message_id:e}),o=await Mvu.parseMessage(r,n);await Mvu.replaceMvuData(o,{type:'message',message_id:e}),console.info('[踏月寻仙] MVU手动解析完成，重新加载数据'),setTimeout(()=>{const t=getVariables({type:'message',message_id:e}),r=k().get(t,'stat_data',null);r&&Object.keys(r).length>0?(a.value=k().cloneDeep(h.parse(r)),console.info('[踏月寻仙] ✅ 手动解析后成功加载数据'),toastr.success('已成功初始化状态数据','踏月寻仙'),i()):(console.warn('[踏月寻仙] 手动解析后仍无数据，使用备用方案'),l())},500)}catch(e){console.error('[踏月寻仙] 手动触发MVU解析失败',e),l()}},l=()=>{console.warn('[踏月寻仙] 启用备用方案');const e=s();e?(a.value=e,console.info('[踏月寻仙] 从上一楼层继承数据用于显示（不保存）'),toastr.info('正在显示上一楼层的状态数据','踏月寻仙')):(console.warn('[踏月寻仙] 无法继承数据，使用默认值'),a.value=h.parse({}),toastr.info('使用默认状态数据','踏月寻仙')),i()},s=()=>{try{const a=getChatMessages('0-{{lastMessageId}}'),t=a.findIndex(a=>a.message_id===e);if(-1===t)return console.warn('[踏月寻仙] 无法找到当前楼层索引'),null;for(let e=t-1;e>=0;e--){const t=a[e].message_id,r=getVariables({type:'message',message_id:t}),n=k().get(r,'stat_data',null);if(n){const e=k().cloneDeep(h.parse(n));return console.info(`[踏月寻仙] 从第 ${t} 楼继承数据`),e}}return console.warn('[踏月寻仙] 前面的楼层都没有有效数据'),null}catch(e){return console.error('[踏月寻仙] 继承数据时出错',e),null}},i=()=>{try{const a=getChatMessages(e);if(a.length>0){const n=a[0].message||'',o=`${e}_${n.length}`;if(r.has(o))return t.value=r.get(o),void console.info('[图鉴] 使用缓存的角色卡片');const c=function(e){try{const a=e.match(/<visual_cards>\s*([\s\S]*?)\s*<\/visual_cards>/);if(!a)return[];const t=a[1].trim();if(!t)return[];const r=JSON.parse(t);return Array.isArray(r)?r.filter(e=>e.name&&e.img_code&&'string'==typeof e.back_text):(console.warn('[图鉴] visual_cards 不是数组'),[])}catch(e){return console.error('[图鉴] 解析 visual_cards 失败',e),[]}}(n);if(c.length>0){const e=I(c);t.value=e,r.set(o,e),d(e),console.info('[图鉴] 解析到角色卡片',e.length,'张')}else t.value=[]}}catch(e){console.error('[图鉴] 解析消息卡片失败',e),toastr.warning(`解析角色卡片失败: ${e instanceof Error?e.message:'未知错误'}`,'图鉴')}},d=e=>{e.forEach(e=>{(new Image).src=e.front;(new Image).src=e.back}),console.info('[图鉴] 开始预加载',2*e.length,'张图片')};waitGlobalInitialized('Mvu').then(()=>{console.info('[踏月寻仙] MVU 框架已初始化，开始加载数据'),n()}).catch(()=>{console.warn('[踏月寻仙] MVU 框架未加载，直接初始化'),n()});let b=null;const p=(e=200)=>{b&&clearTimeout(b),b=setTimeout(()=>{n(),b=null},e)};eventOn(tavern_events.MESSAGE_UPDATED,a=>{a===e&&(console.info('[踏月寻仙] 检测到消息更新，防抖延迟200ms后重新加载'),p(200))}),eventOn(tavern_events.MESSAGE_DELETED,r=>{console.info('[踏月寻仙] 检测到消息删除（可能是重新roll），清空数据'),r===e&&(a.value=null,t.value=[])}),eventOn(tavern_events.MESSAGE_RECEIVED,a=>{a===e&&(console.info('[踏月寻仙] 检测到新消息接收，防抖延迟300ms后重新加载'),p(300))}),waitGlobalInitialized('Mvu').then(()=>{console.info('[踏月寻仙] 开始监听 MVU 变量更新事件（仅当前楼层）'),eventOn(Mvu.events.VARIABLE_UPDATE_ENDED,(t,r,n)=>{try{if(n?.message_id!==e)return void console.debug('[踏月寻仙] 忽略其他楼层的更新事件',{event_message_id:n?.message_id,current_message_id:e});const r=k().get(t,'stat_data',null);if(console.info('[踏月寻仙] MVU 变量更新事件触发（当前楼层）',{message_id:e,has_stat_data:null!==r&&Object.keys(r).length>0}),r&&Object.keys(r).length>0)try{const e=h.parse(r);a.value=k().cloneDeep(e),console.info('[踏月寻仙] ✅ MVU 变量已更新',{等级:e.本尊.等级,灵根:e.本尊.灵根,体质:e.本尊.体质,功法:e.本尊.功法,本命兵器:e.本尊.本命兵器,神通数量:Object.keys(e.本尊.神通列表).length,背包物品数:Object.keys(e.本尊.背包).length,法宝数量:Object.keys(e.本尊.法宝).length,灵石:e.本尊.灵石}),i()}catch(e){console.error('[踏月寻仙] Schema 解析失败',e),a.value=r}else console.warn('[踏月寻仙] stat_data 为空，跳过更新')}catch(e){console.error('[踏月寻仙] 处理 MVU 变量更新失败',e)}})}).catch(e=>{console.warn('[踏月寻仙] MVU 框架未加载，将仅显示静态数据',e)});const g=(0,o.computed)(()=>a.value?.世界时钟??{纪元:'末法时代',年份:1}),f=(0,o.computed)(()=>a.value?.世界地图??{}),u=(0,o.computed)(()=>a.value?.世界图志??{}),m=(0,o.computed)(()=>a.value?.本尊??h.parse({}).本尊),v=(0,o.computed)(()=>a.value?.红颜??{}),y=(0,o.computed)(()=>a.value?.NPC图鉴??{}),N=(0,o.computed)(()=>null!==a.value),E=(0,o.computed)(()=>t.value.length>0);return{rawData:a,世界时钟:g,世界地图:f,世界图志:u,本尊:m,红颜:v,NPC图鉴:y,hasData:N,refresh:n,galleryCards:t,hasGalleryCards:E,toggleCardFlip:e=>{t.value[e]&&(t.value[e].isFlipped=!t.value[e].isFlipped)},parseCurrentMessageCards:i}})),U=a('theme',()=>{const e=(0,o.ref)('default'),a=(0,o.computed)(()=>O(e.value)||F.find(e=>'red'===e.id)||F[0]),t=(0,o.computed)(()=>F);return(()=>{try{const a=getCurrentMessageId(),t=getVariables({type:'message',message_id:a}),r=k().get(t,'ui_theme_id','red');'string'==typeof r&&O(r)?(e.value=r,console.info('[主题] 加载已保存的主题:',r)):(e.value='red',console.info('[主题] 使用默认主题'))}catch(a){console.warn('[主题] 加载主题失败，使用默认主题',a),e.value='red'}})(),{currentThemeId:e,currentTheme:a,availableThemes:t,setTheme:t=>{if(O(t)){e.value=t;try{const e=getCurrentMessageId();updateVariablesWith(e=>(k().set(e,'ui_theme_id',t),e),{type:'message',message_id:e}),console.info('[主题] 主题已切换并保存:',t),toastr.success(`已切换至「${a.value.name}」主题`,'踏月寻仙')}catch(e){console.error('[主题] 保存主题失败',e),toastr.warning('主题切换成功，但保存失败','踏月寻仙')}}else console.warn('[主题] 无效的主题ID:',t)}}}),L={class:'header'},H={class:'header-left'},W=['title'],R={class:'world-time'},J={class:'theme-selector-header'},q={class:'theme-list'},K=['onClick'],Q={class:'theme-info'},X={class:'theme-name'},Y={class:'theme-desc'},Z={key:0,class:'fa-solid fa-check theme-check'},ee={class:'tab-nav'},ae=['onClick'],te={class:'content'},re={key:0,class:'panel cultivation-panel'},ne={class:'identity-section'},oe={class:'identity-name'},ce={class:'identity-info'},le={class:'realm-section'},se={class:'realm-status'},ie={class:'progress-section'},de={class:'progress-label'},be={class:'progress-bar'},pe={class:'progress-percent'},ge={class:'stats-grid'},fe={class:'stat-item'},ue={class:'stat-item'},me={class:'stat-value'},ve={class:'stat-item'},he={class:'stat-value'},ye={class:'stat-item'},Ne={class:'stat-value'},Ee={class:'stat-item'},Ve={class:'stat-value gold'},ke={class:'stat-item'},ze={class:'stat-value'},Be={class:'panel skills-panel'},_e={class:'skills-list'},Se={class:'skill-header'},xe={class:'skill-name'},Ce={class:'skill-rank'},De={class:'skill-desc'},Me={class:'skill-proficiency'},we={key:0,class:'empty-hint'},je={class:'panel inventory-panel'},Ae={class:'inventory-section'},$e={class:'items-grid'},Pe={class:'item-name'},Te={class:'item-rank'},Fe={class:'item-desc'},Oe={key:0,class:'empty-hint'},Ie={class:'inventory-section'},Ge={class:'items-grid'},Ue={class:'item-header'},Le={class:'item-name'},He={class:'item-count'},We={class:'item-rank'},Re={class:'item-desc'},Je={key:0,class:'empty-hint'},qe={class:'panel companions-panel'},Ke={class:'companions-list'},Qe={class:'companion-header'},Xe={class:'companion-name'},Ye={class:'companion-relation'},Ze={class:'relation-value'},ea={class:'companion-favor'},aa={class:'favor-bar'},ta={class:'favor-value'},ra={key:0,class:'empty-hint'},na={class:'panel map-panel'},oa={class:'current-location'},ca={class:'location-name'},la={class:'location-layer'},sa={class:'location-desc'},ia={class:'connections'},da={class:'connections-list'},ba={key:0,class:'empty-hint',style:{padding:'10px'}},pa={class:'panel gallery-panel'},ga={key:0,class:'gallery-container'},fa=['onClick'],ua={class:'card-inner'},ma={class:'card-face card-front'},va=['src','alt'],ha={class:'card-name-bar'},ya={class:'card-face card-back'},Na={class:'back-content'},Ea=['src','alt'],Va={class:'back-info-panel'},ka={class:'back-name'},za={class:'back-text'},Ba={key:1,class:'empty-hint'},_a={class:'footer'},Sa={class:'footer-item'},xa={class:'footer-item'},Ca=(0,o.defineComponent)({__name:'app',setup(e){const a=G(),t=U(),r=[{id:'cultivation',label:'修炼',icon:'fa-solid fa-yin-yang'},{id:'skills',label:'神通',icon:'fa-solid fa-hand-sparkles'},{id:'inventory',label:'储物',icon:'fa-solid fa-box-open'},{id:'companions',label:'红颜',icon:'fa-solid fa-heart'},{id:'map',label:'行踪',icon:'fa-solid fa-map'},{id:'gallery',label:'图鉴',icon:'fa-solid fa-images'}],n=(0,o.ref)('gallery'),c=(0,o.ref)(!1),l=(0,o.ref)(!1),s=()=>{c.value=!c.value},i=()=>{l.value=!l.value},d=(0,o.computed)(()=>{const e=t.currentTheme;return{'--bg-primary':e.colors.bgPrimary,'--bg-secondary':e.colors.bgSecondary,'--border-color':e.colors.border,'--border-active':e.colors.borderActive,'--text-primary':e.colors.textPrimary,'--text-secondary':e.colors.textSecondary,'--text-accent':e.colors.textAccent,'--accent-color':e.colors.accent,'--accent-glow':e.colors.accentGlow,'--button-bg':e.colors.buttonBg,'--button-hover':e.colors.buttonHover,'--button-active':e.colors.buttonActive,'--progress-bg':e.colors.progressBg,'--header-bg':e.colors.headerBg,'--tab-bg':e.colors.tabBg,'--tab-active':e.colors.tabActive,'--footer-bg':e.colors.footerBg,'--pattern-overlay':e.patterns.overlay||'none'}}),b=(0,o.computed)(()=>N(a.本尊.等级)),p=(0,o.computed)(()=>function(e){for(const[a,t]of Object.entries(y))if(e.includes(a))return t.color;return'#aaaaaa'}(a.本尊.灵根)),g=(0,o.computed)(()=>E(a.本尊.行踪.危险度??10)),f=(0,o.computed)(()=>{const e=a.本尊.行踪.所属层级;return'天层'===e?'#88ddff':'下层'===e?'#ff4444':'#44aa44'}),u=e=>{const t=a.世界地图[e];return t?E(t.danger):'#888888'};return(e,m)=>((0,o.openBlock)(),(0,o.createElementBlock)('div',{class:(0,o.normalizeClass)(['cultivation-status',{collapsed:(0,o.unref)(c)}]),style:(0,o.normalizeStyle)((0,o.unref)(d))},[(0,o.createCommentVNode)(' 背景图案层 '),m[24]||(m[24]=(0,o.createElementVNode)('div',{class:'pattern-overlay'},null,-1)),(0,o.createCommentVNode)(' 仙鹤装饰 - 顶部中央 '),m[25]||(m[25]=(0,o.createElementVNode)('div',{class:'crane-decoration'},[(0,o.createElementVNode)('img',{src:'https://pub-4d14ab94aa29488b977bc5be9f2a06ef.r2.dev/picgo/仙鹤.png',alt:'仙鹤'})],-1)),(0,o.createCommentVNode)(' 顶部：折叠按钮 + 世界时钟与位置 '),(0,o.createElementVNode)('div',L,[(0,o.createElementVNode)('div',H,[(0,o.createElementVNode)('button',{class:'collapse-btn',onClick:s,title:(0,o.unref)(c)?'展开状态栏':'收起状态栏'},[(0,o.createElementVNode)('i',{class:(0,o.normalizeClass)((0,o.unref)(c)?'fa-solid fa-chevron-down':'fa-solid fa-chevron-up')},null,2)],8,W),(0,o.createElementVNode)('button',{class:'theme-btn',onClick:i,title:'切换主题'},[...m[3]||(m[3]=[(0,o.createElementVNode)('i',{class:'fa-solid fa-palette'},null,-1)])])]),(0,o.createElementVNode)('div',R,[m[4]||(m[4]=(0,o.createElementVNode)('i',{class:'fa-solid fa-moon'},null,-1)),(0,o.createElementVNode)('span',null,(0,o.toDisplayString)((0,o.unref)(a).世界时钟.纪元)+' · 第'+(0,o.toDisplayString)((0,o.unref)(a).世界时钟.年份)+'年',1)]),(0,o.createElementVNode)('div',{class:'location',style:(0,o.normalizeStyle)({color:(0,o.unref)(f)})},[m[5]||(m[5]=(0,o.createElementVNode)('i',{class:'fa-solid fa-location-dot'},null,-1)),(0,o.createElementVNode)('span',null,(0,o.toDisplayString)((0,o.unref)(a).本尊.行踪.当前区域),1),(0,o.createElementVNode)('span',{class:'danger-badge',style:(0,o.normalizeStyle)({backgroundColor:(0,o.unref)(g)})},' 危险度 '+(0,o.toDisplayString)((0,o.unref)(a).本尊.行踪.危险度??10),5)],4)]),(0,o.createCommentVNode)(' 主题选择器弹窗 '),(0,o.createVNode)(o.Transition,{name:'theme-selector-fade'},{default:(0,o.withCtx)(()=>[(0,o.unref)(l)?((0,o.openBlock)(),(0,o.createElementBlock)('div',{key:0,class:'theme-selector-overlay',onClick:m[2]||(m[2]=e=>l.value=!1)},[(0,o.createElementVNode)('div',{class:'theme-selector',onClick:m[1]||(m[1]=(0,o.withModifiers)(()=>{},['stop']))},[(0,o.createElementVNode)('div',J,[m[7]||(m[7]=(0,o.createElementVNode)('h3',null,[(0,o.createElementVNode)('i',{class:'fa-solid fa-palette'}),(0,o.createTextVNode)(' 选择主题')],-1)),(0,o.createElementVNode)('button',{class:'close-btn',onClick:m[0]||(m[0]=e=>l.value=!1)},[...m[6]||(m[6]=[(0,o.createElementVNode)('i',{class:'fa-solid fa-times'},null,-1)])])]),(0,o.createElementVNode)('div',q,[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)((0,o.unref)(t).availableThemes,e=>((0,o.openBlock)(),(0,o.createElementBlock)('div',{key:e.id,class:(0,o.normalizeClass)(['theme-item',{active:e.id===(0,o.unref)(t).currentThemeId}]),onClick:a=>{return r=e.id,t.setTheme(r),void(l.value=!1);var r}},[(0,o.createElementVNode)('div',{class:'theme-preview',style:(0,o.normalizeStyle)({background:e.colors.bgPrimary})},[(0,o.createElementVNode)('div',{class:'theme-preview-border',style:(0,o.normalizeStyle)({borderColor:e.colors.border})},null,4)],4),(0,o.createElementVNode)('div',Q,[(0,o.createElementVNode)('div',X,(0,o.toDisplayString)(e.name),1),(0,o.createElementVNode)('div',Y,(0,o.toDisplayString)(e.description),1)]),e.id===(0,o.unref)(t).currentThemeId?((0,o.openBlock)(),(0,o.createElementBlock)('i',Z)):(0,o.createCommentVNode)('v-if',!0)],10,K))),128))])])])):(0,o.createCommentVNode)('v-if',!0)]),_:1}),(0,o.createCommentVNode)(' 主体：标签页导航 '),(0,o.createElementVNode)('div',ee,[((0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(r,e=>(0,o.createElementVNode)('button',{key:e.id,class:(0,o.normalizeClass)(['tab-btn',{active:(0,o.unref)(n)===e.id}]),onClick:a=>n.value=e.id},[(0,o.createElementVNode)('i',{class:(0,o.normalizeClass)(e.icon)},null,2),(0,o.createTextVNode)(' '+(0,o.toDisplayString)(e.label),1)],10,ae)),64))]),(0,o.createCommentVNode)(' 内容区域 '),(0,o.createElementVNode)('div',te,[(0,o.createCommentVNode)(' 修炼面板 '),'cultivation'===(0,o.unref)(n)?((0,o.openBlock)(),(0,o.createElementBlock)('div',re,[(0,o.createElementVNode)('div',ne,[(0,o.createElementVNode)('div',oe,(0,o.toDisplayString)((0,o.unref)(a).本尊.身份.姓名),1),(0,o.createElementVNode)('div',ce,[(0,o.createElementVNode)('span',null,(0,o.toDisplayString)((0,o.unref)(a).本尊.身份.宗门),1),m[8]||(m[8]=(0,o.createElementVNode)('span',{class:'divider'},'·',-1)),(0,o.createElementVNode)('span',null,(0,o.toDisplayString)((0,o.unref)(a).本尊.身份.出身),1)])]),(0,o.createElementVNode)('div',le,[(0,o.createElementVNode)('div',{class:'realm-title',style:(0,o.normalizeStyle)({color:(0,o.unref)(b)})},[m[9]||(m[9]=(0,o.createElementVNode)('i',{class:'fa-solid fa-yin-yang'},null,-1)),(0,o.createTextVNode)(' '+(0,o.toDisplayString)((0,o.unref)(a).本尊.境界描述),1)],4),(0,o.createElementVNode)('div',se,(0,o.toDisplayString)((0,o.unref)(a).本尊.状态),1)]),(0,o.createElementVNode)('div',ie,[(0,o.createElementVNode)('div',de,[m[10]||(m[10]=(0,o.createElementVNode)('span',null,'修为进度',-1)),(0,o.createElementVNode)('span',null,(0,o.toDisplayString)((0,o.unref)(a).本尊.修为)+' / '+(0,o.toDisplayString)((0,o.unref)(a).本尊.突破阈值),1)]),(0,o.createElementVNode)('div',be,[(0,o.createElementVNode)('div',{class:'progress-fill',style:(0,o.normalizeStyle)({width:(0,o.unref)(a).本尊.进度,backgroundColor:(0,o.unref)(b)})},null,4)]),(0,o.createElementVNode)('div',pe,(0,o.toDisplayString)((0,o.unref)(a).本尊.进度),1)]),(0,o.createElementVNode)('div',ge,[(0,o.createElementVNode)('div',fe,[m[11]||(m[11]=(0,o.createElementVNode)('div',{class:'stat-label'},'灵根',-1)),(0,o.createElementVNode)('div',{class:'stat-value',style:(0,o.normalizeStyle)({color:(0,o.unref)(p)})},(0,o.toDisplayString)((0,o.unref)(a).本尊.灵根),5)]),(0,o.createElementVNode)('div',ue,[m[12]||(m[12]=(0,o.createElementVNode)('div',{class:'stat-label'},'体质',-1)),(0,o.createElementVNode)('div',me,(0,o.toDisplayString)((0,o.unref)(a).本尊.体质),1)]),(0,o.createElementVNode)('div',ve,[m[13]||(m[13]=(0,o.createElementVNode)('div',{class:'stat-label'},'功法',-1)),(0,o.createElementVNode)('div',he,(0,o.toDisplayString)((0,o.unref)(a).本尊.功法),1)]),(0,o.createElementVNode)('div',ye,[m[14]||(m[14]=(0,o.createElementVNode)('div',{class:'stat-label'},'本命兵器',-1)),(0,o.createElementVNode)('div',Ne,(0,o.toDisplayString)((0,o.unref)(a).本尊.本命兵器),1)]),(0,o.createElementVNode)('div',Ee,[m[15]||(m[15]=(0,o.createElementVNode)('div',{class:'stat-label'},'灵石',-1)),(0,o.createElementVNode)('div',Ve,(0,o.toDisplayString)((0,o.unref)(a).本尊.灵石),1)]),(0,o.createElementVNode)('div',ke,[m[16]||(m[16]=(0,o.createElementVNode)('div',{class:'stat-label'},'寿元',-1)),(0,o.createElementVNode)('div',ze,(0,o.toDisplayString)((0,o.unref)(a).本尊.寿元状态),1)])])])):'skills'===(0,o.unref)(n)?((0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,{key:1},[(0,o.createCommentVNode)(' 神通面板 '),(0,o.createElementVNode)('div',Be,[(0,o.createElementVNode)('div',_e,[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)((0,o.unref)(a).本尊.神通列表,(e,a)=>((0,o.openBlock)(),(0,o.createElementBlock)('div',{key:a,class:'skill-item'},[(0,o.createElementVNode)('div',Se,[(0,o.createElementVNode)('div',xe,(0,o.toDisplayString)(e.名称||a),1),(0,o.createElementVNode)('div',Ce,(0,o.toDisplayString)(e.品阶),1)]),(0,o.createElementVNode)('div',De,(0,o.toDisplayString)(e.描述),1),(0,o.createElementVNode)('div',Me,'熟练度: '+(0,o.toDisplayString)(e.熟练度),1)]))),128)),(0,o.unref)(a).本尊.神通列表&&0!==Object.keys((0,o.unref)(a).本尊.神通列表).length?(0,o.createCommentVNode)('v-if',!0):((0,o.openBlock)(),(0,o.createElementBlock)('div',we,' 尚未领悟任何神通 '))])])],2112)):'inventory'===(0,o.unref)(n)?((0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,{key:2},[(0,o.createCommentVNode)(' 储物面板 '),(0,o.createElementVNode)('div',je,[(0,o.createElementVNode)('div',Ae,[m[17]||(m[17]=(0,o.createElementVNode)('div',{class:'section-title'},[(0,o.createElementVNode)('i',{class:'fa-solid fa-gem'}),(0,o.createTextVNode)(' 法宝 ')],-1)),(0,o.createElementVNode)('div',$e,[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)((0,o.unref)(a).本尊.法宝,(e,a)=>((0,o.openBlock)(),(0,o.createElementBlock)('div',{key:a,class:'item-card treasure'},[(0,o.createElementVNode)('div',Pe,(0,o.toDisplayString)(e.名称),1),(0,o.createElementVNode)('div',Te,(0,o.toDisplayString)(e.品阶),1),(0,o.createElementVNode)('div',Fe,(0,o.toDisplayString)(e.描述),1)]))),128)),0===Object.keys((0,o.unref)(a).本尊.法宝).length?((0,o.openBlock)(),(0,o.createElementBlock)('div',Oe,'空空如也')):(0,o.createCommentVNode)('v-if',!0)])]),(0,o.createElementVNode)('div',Ie,[m[18]||(m[18]=(0,o.createElementVNode)('div',{class:'section-title'},[(0,o.createElementVNode)('i',{class:'fa-solid fa-box-open'}),(0,o.createTextVNode)(' 储物戒 ')],-1)),(0,o.createElementVNode)('div',Ge,[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)((0,o.unref)(a).本尊.背包,(e,a)=>((0,o.openBlock)(),(0,o.createElementBlock)('div',{key:a,class:'item-card'},[(0,o.createElementVNode)('div',Ue,[(0,o.createElementVNode)('span',Le,(0,o.toDisplayString)(e.名称),1),(0,o.createElementVNode)('span',He,'×'+(0,o.toDisplayString)(e.数量),1)]),(0,o.createElementVNode)('div',We,(0,o.toDisplayString)(e.品阶),1),(0,o.createElementVNode)('div',Re,(0,o.toDisplayString)(e.描述),1)]))),128)),0===Object.keys((0,o.unref)(a).本尊.背包).length?((0,o.openBlock)(),(0,o.createElementBlock)('div',Je,'空空如也')):(0,o.createCommentVNode)('v-if',!0)])])])],2112)):'companions'===(0,o.unref)(n)?((0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,{key:3},[(0,o.createCommentVNode)(' 红颜面板 '),(0,o.createElementVNode)('div',qe,[(0,o.createElementVNode)('div',Ke,[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)((0,o.unref)(a).红颜,(e,a)=>((0,o.openBlock)(),(0,o.createElementBlock)('div',{key:a,class:'companion-card'},[(0,o.createElementVNode)('div',Qe,[(0,o.createElementVNode)('span',Xe,(0,o.toDisplayString)(a),1),(0,o.createElementVNode)('span',{class:'companion-realm',style:(0,o.normalizeStyle)({color:(0,o.unref)(N)(e.等级)})},(0,o.toDisplayString)(e.境界描述),5)]),(0,o.createElementVNode)('div',Ye,[m[19]||(m[19]=(0,o.createElementVNode)('span',{class:'relation-label'},'关系:',-1)),(0,o.createElementVNode)('span',Ze,(0,o.toDisplayString)(e.关系),1)]),(0,o.createElementVNode)('div',ea,[m[20]||(m[20]=(0,o.createElementVNode)('div',{class:'favor-label'},'好感度',-1)),(0,o.createElementVNode)('div',aa,[(0,o.createElementVNode)('div',{class:'favor-fill',style:(0,o.normalizeStyle)({width:`${Math.abs(e.好感度)}%`,backgroundColor:e.好感度>=0?'#ff6b9d':'#6b7fff'})},null,4)]),(0,o.createElementVNode)('div',ta,(0,o.toDisplayString)(e.好感度),1)])]))),128)),0===Object.keys((0,o.unref)(a).红颜).length?((0,o.openBlock)(),(0,o.createElementBlock)('div',ra,'孑然一身，尚无红颜知己')):(0,o.createCommentVNode)('v-if',!0)])])],2112)):'map'===(0,o.unref)(n)?((0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,{key:4},[(0,o.createCommentVNode)(' 地图面板 '),(0,o.createElementVNode)('div',na,[(0,o.createElementVNode)('div',oa,[(0,o.createElementVNode)('div',ca,(0,o.toDisplayString)((0,o.unref)(a).本尊.行踪.当前区域),1),(0,o.createElementVNode)('div',la,(0,o.toDisplayString)((0,o.unref)(a).本尊.行踪.所属层级),1),(0,o.createElementVNode)('div',sa,(0,o.toDisplayString)((0,o.unref)(a).本尊.行踪.环境描述),1)]),(0,o.createElementVNode)('div',ia,[m[21]||(m[21]=(0,o.createElementVNode)('div',{class:'connections-title'},'可通往：',-1)),(0,o.createElementVNode)('div',da,[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)((0,o.unref)(a).本尊.行踪.可用通道,e=>((0,o.openBlock)(),(0,o.createElementBlock)('span',{key:e,class:'connection-item',style:(0,o.normalizeStyle)({borderColor:u(e)})},(0,o.toDisplayString)(e),5))),128)),(0,o.unref)(a).本尊.行踪.可用通道&&0!==(0,o.unref)(a).本尊.行踪.可用通道.length?(0,o.createCommentVNode)('v-if',!0):((0,o.openBlock)(),(0,o.createElementBlock)('div',ba,' 尚未探明通道 '))])])])],2112)):'gallery'===(0,o.unref)(n)?((0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,{key:5},[(0,o.createCommentVNode)(' 图鉴面板 - 按比例展示卡片 '),(0,o.createElementVNode)('div',pa,[(0,o.unref)(a).hasGalleryCards?((0,o.openBlock)(),(0,o.createElementBlock)('div',ga,[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)((0,o.unref)(a).galleryCards,(e,t)=>((0,o.openBlock)(),(0,o.createElementBlock)('div',{key:t,class:(0,o.normalizeClass)(['gallery-card',{flipped:e.isFlipped}]),onClick:e=>(0,o.unref)(a).toggleCardFlip(t)},[(0,o.createElementVNode)('div',ua,[(0,o.createCommentVNode)(' 正面 '),(0,o.createElementVNode)('div',ma,[(0,o.createElementVNode)('img',{src:e.front,alt:e.frontName||e.name},null,8,va),(0,o.createElementVNode)('div',ha,(0,o.toDisplayString)(e.frontName||e.name),1)]),(0,o.createCommentVNode)(' 背面 '),(0,o.createElementVNode)('div',ya,[(0,o.createElementVNode)('div',Na,[(0,o.createElementVNode)('img',{src:e.back,alt:e.backName||e.name,class:'back-image'},null,8,Ea),(0,o.createElementVNode)('div',Va,[(0,o.createElementVNode)('div',ka,(0,o.toDisplayString)(e.backName||e.name),1),(0,o.createElementVNode)('div',za,'「'+(0,o.toDisplayString)(e.backText)+'」',1)])])])])],10,fa))),128))])):((0,o.openBlock)(),(0,o.createElementBlock)('div',Ba,' 当前场景暂无角色卡片 '))])],2112)):(0,o.createCommentVNode)('v-if',!0)]),(0,o.createCommentVNode)(' 底部：快捷信息 '),(0,o.createElementVNode)('div',_a,[(0,o.createElementVNode)('div',Sa,[m[22]||(m[22]=(0,o.createElementVNode)('i',{class:'fa-solid fa-coins'},null,-1)),(0,o.createElementVNode)('span',null,(0,o.toDisplayString)((0,o.unref)(a).本尊.灵石)+' 灵石',1)]),(0,o.createElementVNode)('div',xa,[m[23]||(m[23]=(0,o.createElementVNode)('i',{class:'fa-solid fa-heart'},null,-1)),(0,o.createElementVNode)('span',null,(0,o.toDisplayString)((0,o.unref)(a).本尊.寿元状态),1)])])],6))}});const Da=(0,n(502).A)(Ca,[['__scopeId','data-v-0742d52d']]);$(()=>{const a=e(),t=(0,o.createApp)(Da);t.use(a),t.mount('#app'),console.info('[踏月寻仙] 状态栏界面已加载')});
//# sourceMappingURL=index.js.map</script><style>.cultivation-status[data-v-0742d52d]{width:100%;margin:0 auto;font-family:"Microsoft YaHei","PingFang SC",sans-serif;background:var(--bg-primary);border:1px solid var(--border-color);border-radius:12px;overflow:hidden;color:var(--text-primary);font-size:14px;transition:all .3s ease;display:flex;flex-direction:column;position:relative}.cultivation-status .pattern-overlay[data-v-0742d52d]{position:absolute;top:0;left:0;right:0;bottom:0;background-image:var(--pattern-overlay);background-size:100px 65px,85px 55px,110px 70px,90px 60px,75px 50px;background-position:5% 15%,85% 25%,15% 65%,75% 70%,45% 85%;background-repeat:no-repeat;pointer-events:none;opacity:.25;z-index:0}.cultivation-status .crane-decoration[data-v-0742d52d]{position:absolute;top:22px;left:50%;transform:translateX(-50%);width:60px;height:60px;z-index:3;pointer-events:none;animation:crane-float-0742d52d 4s ease-in-out infinite}.cultivation-status .crane-decoration img[data-v-0742d52d]{width:100%;height:100%;object-fit:contain;filter:drop-shadow(0 3px 12px rgba(0,0,0,0.4))}@keyframes crane-float-0742d52d{0%,100%{transform:translateX(-50%) translateY(0)}50%{transform:translateX(-50%) translateY(-8px)}}.cultivation-status[data-v-0742d52d]>*{position:relative;z-index:1}.cultivation-status.collapsed .tab-nav[data-v-0742d52d],.cultivation-status.collapsed .content[data-v-0742d52d]{display:none}.cultivation-status.collapsed .header[data-v-0742d52d]{border-bottom:none}.header[data-v-0742d52d]{display:flex;justify-content:space-between;align-items:center;padding:20px 16px 12px 16px;min-height:80px;background:var(--header-bg);border-bottom:1px solid var(--border-color)}.header .header-left[data-v-0742d52d]{display:flex;gap:8px;align-items:center}.header .collapse-btn[data-v-0742d52d],.header .theme-btn[data-v-0742d52d]{display:flex;align-items:center;justify-content:center;width:28px;height:28px;background:var(--button-bg);border:1px solid var(--border-color);border-radius:6px;color:var(--text-accent);cursor:pointer;transition:all .2s}.header .collapse-btn[data-v-0742d52d]:hover,.header .theme-btn[data-v-0742d52d]:hover{background:var(--button-hover);color:var(--text-primary);border-color:var(--border-active)}.header .collapse-btn i[data-v-0742d52d],.header .theme-btn i[data-v-0742d52d]{font-size:12px}.header .world-time[data-v-0742d52d]{display:flex;align-items:center;gap:6px;color:var(--text-accent)}.header .world-time i[data-v-0742d52d]{color:var(--accent-color)}.header .location[data-v-0742d52d]{display:flex;align-items:center;gap:8px;margin-left:auto}.header .location .danger-badge[data-v-0742d52d]{font-size:10px;padding:2px 6px;border-radius:10px;color:#fff}.theme-selector-overlay[data-v-0742d52d]{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.6);display:flex;align-items:center;justify-content:center;z-index:1000}.theme-selector[data-v-0742d52d]{background:var(--bg-primary);border:2px solid var(--border-active);border-radius:12px;width:90%;max-width:500px;max-height:80vh;overflow:hidden;display:flex;flex-direction:column;box-shadow:0 10px 40px rgba(0,0,0,.5)}.theme-selector .theme-selector-header[data-v-0742d52d]{display:flex;justify-content:space-between;align-items:center;padding:16px 20px;background:var(--header-bg);border-bottom:1px solid var(--border-color)}.theme-selector .theme-selector-header h3[data-v-0742d52d]{margin:0;font-size:16px;color:var(--text-primary);display:flex;align-items:center;gap:8px}.theme-selector .theme-selector-header h3 i[data-v-0742d52d]{color:var(--accent-color)}.theme-selector .theme-selector-header .close-btn[data-v-0742d52d]{width:28px;height:28px;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,0);border:1px solid var(--border-color);border-radius:6px;color:var(--text-secondary);cursor:pointer;transition:all .2s}.theme-selector .theme-selector-header .close-btn[data-v-0742d52d]:hover{background:var(--button-hover);color:var(--text-primary);border-color:var(--border-active)}.theme-selector .theme-list[data-v-0742d52d]{flex:1;overflow-y:auto;padding:12px}.theme-selector .theme-list[data-v-0742d52d]::-webkit-scrollbar{width:6px}.theme-selector .theme-list[data-v-0742d52d]::-webkit-scrollbar-track{background:var(--bg-secondary);border-radius:3px}.theme-selector .theme-list[data-v-0742d52d]::-webkit-scrollbar-thumb{background:var(--button-bg);border-radius:3px}.theme-selector .theme-list[data-v-0742d52d]::-webkit-scrollbar-thumb:hover{background:var(--button-hover)}.theme-selector .theme-item[data-v-0742d52d]{display:flex;align-items:center;gap:12px;padding:12px;margin-bottom:8px;background:var(--bg-secondary);border:2px solid rgba(0,0,0,0);border-radius:8px;cursor:pointer;transition:all .2s;position:relative}.theme-selector .theme-item[data-v-0742d52d]:hover{background:var(--button-bg);border-color:var(--border-color)}.theme-selector .theme-item.active[data-v-0742d52d]{border-color:var(--border-active);background:var(--button-active)}.theme-selector .theme-item .theme-preview[data-v-0742d52d]{width:60px;height:60px;border-radius:8px;display:flex;align-items:center;justify-content:center;flex-shrink:0}.theme-selector .theme-item .theme-preview .theme-preview-border[data-v-0742d52d]{width:40px;height:40px;border:2px solid;border-radius:6px}.theme-selector .theme-item .theme-info[data-v-0742d52d]{flex:1}.theme-selector .theme-item .theme-info .theme-name[data-v-0742d52d]{font-size:14px;font-weight:bold;color:var(--text-primary);margin-bottom:4px}.theme-selector .theme-item .theme-info .theme-desc[data-v-0742d52d]{font-size:12px;color:var(--text-secondary)}.theme-selector .theme-item .theme-check[data-v-0742d52d]{color:var(--accent-color);font-size:18px}.theme-selector-fade-enter-active[data-v-0742d52d],.theme-selector-fade-leave-active[data-v-0742d52d]{transition:opacity .3s}.theme-selector-fade-enter-from[data-v-0742d52d],.theme-selector-fade-leave-to[data-v-0742d52d]{opacity:0}.tab-nav[data-v-0742d52d]{display:flex;padding:8px 12px;gap:4px;background:var(--tab-bg);border-bottom:1px solid var(--border-color);overflow-x:auto}.tab-nav[data-v-0742d52d]::-webkit-scrollbar{display:none}.tab-nav .tab-btn[data-v-0742d52d]{flex:1;min-width:60px;padding:8px 12px;background:rgba(0,0,0,0);border:1px solid rgba(0,0,0,0);border-radius:6px;color:var(--text-secondary);font-size:12px;cursor:pointer;transition:all .2s;display:flex;align-items:center;justify-content:center;gap:4px;white-space:nowrap}.tab-nav .tab-btn[data-v-0742d52d]:hover{background:var(--button-bg);color:var(--text-accent)}.tab-nav .tab-btn.active[data-v-0742d52d]{background:var(--tab-active);border-color:var(--border-active);color:var(--text-primary)}.content[data-v-0742d52d]{flex:1;min-height:280px;max-height:600px;overflow-y:auto}.content[data-v-0742d52d]::-webkit-scrollbar{width:6px}.content[data-v-0742d52d]::-webkit-scrollbar-track{background:var(--bg-secondary);border-radius:3px}.content[data-v-0742d52d]::-webkit-scrollbar-thumb{background:var(--button-bg);border-radius:3px}.content[data-v-0742d52d]::-webkit-scrollbar-thumb:hover{background:var(--button-hover)}.panel[data-v-0742d52d]{padding:16px}.cultivation-panel .identity-section[data-v-0742d52d]{text-align:center;margin-bottom:16px}.cultivation-panel .identity-section .identity-name[data-v-0742d52d]{font-size:20px;font-weight:bold;color:var(--text-primary);text-shadow:0 0 10px var(--accent-glow)}.cultivation-panel .identity-section .identity-info[data-v-0742d52d]{color:var(--text-secondary);font-size:12px;margin-top:4px}.cultivation-panel .identity-section .identity-info .divider[data-v-0742d52d]{margin:0 6px;opacity:.5}.cultivation-panel .realm-section[data-v-0742d52d]{display:flex;justify-content:center;align-items:center;gap:12px;margin-bottom:16px}.cultivation-panel .realm-section .realm-title[data-v-0742d52d]{font-size:18px;font-weight:bold;display:flex;align-items:center;gap:6px}.cultivation-panel .realm-section .realm-title i[data-v-0742d52d]{animation:spin-0742d52d 10s linear infinite}.cultivation-panel .realm-section .realm-status[data-v-0742d52d]{font-size:12px;padding:3px 8px;background:var(--button-bg);border:1px solid var(--border-color);border-radius:4px;color:var(--accent-color)}.cultivation-panel .progress-section[data-v-0742d52d]{margin-bottom:20px}.cultivation-panel .progress-section .progress-label[data-v-0742d52d]{display:flex;justify-content:space-between;font-size:12px;color:var(--text-secondary);margin-bottom:6px}.cultivation-panel .progress-section .progress-bar[data-v-0742d52d]{height:8px;background:var(--progress-bg);border-radius:4px;overflow:hidden}.cultivation-panel .progress-section .progress-bar .progress-fill[data-v-0742d52d]{height:100%;border-radius:4px;transition:width .5s ease;box-shadow:0 0 10px currentColor}.cultivation-panel .progress-section .progress-percent[data-v-0742d52d]{text-align:right;font-size:11px;color:var(--text-secondary);margin-top:4px}.cultivation-panel .stats-grid[data-v-0742d52d]{display:grid;grid-template-columns:repeat(3,1fr);gap:12px}.cultivation-panel .stats-grid .stat-item[data-v-0742d52d]{text-align:center;padding:10px 8px;background:var(--bg-secondary);border:1px solid var(--border-color);border-radius:8px}.cultivation-panel .stats-grid .stat-item .stat-label[data-v-0742d52d]{font-size:11px;color:var(--text-secondary);margin-bottom:4px}.cultivation-panel .stats-grid .stat-item .stat-value[data-v-0742d52d]{font-size:13px;font-weight:500;color:var(--text-primary)}.cultivation-panel .stats-grid .stat-item .stat-value.gold[data-v-0742d52d]{color:gold}.skills-panel .skills-list[data-v-0742d52d]{display:flex;flex-direction:column;gap:12px}.skills-panel .skill-item[data-v-0742d52d]{padding:12px;background:var(--bg-secondary);border:1px solid var(--border-color);border-radius:8px}.skills-panel .skill-item .skill-header[data-v-0742d52d]{display:flex;justify-content:space-between;align-items:center;margin-bottom:6px}.skills-panel .skill-item .skill-name[data-v-0742d52d]{font-size:14px;font-weight:bold;color:var(--accent-color)}.skills-panel .skill-item .skill-rank[data-v-0742d52d]{font-size:11px;color:#ffc864;padding:2px 8px;background:rgba(255,200,100,.1);border-radius:4px}.skills-panel .skill-item .skill-desc[data-v-0742d52d]{font-size:12px;color:var(--text-secondary);line-height:1.5;margin-bottom:4px}.skills-panel .skill-item .skill-proficiency[data-v-0742d52d]{font-size:11px;color:var(--text-accent)}.inventory-panel .inventory-section[data-v-0742d52d]{margin-bottom:20px}.inventory-panel .inventory-section[data-v-0742d52d]:last-child{margin-bottom:0}.inventory-panel .section-title[data-v-0742d52d]{font-size:14px;font-weight:bold;color:var(--text-accent);margin-bottom:10px;display:flex;align-items:center;gap:6px}.inventory-panel .section-title i[data-v-0742d52d]{color:var(--accent-color)}.inventory-panel .items-grid[data-v-0742d52d]{display:flex;flex-direction:column;gap:8px}.inventory-panel .item-card[data-v-0742d52d]{padding:10px 12px;background:var(--bg-secondary);border:1px solid var(--border-color);border-radius:6px}.inventory-panel .item-card.treasure[data-v-0742d52d]{border-color:var(--border-active);background:var(--button-active)}.inventory-panel .item-card .item-header[data-v-0742d52d]{display:flex;justify-content:space-between;align-items:center}.inventory-panel .item-card .item-name[data-v-0742d52d]{font-weight:500;color:var(--text-primary)}.inventory-panel .item-card .item-count[data-v-0742d52d]{font-size:12px;color:var(--accent-color)}.inventory-panel .item-card .item-rank[data-v-0742d52d]{font-size:11px;color:#ffc864;margin:4px 0}.inventory-panel .item-card .item-desc[data-v-0742d52d]{font-size:11px;color:var(--text-secondary)}.companions-panel .companions-list[data-v-0742d52d]{display:flex;flex-direction:column;gap:12px}.companions-panel .companion-card[data-v-0742d52d]{padding:12px;background:var(--bg-secondary);border:1px solid var(--border-color);border-radius:8px}.companions-panel .companion-card .companion-header[data-v-0742d52d]{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}.companions-panel .companion-card .companion-header .companion-name[data-v-0742d52d]{font-size:15px;font-weight:bold;color:#ffb0c0}.companions-panel .companion-card .companion-header .companion-realm[data-v-0742d52d]{font-size:12px}.companions-panel .companion-card .companion-relation[data-v-0742d52d]{font-size:12px;color:var(--text-secondary);margin-bottom:8px}.companions-panel .companion-card .companion-relation .relation-value[data-v-0742d52d]{color:var(--text-accent);margin-left:4px}.companions-panel .companion-card .companion-favor[data-v-0742d52d]{display:flex;align-items:center;gap:8px}.companions-panel .companion-card .companion-favor .favor-label[data-v-0742d52d]{font-size:11px;color:var(--text-secondary);min-width:42px}.companions-panel .companion-card .companion-favor .favor-bar[data-v-0742d52d]{flex:1;height:6px;background:var(--progress-bg);border-radius:3px;overflow:hidden}.companions-panel .companion-card .companion-favor .favor-bar .favor-fill[data-v-0742d52d]{height:100%;border-radius:3px;transition:width .3s ease}.companions-panel .companion-card .companion-favor .favor-value[data-v-0742d52d]{font-size:12px;color:var(--text-accent);min-width:30px;text-align:right}.map-panel .current-location[data-v-0742d52d]{text-align:center;padding:20px;background:var(--bg-secondary);border:1px solid var(--border-color);border-radius:10px;margin-bottom:16px}.map-panel .current-location .location-name[data-v-0742d52d]{font-size:22px;font-weight:bold;color:#a0d0ff;margin-bottom:4px}.map-panel .current-location .location-layer[data-v-0742d52d]{font-size:12px;color:var(--accent-color);margin-bottom:10px}.map-panel .current-location .location-desc[data-v-0742d52d]{font-size:13px;color:var(--text-secondary);line-height:1.5}.map-panel .connections .connections-title[data-v-0742d52d]{font-size:13px;color:var(--text-secondary);margin-bottom:10px}.map-panel .connections .connections-list[data-v-0742d52d]{display:flex;flex-wrap:wrap;gap:8px}.map-panel .connections .connections-list .connection-item[data-v-0742d52d]{padding:6px 12px;background:var(--bg-secondary);border:1px solid;border-radius:15px;font-size:12px;color:var(--text-accent)}.gallery-panel[data-v-0742d52d]{padding:16px !important}.gallery-panel .gallery-container[data-v-0742d52d]{display:flex;flex-direction:row;justify-content:center;gap:20px;overflow-x:auto;overflow-y:hidden;padding-bottom:10px}.gallery-panel .gallery-container[data-v-0742d52d]::-webkit-scrollbar{height:8px}.gallery-panel .gallery-container[data-v-0742d52d]::-webkit-scrollbar-track{background:var(--bg-secondary);border-radius:4px}.gallery-panel .gallery-container[data-v-0742d52d]::-webkit-scrollbar-thumb{background:var(--button-bg);border-radius:4px}.gallery-panel .gallery-container[data-v-0742d52d]::-webkit-scrollbar-thumb:hover{background:var(--button-hover)}.gallery-panel .gallery-card[data-v-0742d52d]{flex-shrink:0;width:280px;aspect-ratio:2/3;perspective:1000px;cursor:pointer}.gallery-panel .card-inner[data-v-0742d52d]{position:relative;width:100%;height:100%;transition:transform .6s ease;transform-style:preserve-3d;border-radius:12px;box-shadow:0 8px 30px rgba(0,0,0,.5)}.gallery-panel .gallery-card.flipped .card-inner[data-v-0742d52d]{transform:rotateY(180deg)}.gallery-panel .card-face[data-v-0742d52d]{position:absolute;width:100%;height:100%;backface-visibility:hidden;border-radius:12px;overflow:hidden;border:2px solid var(--border-color)}.gallery-panel .card-front img[data-v-0742d52d]{width:100%;height:100%;object-fit:cover}.gallery-panel .card-front .card-name-bar[data-v-0742d52d]{position:absolute;bottom:0;left:0;right:0;padding:12px;background:linear-gradient(to top,rgba(0,0,0,0.85),transparent);color:#fff;font-size:16px;font-weight:bold;text-align:center;text-shadow:0 2px 6px rgba(0,0,0,.9)}.gallery-panel .card-back[data-v-0742d52d]{transform:rotateY(180deg);background:linear-gradient(135deg,#1a1a2e 0%,#16213e 100%)}.gallery-panel .card-back .back-content[data-v-0742d52d]{width:100%;height:100%;position:relative}.gallery-panel .card-back .back-content .back-image[data-v-0742d52d]{width:100%;height:100%;object-fit:cover}.gallery-panel .card-back .back-content .back-info-panel[data-v-0742d52d]{position:absolute;bottom:0;left:0;right:0;padding:20px 16px;background:linear-gradient(to top,rgba(0,0,0,0.9) 0%,rgba(0,0,0,0.7) 50%,transparent 100%);text-align:center}.gallery-panel .card-back .back-content .back-info-panel .back-name[data-v-0742d52d]{font-size:18px;font-weight:bold;color:#a0c0ff;margin-bottom:8px;text-shadow:0 0 15px rgba(100,150,255,.6),0 2px 4px rgba(0,0,0,.8)}.gallery-panel .card-back .back-content .back-info-panel .back-text[data-v-0742d52d]{font-size:14px;color:#d0e0f0;line-height:1.6;font-style:italic;text-shadow:0 1px 3px rgba(0,0,0,.8)}.gallery-panel .gallery-card[data-v-0742d52d]::after{content:"点击翻转";position:absolute;top:10px;right:10px;padding:4px 10px;background:rgba(0,0,0,.6);color:#a0b8d0;font-size:11px;border-radius:12px;opacity:0;transition:opacity .3s;pointer-events:none;z-index:10}.gallery-panel .gallery-card[data-v-0742d52d]:hover::after{opacity:1}.gallery-panel .gallery-card.flipped[data-v-0742d52d]::after{content:"点击翻回"}.empty-hint[data-v-0742d52d]{text-align:center;padding:20px;color:#506070;font-style:italic}.footer[data-v-0742d52d]{display:flex;justify-content:space-around;padding:10px 16px;background:var(--footer-bg);border-top:1px solid var(--border-color)}.footer .footer-item[data-v-0742d52d]{display:flex;align-items:center;gap:6px;font-size:12px;color:var(--text-secondary)}.footer .footer-item i[data-v-0742d52d]{color:var(--accent-color)}@keyframes spin-0742d52d{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}

/*# sourceMappingURL=main.css.map*/</style></head><body><div id="app"></div></body>