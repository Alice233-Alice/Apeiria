{"version":3,"file":"index.js","mappings":"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","sources":["src://tavern_helper_template/external var \"z\"","src://tavern_helper_template/src/踏月寻仙-测试版/schema.ts","src://tavern_helper_template/external var \"Vue\"","src://tavern_helper_template/src/踏月寻仙-红颜转阶段人设管理/index.ts"],"sourcesContent":["const __WEBPACK_NAMESPACE_OBJECT__ = z;","// ============================================================================\n// 踏月寻仙 - MVU 变量结构定义 (Zod Schema for MVU Variables)\n// ============================================================================\n// 修炼境界等级与境界描述映射\n// 等级 1-4:   练气（初期、中期、后期、大圆满）\n// 等级 5-8:   筑基（初期、中期、后期、大圆满）\n// 等级 9-12:  金丹（初期、中期、后期、大圆满）\n// 等级 13-16: 元婴（初期、中期、后期、大圆满）\n// 等级 17-20: 化神（初期、中期、后期、大圆满）\n// 等级 21-24: 炼虚（初期、中期、后期、大圆满）\n// 等级 25-28: 合体（初期、中期、后期、大圆满）\n// 等级 29-32: 大乘（初期、中期、后期、大圆满）\n// 等级 33-36: 渡劫（初期、中期、后期、大圆满）\nconst REALM_NAMES = ['练气', '筑基', '金丹', '元婴', '化神', '炼虚', '合体', '大乘', '渡劫'];\nconst REALM_STAGES = ['初期', '中期', '后期', '大圆满'];\n// 修炼境界等级与突破阈值映射\nconst REALM_THRESHOLDS = [100, 100, 100, 100, 200, 200, 200, 200, 400, 400, 400, 400, 800, 800, 800, 800, 1600, 1600, 1600, 1600, 3200, 3200, 3200, 3200, 6400, 6400, 6400, 6400, 12800, 12800, 12800, 12800, 25600, 25600, 25600, 25600];\n// 修炼境界等级与寿元上限映射\nconst REALM_LIFESPANS = [100, 100, 100, 100, 200, 200, 200, 200, 500, 500, 500, 500, 1000, 1000, 1000, 1000, 2000, 2000, 2000, 2000, 5000, 5000, 5000, 5000, 10000, 10000, 10000, 10000, 50000, 50000, 50000, 50000, 100000, 100000, 100000, 100000];\n// 物品 Schema\nconst ItemSchema = z.object({\n    名称: z.string().prefault(''),\n    描述: z.string().prefault(''),\n    品阶: z.string().prefault(''),\n    数量: z.coerce.number().transform(v => Math.max(1, v)).prefault(1), // 默认为 1 且最小为 1，避免被过滤\n});\n// 宗门势力 Schema - 优化版\nconst FactionSchema = z.object({\n    地: z.string().describe('所在地'),\n    特: z.string().describe('核心特点'),\n    力: z.string().describe('最高战力'),\n    营: z.enum(['正', '魔', '中']),\n    模: z.enum(['超大', '大', '小', '微', '特']),\n});\n// 功法 Schema - 优化版\nconst TechniqueSchema = z.object({\n    阶: z.enum(['凡', '黄', '玄', '地', '天', '仙', '圣']),\n    性: z.string().describe('属性'),\n    效: z.string().describe('效果'),\n});\n// 法宝兵器 Schema - 优化版\nconst TreasureSchema = z.object({\n    阶: z.enum(['凡器', '法器', '灵器', '法宝', '灵宝', '仙器', '圣器', '道器']),\n    类: z.string().describe('类型'),\n    特: z.string().describe('特性'),\n});\n// 地点 Schema - 优化版\nconst LocationSchema = z.object({\n    域: z.enum(['天层', '神州', '东苍', '南炎', '西庚', '北冥', '下层', '四海']),\n    类: z.enum(['秘境', '城镇', '宗门', '禁地', '遗迹', '地形']),\n    危: z.coerce.number().transform(v => _.clamp(v, 0, 100)),\n    特: z.string().describe('特点'),\n    资: z.array(z.string()).prefault([]),\n});\n// 灵根 Schema - 优化版\nconst SpiritRootSchema = z.object({\n    质: z.enum(['劣', '下', '中', '上', '极', '天', '异']),\n    性: z.string().describe('属性'),\n    速: z.string().describe('修炼倍率'),\n    特: z.string().describe('特性'),\n    稀: z.enum(['常', '少', '罕', '稀', '传']),\n});\n// 体质 Schema - 优化版\nconst PhysiqueSchema = z.object({\n    质: z.enum(['凡', '灵', '道', '圣', '神']),\n    特: z.string().describe('特性'),\n    优: z.string().describe('优势'),\n    稀: z.enum(['常', '少', '罕', '稀', '传']),\n});\n// 完整的 MVU 变量结构 - 完全参考角色卡示例的结构\nexport const Schema = z.object({\n    世界时钟: z.object({\n        纪元: z.string().prefault('末法时代'),\n        年份: z.coerce.number().prefault(1),\n        月份: z.coerce.number().transform(v => _.clamp(v, 1, 12)).prefault(1),\n        日期: z.coerce.number().transform(v => _.clamp(v, 1, 30)).prefault(1),\n        时辰: z.string().prefault('子时'),\n    }),\n    世界地图: z.record(z.string().describe('区域名'), z.object({\n        layer: z.enum(['天层', '地层', '下层']).prefault('地层'),\n        danger: z.coerce.number().transform(v => _.clamp(v, 0, 100)),\n        desc: z.string().prefault(''),\n        connections: z.array(z.string()).prefault([]),\n    })).prefault({}),\n    世界图志: z.record(z.string().describe('事件名'), z.object({\n        状态: z.string().prefault(''),\n        事件: z.string().prefault(''),\n    })).prefault({}),\n    宗门势力库: z.record(z.string().describe('宗门名'), FactionSchema).prefault({\n        // 正道\n        剑阁: { 地: '神州剑门关', 特: '剑道源头', 力: '渡劫后期', 营: '正', 模: '超大' },\n        万法宗: { 地: '神州问道峰', 特: '万法本源', 力: '渡劫初期', 营: '正', 模: '超大' },\n        金刚寺: { 地: '西天佛山', 特: '佛修炼体', 力: '大乘中期', 营: '正', 模: '大' },\n        药王谷: { 地: '神农架', 特: '医炼丹药', 力: '大乘初期', 营: '正', 模: '大' },\n        儒门: { 地: '文圣山', 特: '浩然正气', 力: '大乘中期', 营: '正', 模: '大' },\n        青龙殿: { 地: '东苍青龙山', 特: '守护青帝', 力: '大乘初期', 营: '正', 模: '大' },\n        玄武宗: { 地: '北冥玄冰山', 特: '镇守归墟', 力: '大乘后期', 营: '正', 模: '大' },\n        建木宗: { 地: '东苍建木树', 特: '木系道法', 力: '合体中期', 营: '正', 模: '小' },\n        百花谷: { 地: '百花秘境', 特: '女修花道', 力: '合体后期', 营: '正', 模: '小' },\n        // 魔道\n        血神教: { 地: '血魔渊', 特: '血道炼法', 力: '渡劫中期', 营: '魔', 模: '超大' },\n        天魔宗: { 地: '天魔山', 特: '天魔大道', 力: '大乘中期', 营: '魔', 模: '大' },\n        // 中立\n        妖盟: { 地: '万妖森林', 特: '妖族联盟', 力: '渡劫中期', 营: '中', 模: '超大' },\n        大夏王朝: { 地: '中州皇城', 特: '世俗统治', 力: '大乘初期', 营: '中', 模: '大' },\n        九州商会: { 地: '九大主城', 特: '商业联盟', 力: '大乘初期', 营: '中', 模: '大' },\n        离火宫: { 地: '南炎火山', 特: '朱雀供奉', 力: '合体圆满', 营: '中', 模: '小' },\n        铸剑山庄: { 地: '南炎地火', 特: '炼器第一', 力: '合体后期', 营: '中', 模: '小' },\n    }),\n    功法库: z.record(z.string().describe('功法名'), TechniqueSchema).prefault({\n        // 基础\n        引气诀: { 阶: '凡', 性: '通用', 效: '基础入门' },\n        五行诀: { 阶: '黄', 性: '五行', 效: '平衡五行' },\n        筑基真解: { 阶: '玄', 性: '通用', 效: '完美筑基' },\n        金丹大道: { 阶: '地', 性: '通用', 效: '凝结金丹' },\n        // 五行系\n        万剑归宗诀: { 阶: '天', 性: '金剑', 效: '剑阁镇宗御万剑' },\n        庚金神雷: { 阶: '天', 性: '金雷', 效: '金雷双修' },\n        百花真经: { 阶: '地', 性: '木', 效: '百花谷以花入道' },\n        建木通天诀: { 阶: '天', 性: '木', 效: '建木宗镇宗' },\n        万木朝宗: { 阶: '仙', 性: '木', 效: '青帝遗留掌控万木' },\n        玄冰诀: { 阶: '地', 性: '水冰', 效: '万法宗心如冰清' },\n        北冥真经: { 阶: '天', 性: '水', 效: '玄武宗吞噬转化' },\n        海纳百川: { 阶: '仙', 性: '水', 效: '归墟容纳万物' },\n        朱雀涅槃经: { 阶: '天', 性: '火', 效: '离火宫涅槃重生' },\n        太阳真火: { 阶: '天', 性: '火', 效: '极致阳火' },\n        祝融神火: { 阶: '仙', 性: '火', 效: '火神遗留' },\n        不动明王身: { 阶: '天', 性: '土佛', 效: '金刚寺防御无敌' },\n        // 特殊\n        九天雷神诀: { 阶: '天', 性: '雷', 效: '代天行罚' },\n        虚空经: { 阶: '天', 性: '空间', 效: '空间属性罕见' },\n        轮回经: { 阶: '仙', 性: '轮回', 效: '{{user}}专属因果重大' },\n        万法归宗: { 阶: '天', 性: '通用', 效: '万法宗模拟万法' },\n        医仙宝典: { 阶: '天', 性: '医道', 效: '药王谷活死人' },\n        天魔策: { 阶: '天', 性: '魔道', 效: '速成隐患大' },\n        斩轮回剑典: { 阶: '仙', 性: '剑轮回', 效: '{{user}}前世斩因果' },\n        剑意通神: { 阶: '仙', 性: '剑道', 效: '意即为剑' },\n    }),\n    法宝库: z.record(z.string().describe('法宝名'), TreasureSchema).prefault({\n        // 剑类\n        青锋剑: { 阶: '法器', 类: '剑', 特: '制式长剑' },\n        秋水剑: { 阶: '灵器', 类: '剑', 特: '水系剑修' },\n        离火剑: { 阶: '法宝', 类: '剑', 特: '火焰剑气' },\n        寒镜剑: { 阶: '法宝', 类: '剑', 特: '映照人心' },\n        红绡枪: { 阶: '法宝', 类: '枪', 特: '破军杀阵' },\n        青龙剑: { 阶: '灵宝', 类: '剑', 特: '青龙魂木性' },\n        白虎剑: { 阶: '灵宝', 类: '剑', 特: '杀伐金性' },\n        朱雀剑: { 阶: '灵宝', 类: '剑', 特: '火焰化形' },\n        玄武剑: { 阶: '灵宝', 类: '剑', 特: '防御水性' },\n        斩轮回: { 阶: '仙器', 类: '剑', 特: '斩因果残破' },\n        镇渊剑: { 阶: '仙器', 类: '剑', 特: '{{user}}本命可成长' },\n        双鱼佩: { 阶: '仙器', 类: '护身', 特: '时空小世界' },\n        // 特殊\n        绯月神弓: { 阶: '法宝', 类: '弓', 特: '朱雀远程' },\n        碧玉瑶琴: { 阶: '法宝', 类: '琴', 特: '治愈心魔' },\n        千丝罗网: { 阶: '灵宝', 类: '法器', 特: '织梦幻术' },\n        雪魄琉璃炉: { 阶: '灵宝', 类: '丹炉', 特: '冰雪炼丹' },\n        龙鳞护甲: { 阶: '灵宝', 类: '防御', 特: '真龙鳞片' },\n        // 储物\n        储物袋: { 阶: '法器', 类: '储物', 特: '基础空间小' },\n        储物戒: { 阶: '灵器', 类: '储物', 特: '空间大便携' },\n        乾坤袋: { 阶: '法宝', 类: '储物', 特: '巨大装活物' },\n        洞天宝: { 阶: '灵宝', 类: '储物', 特: '小世界可居' },\n    }),\n    地点库: z.record(z.string().describe('地点名'), LocationSchema).prefault({\n        // 天层\n        天渊: { 域: '天层', 类: '禁地', 危: 95, 特: '星辰裂隙连域外', 资: ['星辰碎片', '陨铁'] },\n        罡风带: { 域: '天层', 类: '禁地', 危: 90, 特: '罡风元婴难越', 资: ['罡风精华'] },\n        // 神州\n        问道峰: { 域: '神州', 类: '宗门', 危: 10, 特: '万法宗高九千丈', 资: ['功法', '灵药'] },\n        剑门关: { 域: '神州', 类: '宗门', 危: 15, 特: '剑阁悬空天堑', 资: ['剑意', '飞剑'] },\n        藏书阁: { 域: '神州', 类: '宗门', 危: 5, 特: '九层古籍守护灵', 资: ['功法', '秘术'] },\n        酆都城: { 域: '神州', 类: '城镇', 危: 30, 特: '阴阳交汇鬼市', 资: ['幽冥材料'] },\n        龙门瀑: { 域: '神州', 类: '秘境', 危: 40, 特: '鲤鱼跃龙门', 资: ['龙气', '化龙机缘'] },\n        // 东苍\n        建木林: { 域: '东苍', 类: '地形', 危: 50, 特: '原始林古树精', 资: ['灵木', '妖丹'] },\n        青帝陵: { 域: '东苍', 类: '遗迹', 危: 85, 特: '青帝传承考验', 资: ['青帝传承'] },\n        百花境: { 域: '东苍', 类: '秘境', 危: 20, 特: '四季花开', 资: ['灵花', '花粉'] },\n        // 南炎\n        不灭火山: { 域: '南炎', 类: '地形', 危: 80, 特: '朱雀涅槃处', 资: ['朱雀火'] },\n        地火窟: { 域: '南炎', 类: '地形', 危: 60, 特: '地火炼器', 资: ['地心火'] },\n        涅槃台: { 域: '南炎', 类: '遗迹', 危: 70, 特: '涅槃真意', 资: ['涅槃感悟'] },\n        // 西庚\n        万剑冢: { 域: '西庚', 类: '禁地', 危: 85, 特: '战场剑意不散', 资: ['剑意', '古剑'] },\n        庚金脉: { 域: '西庚', 类: '地形', 危: 40, 特: '庚金炼剑', 资: ['庚金'] },\n        // 北冥\n        玄冰山: { 域: '北冥', 类: '宗门', 危: 50, 特: '玄武宗冰山', 资: ['玄冰'] },\n        归墟眼: { 域: '北冥', 类: '禁地', 危: 99, 特: '吞噬万物终结', 资: ['归墟感悟'] },\n        // 下层\n        黄泉迹: { 域: '下层', 类: '遗迹', 危: 90, 特: '天河通幽冥', 资: ['黄泉水'] },\n        炎渊: { 域: '下层', 类: '禁地', 危: 95, 特: '地心火狱', 资: ['地心火'] },\n    }),\n    灵根库: z.record(z.string().describe('灵根名'), SpiritRootSchema).prefault({\n        // 五行天灵根\n        金天根: { 质: '天', 性: '金', 速: '5倍', 特: '锋锐攻击强', 稀: '传' },\n        木天根: { 质: '天', 性: '木', 速: '5倍', 特: '生息恢复强', 稀: '传' },\n        水天根: { 质: '天', 性: '水', 速: '5倍', 特: '包容适应强', 稀: '传' },\n        火天根: { 质: '天', 性: '火', 速: '5倍', 特: '爆发威力大', 稀: '传' },\n        土天根: { 质: '天', 性: '土', 速: '5倍', 特: '厚重防御强', 稀: '传' },\n        // 双灵根\n        金木双根: { 质: '极', 性: '金木', 速: '3倍', 特: '克生特殊法', 稀: '稀' },\n        水火双根: { 质: '极', 性: '水火', 速: '3倍', 特: '既济阴阳和', 稀: '稀' },\n        金火双根: { 质: '极', 性: '金火', 速: '3倍', 特: '炼金器战斗', 稀: '稀' },\n        木水双根: { 质: '极', 性: '木水', 速: '3倍', 特: '水生木恢复', 稀: '稀' },\n        // 多灵根\n        三灵根: { 质: '上', 性: '三系', 速: '2倍', 特: '均衡多功法', 稀: '罕' },\n        四灵根: { 质: '中', 性: '四系', 速: '1倍', 特: '缓慢但全面', 稀: '少' },\n        五行杂根: { 质: '下', 性: '五行', 速: '0.5倍', 特: '杂乱修炼慢', 稀: '常' },\n        // 变异灵根\n        冰根: { 质: '异', 性: '冰', 速: '4倍', 特: '水变极寒冻', 稀: '传' },\n        雷根: { 质: '异', 性: '雷', 速: '4倍', 特: '金变雷霆灭', 稀: '传' },\n        风根: { 质: '异', 性: '风', 速: '4倍', 特: '木变速度快', 稀: '传' },\n        暗根: { 质: '异', 性: '暗', 速: '4倍', 特: '水变幽暗蚀', 稀: '传' },\n        光根: { 质: '异', 性: '光', 速: '4倍', 特: '火变圣光净', 稀: '传' },\n        离火根: { 质: '异', 性: '离火', 速: '4倍', 特: '朱雀涅槃生', 稀: '传' },\n        空间根: { 质: '异', 性: '空间', 速: '5倍', 特: '至高掌空间', 稀: '传' },\n        时间根: { 质: '异', 性: '时间', 速: '5倍', 特: '至高控时间', 稀: '传' },\n        混沌根: { 质: '异', 性: '混沌', 速: '5倍', 特: '至高混沌容', 稀: '传' },\n        轮回根: { 质: '异', 性: '轮回', 速: '5倍', 特: '{{user}}专属', 稀: '传' },\n        // 复合变异\n        冰火双根: { 质: '异', 性: '冰火', 速: '3.5倍', 特: '两极对立统', 稀: '传' },\n        冰雷双根: { 质: '异', 性: '冰雷', 速: '3.5倍', 特: '冻结后粉碎', 稀: '传' },\n        暗幻双根: { 质: '异', 性: '暗幻', 速: '3.5倍', 特: '暗影幻术诡', 稀: '传' },\n        水龙双根: { 质: '异', 性: '水龙', 速: '4倍', 特: '龙脉掌水系', 稀: '传' },\n        冰丹双根: { 质: '异', 性: '冰丹', 速: '3.5倍', 特: '冰丹独特组', 稀: '传' },\n    }),\n    体质库: z.record(z.string().describe('体质名'), PhysiqueSchema).prefault({\n        // 凡体\n        凡体: { 质: '凡', 特: '普通无特殊', 优: '无', 稀: '常' },\n        // 灵体\n        玄冰体: { 质: '灵', 特: '冰系法威+50%抗+80%', 优: '冰系强', 稀: '罕' },\n        离火体: { 质: '灵', 特: '火系法威+50%抗+80%', 优: '火系强', 稀: '罕' },\n        木灵体: { 质: '灵', 特: '恢复+100%木法+50%', 优: '恢复强', 稀: '罕' },\n        天籁体: { 质: '灵', 特: '音律治愈心魔', 优: '音律神通', 稀: '罕' },\n        花妖体: { 质: '灵', 特: '倾城魅惑控花草', 优: '魅惑控制', 稀: '稀' },\n        // 道体\n        朱雀脉: { 质: '道', 特: '火法+100%涅槃生', 优: '涅槃重生', 稀: '传' },\n        真龙脉: { 质: '道', 特: '体质+200%龙神通', 优: '龙族神通', 稀: '传' },\n        战体: { 质: '道', 特: '战力+100%战意厉', 优: '战斗天赋', 稀: '传' },\n        梦魇体: { 质: '道', 特: '操梦幻术情报', 优: '幻术神通', 稀: '传' },\n        雪魂体: { 质: '道', 特: '冰法+150%雪神通', 优: '冰系至强', 稀: '传' },\n        // 圣体\n        混沌体: { 质: '圣', 特: '修任何法无限制', 优: '包容万物', 稀: '传' },\n        道体: { 质: '圣', 特: '悟+300%速+200%', 优: '悟性无双', 稀: '传' },\n        金身: { 质: '圣', 特: '防+500%几乎不死', 优: '防御无敌', 稀: '传' },\n        // 神体\n        轮回体: { 质: '神', 特: '{{user}}专属轮回通', 优: '斩因果', 稀: '传' },\n        时空体: { 质: '神', 特: '时空通逆因果', 优: '时空神通', 稀: '传' },\n    }),\n    本尊: z\n        .object({\n        等级: z.coerce.number().transform(v => _.clamp(v, 1, 36)),\n        修为: z.coerce.number().transform(v => Math.max(0, v)),\n        灵根: z.string().prefault('五行杂灵根'),\n        体质: z.string().prefault('凡体'),\n        功法: z.string().prefault('无'),\n        本命兵器: z.string().prefault('无'),\n        神通列表: z.record(z.string().describe('神通名'), z.string().describe('神通描述')).prefault({}),\n        灵石: z.coerce.number().transform(v => Math.max(0, v)),\n        已活岁月: z.coerce.number().transform(v => Math.max(0, v)),\n        尝试突破: z.boolean().prefault(false),\n        行踪: z.object({\n            当前区域: z.string().prefault('未知之地'),\n            所属层级: z.string().optional(),\n            环境描述: z.string().optional(),\n            危险度: z.coerce.number().optional(),\n            可用通道: z.array(z.string()).optional(),\n            导航信息: z.string().optional(),\n        }),\n        身份: z.object({\n            姓名: z.string().prefault('无名氏'),\n            宗门: z.string().prefault('散修'),\n            出身: z.string().prefault('凡人'),\n        }),\n        背包: z\n            .record(z.string().describe('物品名'), ItemSchema)\n            .prefault({})\n            .transform(data => _.pickBy(data, ({ 数量 }) => 数量 > 0)),\n        法宝: z\n            .record(z.string().describe('法宝名'), ItemSchema)\n            .prefault({})\n            .transform(data => _.pickBy(data, ({ 数量 }) => 数量 > 0)),\n        杂物袋: z\n            .record(z.string().describe('杂物名'), ItemSchema)\n            .prefault({})\n            .transform(data => _.pickBy(data, ({ 数量 }) => 数量 > 0)),\n    })\n        .transform(data => {\n        const level = data.等级;\n        const 突破阈值 = REALM_THRESHOLDS[level - 1] ?? 100;\n        const 寿元上限 = REALM_LIFESPANS[level - 1] ?? 100;\n        const majorIdx = Math.floor((level - 1) / 4);\n        const minorIdx = (level - 1) % 4;\n        const 境界描述 = `${REALM_NAMES[majorIdx] ?? '练气'}${REALM_STAGES[minorIdx] ?? '初期'}`;\n        const 寿元状态 = `${data.已活岁月}/${寿元上限}`;\n        const 状态 = data.尝试突破 ? '突破中' : data.修为 >= 突破阈值 ? '瓶颈期' : '修炼中';\n        const 进度 = `${((data.修为 / 突破阈值) * 100).toFixed(1)}%`;\n        return {\n            ...data,\n            突破阈值,\n            寿元上限,\n            境界描述,\n            寿元状态,\n            状态,\n            进度,\n        };\n    }),\n    红颜角色库: z.record(z.string().describe('角色名'), z.object({\n        级: z.coerce.number().transform(v => _.clamp(v, 1, 36)),\n        根: z.string().describe('灵根'),\n        质: z.string().describe('体质'),\n        龄: z.string().describe('年龄'),\n        属: z.string().describe('所属'),\n        法: z.string().describe('功法'),\n        器: z.string().describe('本命兵器'),\n        通: z.array(z.string()).prefault([]),\n        型: z.enum(['核心', '重要', '次要']),\n    })).prefault({\n        凌寒镜: { 级: 11, 根: '冰根极', 质: '玄冰体', 龄: '24', 属: '万法宗真传', 法: '玄冰诀地/心镜天', 器: '北冥弓灵', 通: ['冰镜映心', '千里冰封'], 型: '核心' },\n        虞汐颜: { 级: 12, 根: '水阴阳异', 质: '双鱼体', 龄: '化形3年', 属: '{{user}}玉佩', 法: '双生天极/阴阳', 器: '双鱼佩本体', 通: ['枯木春', '夺命妆', '双鱼梦'], 型: '核心' },\n        白清弦: { 级: 29, 根: '金天根', 质: '剑体', 龄: '外30实328', 属: '散修剑宗师', 法: '剑意仙/天音天', 器: '清弦琴剑灵宝', 通: ['琴剑杀', '剑意歌', '万剑心'], 型: '核心' },\n        焰绯月: { 级: 12, 根: '离火根极', 质: '朱雀脉', 龄: '25', 属: '离火宫圣女', 法: '朱雀天', 器: '绯月弓法宝', 通: ['离火天', '朱雀身', '凤凰槃'], 型: '重要' },\n        幻千丝: { 级: 13, 根: '暗幻双根', 质: '梦魇体', 龄: '外20未知', 属: '散修幽冥', 法: '织梦天', 器: '千丝网灵宝', 通: ['织梦笼', '心魔境', '千丝缚'], 型: '重要' },\n        花想容: { 级: 8, 根: '木根', 质: '花妖体', 龄: '外12', 属: '建木宗', 法: '百花地', 器: '牡丹瓣', 通: ['花海域', '治愈粉', '魅惑香'], 型: '次要' },\n        敖清霜: { 级: 14, 根: '水龙双根', 质: '真龙脉', 龄: '外20实150', 属: '龙宫三公主', 法: '沧海天', 器: '龙鳞甲灵宝', 通: ['龙变化', '呼风雨', '龙威慑'], 型: '次要' },\n    }),\n    红颜: z\n        .record(z.string().describe('红颜名'), z\n        .object({\n        等级: z.coerce.number().transform(v => _.clamp(v, 1, 36)).prefault(1),\n        修为: z.coerce.number().transform(v => Math.max(0, v)).prefault(0),\n        灵根: z.string().prefault('五行杂灵根'),\n        体质: z.string().prefault('凡体'),\n        功法: z.string().prefault('无'),\n        本命兵器: z.string().prefault('无'),\n        神通列表: z.record(z.string().describe('神通名'), z.string().describe('神通描述')).prefault({}),\n        灵石: z.coerce.number().transform(v => Math.max(0, v)).prefault(0),\n        已活岁月: z.coerce.number().transform(v => Math.max(0, v)).prefault(0),\n        尝试突破: z.boolean().prefault(false),\n        好感度: z.coerce.number().transform(v => _.clamp(v, -100, 100)).prefault(0),\n        关系: z.string().prefault('陌生人'),\n        重要性: z.string().prefault('路人'),\n    })\n        .transform(data => {\n        const level = data.等级;\n        const 突破阈值 = REALM_THRESHOLDS[level - 1] ?? 100;\n        const 寿元上限 = REALM_LIFESPANS[level - 1] ?? 100;\n        const majorIdx = Math.floor((level - 1) / 4);\n        const minorIdx = (level - 1) % 4;\n        const 境界描述 = `${REALM_NAMES[majorIdx] ?? '练气'}${REALM_STAGES[minorIdx] ?? '初期'}`;\n        const 寿元状态 = `${data.已活岁月}/${寿元上限}`;\n        const 状态 = data.尝试突破 ? '突破中' : data.修为 >= 突破阈值 ? '瓶颈期' : '修炼中';\n        const 进度 = `${((data.修为 / 突破阈值) * 100).toFixed(1)}%`;\n        return {\n            ...data,\n            突破阈值,\n            寿元上限,\n            境界描述,\n            寿元状态,\n            状态,\n            进度,\n        };\n    }))\n        .prefault({}),\n    NPC图鉴: z.record(z.string().describe('NPC名'), z.object({\n        等级: z.coerce.number().transform(v => _.clamp(v, 1, 36)).prefault(1),\n        修为: z.coerce.number().transform(v => Math.max(0, v)).prefault(0),\n        灵根: z.string().prefault('五行杂灵根'),\n        体质: z.string().prefault('凡体'),\n        功法: z.string().prefault('无'),\n        本命兵器: z.string().prefault('无'),\n        神通列表: z.record(z.string().describe('神通名'), z.string().describe('神通描述')).prefault({}),\n        灵石: z.coerce.number().transform(v => Math.max(0, v)).prefault(0),\n        已活岁月: z.coerce.number().transform(v => Math.max(0, v)).prefault(0),\n        尝试突破: z.boolean().prefault(false),\n        所在宗门: z.string().prefault('散修'),\n    })).prefault({}),\n    任务列表: z.record(z.string().describe('任务名'), z.object({\n        类型: z.enum(['主线', '支线', '每日', '临危受命']),\n        说明: z.string().describe('面向{{user}}的任务背景或细则'),\n        目标: z.string().describe('明确可执行的目标描述'),\n        奖励: z.string(),\n        惩罚: z.string().describe('失败后触发的负面效果'),\n        状态: z.enum(['进行中', '已完成', '已失败']).prefault('进行中'),\n    })).prefault({}),\n    声望系统: z.record(z.string().describe('势力名'), z.object({\n        声望值: z.coerce.number().transform(v => _.clamp(v, -100, 100)),\n        称号: z.string().optional(),\n        关系描述: z.string(),\n    })).prefault({}),\n});\n// 配置常量\nexport const CONFIG = {\n    REALMS: {\n        MAJOR: REALM_NAMES,\n        MINOR: REALM_STAGES,\n    },\n    ELEMENTS: {\n        火: { effect: '灼烧', visual: '烈焰', nature: '爆裂', color: '#ff4444' },\n        水: { effect: '缠绕', visual: '激流', nature: '柔韧', color: '#4488ff' },\n        冰: { effect: '冻结', visual: '寒霜', nature: '极寒', color: '#88ddff' },\n        雷: { effect: '麻痹', visual: '紫电', nature: '狂暴', color: '#aa44ff' },\n        风: { effect: '切割', visual: '罡风', nature: '无形', color: '#88ff88' },\n        土: { effect: '镇压', visual: '岩铠', nature: '厚重', color: '#aa8844' },\n        木: { effect: '寄生', visual: '藤蔓', nature: '生生不息', color: '#44aa44' },\n        金: { effect: '穿透', visual: '锐金', nature: '锋利', color: '#ffdd44' },\n        暗: { effect: '腐蚀', visual: '黑雾', nature: '诡谲', color: '#442244' },\n        光: { effect: '净化', visual: '圣辉', nature: '神圣', color: '#ffffaa' },\n        混沌: { effect: '湮灭', visual: '灰光', nature: '虚无', color: '#888888' },\n    },\n};\n// 获取灵根元素颜色\nexport function getRootColor(root) {\n    for (const [elem, data] of Object.entries(CONFIG.ELEMENTS)) {\n        if (root.includes(elem)) {\n            return data.color;\n        }\n    }\n    return '#aaaaaa'; // 默认灰色\n}\n// 获取境界等级颜色\nexport function getRealmColor(level) {\n    const majorIdx = Math.floor((level - 1) / 4);\n    const colors = [\n        '#888888', // 练气 - 灰色\n        '#44aa44', // 筑基 - 绿色\n        '#4488ff', // 金丹 - 蓝色\n        '#aa44ff', // 元婴 - 紫色\n        '#ff4444', // 化神 - 红色\n        '#ffaa00', // 炼虚 - 橙色\n        '#ffdd44', // 合体 - 金色\n        '#ffffff', // 大乘 - 白色\n        '#ff88ff', // 渡劫 - 粉色\n    ];\n    return colors[majorIdx] || '#888888';\n}\n// 获取危险度颜色\nexport function getDangerColor(danger) {\n    if (danger >= 90)\n        return '#ff0000';\n    if (danger >= 70)\n        return '#ff4400';\n    if (danger >= 50)\n        return '#ff8800';\n    if (danger >= 30)\n        return '#ffcc00';\n    return '#44aa44';\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = Vue;","// ============================================================================\n// 红颜转阶段人设管理脚本 - 根据好感度自动切换世界书条目\n// \n// 功能：自动根据红颜角色的好感度值，启用/禁用对应阶段的世界书条目\n// 优势：世界书只需写基础设定 + 各阶段人设，脚本自动管理切换\n// ============================================================================\nimport { Schema } from '../踏月寻仙-测试版/schema';\n// ============================================================================\n// 配置项\n// ============================================================================\nconst CONFIG = {\n    // 要管理的世界书名称\n    WORLDBOOK_NAME: 'current', // 'current' 表示当前角色卡的主世界书\n    // 是否启用调试日志\n    DEBUG: true,\n    // 好感度阶段划分\n    FAVOR_STAGES: {\n        陌生期: { min: -20, max: 20 },\n        好感期: { min: 21, max: 40 },\n        心动期: { min: 41, max: 60 },\n        确认期: { min: 61, max: 80 },\n        深爱期: { min: 81, max: 100 },\n    },\n};\nconst CHARACTERS = [\n    {\n        name: '凌寒镜',\n        enabled: true,\n        // 匹配模式: [角色] 凌寒镜 - 陌生期 / 好感期 / 心动期 / 确认期 / 深爱期\n        entryPattern: /^\\[角色\\]\\s*凌寒镜\\s*-\\s*(陌生期|好感期|心动期|确认期|深爱期)/,\n    },\n    {\n        name: '苏雪魄',\n        enabled: true,\n        entryPattern: /^\\[角色\\]\\s*苏雪魄\\s*-\\s*(陌生期|好感期|心动期|确认期|深爱期)/,\n    },\n    {\n        name: '叶挽歌',\n        enabled: true,\n        entryPattern: /^\\[角色\\]\\s*叶挽歌\\s*-\\s*(陌生期|好感期|心动期|确认期|深爱期)/,\n    },\n    {\n        name: '焰绯月',\n        enabled: true,\n        entryPattern: /^\\[角色\\]\\s*焰绯月\\s*-\\s*(陌生期|好感期|心动期|确认期|深爱期)/,\n    },\n    {\n        name: '白清弦',\n        enabled: true,\n        entryPattern: /^\\[角色\\]\\s*白清弦\\s*-\\s*(陌生期|好感期|心动期|确认期|深爱期)/,\n    },\n    {\n        name: '幻千丝',\n        enabled: true,\n        entryPattern: /^\\[角色\\]\\s*幻千丝\\s*-\\s*(陌生期|好感期|心动期|确认期|深爱期)/,\n    },\n    {\n        name: '花想容',\n        enabled: true,\n        entryPattern: /^\\[角色\\]\\s*花想容\\s*-\\s*(陌生期|好感期|心动期|确认期|深爱期)/,\n    },\n    {\n        name: '敖清霜',\n        enabled: true,\n        entryPattern: /^\\[角色\\]\\s*敖清霜\\s*-\\s*(陌生期|好感期|心动期|确认期|深爱期)/,\n    },\n];\n// ============================================================================\n// 核心逻辑\n// ============================================================================\n/**\n * 获取角色当前所处的好感度阶段\n */\nfunction getFavorStage(favor) {\n    for (const [stage, range] of Object.entries(CONFIG.FAVOR_STAGES)) {\n        if (favor >= range.min && favor <= range.max) {\n            return stage;\n        }\n    }\n    return null;\n}\n/**\n * 从条目名中提取阶段名\n */\nfunction extractStageFromEntry(entryName) {\n    for (const stage of Object.keys(CONFIG.FAVOR_STAGES)) {\n        if (entryName.includes(stage)) {\n            return stage;\n        }\n    }\n    return null;\n}\n/**\n * 获取 MVU 数据\n */\nasync function getMvuData() {\n    try {\n        await waitGlobalInitialized('Mvu');\n        const variables = getVariables({ type: 'message', message_id: -1 });\n        const statData = _.get(variables, 'stat_data', null);\n        if (statData) {\n            return Schema.parse(statData);\n        }\n    }\n    catch (e) {\n        if (CONFIG.DEBUG) {\n            console.warn('[红颜转阶段] 无法获取 MVU 数据', e);\n        }\n    }\n    return null;\n}\n/**\n * 更新世界书条目状态\n */\nasync function updateWorldbookEntries() {\n    try {\n        const mvuData = await getMvuData();\n        if (!mvuData) {\n            if (CONFIG.DEBUG) {\n                console.warn('[红颜转阶段] MVU 数据不可用，跳过更新');\n            }\n            return;\n        }\n        // 获取世界书名称\n        let worldbookName = CONFIG.WORLDBOOK_NAME;\n        if (worldbookName === 'current') {\n            const charWorldbooks = getCharWorldbookNames('current');\n            worldbookName = charWorldbooks.primary || '';\n            if (!worldbookName) {\n                if (CONFIG.DEBUG) {\n                    console.warn('[红颜转阶段] 当前角色卡没有绑定主世界书');\n                }\n                return;\n            }\n        }\n        let enabledCount = 0;\n        let disabledCount = 0;\n        // 使用 updateWorldbookWith 更新世界书\n        await updateWorldbookWith(worldbookName, worldbook => {\n            for (const character of CHARACTERS) {\n                if (!character.enabled)\n                    continue;\n                // 获取角色好感度\n                const favor = mvuData.红颜?.[character.name]?.好感度 ?? 0;\n                const currentStage = getFavorStage(favor);\n                if (!currentStage) {\n                    if (CONFIG.DEBUG) {\n                        console.warn(`[红颜转阶段] 角色 ${character.name} 好感度 ${favor} 不在任何阶段范围内`);\n                    }\n                    continue;\n                }\n                // 遍历世界书条目，找到该角色的阶段条目\n                for (const entry of worldbook) {\n                    if (!entry.enabled)\n                        continue;\n                    const entryName = entry.name || '';\n                    const matches = character.entryPattern.test(entryName);\n                    if (matches) {\n                        const entryStage = extractStageFromEntry(entryName);\n                        if (!entryStage)\n                            continue;\n                        const shouldBeConstant = entryStage === currentStage;\n                        const wasConstant = entry.strategy.type === 'constant';\n                        if (shouldBeConstant && !wasConstant) {\n                            entry.strategy.type = 'constant';\n                            enabledCount++;\n                            if (CONFIG.DEBUG) {\n                                console.log(`[红颜转阶段] ✅ 启用: ${character.name} - ${entryStage} (好感度: ${favor})`);\n                            }\n                        }\n                        else if (!shouldBeConstant && wasConstant) {\n                            entry.strategy.type = 'selective';\n                            disabledCount++;\n                            if (CONFIG.DEBUG) {\n                                console.log(`[红颜转阶段] ❌ 改为绿灯: ${character.name} - ${entryStage}`);\n                            }\n                        }\n                    }\n                }\n            }\n            return worldbook;\n        });\n        if (CONFIG.DEBUG && (enabledCount > 0 || disabledCount > 0)) {\n            console.info(`[红颜转阶段] 更新完成: 启用蓝灯 ${enabledCount} 个, 改为绿灯 ${disabledCount} 个`);\n        }\n    }\n    catch (e) {\n        console.error('[红颜转阶段] 更新失败', e);\n    }\n}\n/**\n * 自动更新\"关系\"字段（可选功能）\n * @param message_id 要更新的楼层ID，默认为最后一楼\n */\nasync function updateRelationFields(message_id = -1) {\n    try {\n        await waitGlobalInitialized('Mvu');\n        const variables = getVariables({ type: 'message', message_id });\n        const statData = _.get(variables, 'stat_data', null);\n        // 如果 stat_data 不存在（如用户输入楼层），直接跳过\n        if (!statData || typeof statData !== 'object') {\n            if (CONFIG.DEBUG) {\n                console.log(`[红颜转阶段] 楼层 ${message_id} 没有 stat_data，跳过关系更新`);\n            }\n            return;\n        }\n        let updated = false;\n        for (const character of CHARACTERS) {\n            if (!character.enabled)\n                continue;\n            const favor = _.get(statData, `红颜.${character.name}.好感度`, 0);\n            const currentStage = getFavorStage(favor);\n            if (!currentStage)\n                continue;\n            // 根据阶段设置关系描述（可自定义）\n            const relationMap = {\n                陌生期: '陌生人',\n                好感期: '朋友',\n                心动期: '暗生情愫',\n                确认期: '情侣',\n                深爱期: '至爱',\n            };\n            const newRelation = relationMap[currentStage] || '陌生人';\n            const currentRelation = _.get(statData, `红颜.${character.name}.关系`, '');\n            if (currentRelation !== newRelation) {\n                _.set(statData, `红颜.${character.name}.关系`, newRelation);\n                updated = true;\n                if (CONFIG.DEBUG) {\n                    console.log(`[红颜转阶段] 📝 更新关系: ${character.name} \"${currentRelation}\" → \"${newRelation}\" (楼层 ${message_id})`);\n                }\n            }\n        }\n        if (updated) {\n            // 使用 updateVariablesWith 而不是 replaceVariables，只更新 stat_data 字段\n            updateVariablesWith(vars => {\n                _.set(vars, 'stat_data', statData);\n                return vars;\n            }, { type: 'message', message_id });\n        }\n    }\n    catch (e) {\n        console.error('[红颜转阶段] 更新关系字段失败', e);\n    }\n}\n// ============================================================================\n// 纯爱基调守护功能（合并）\n// ============================================================================\n/**\n * 纯爱基调守护 - 防止NTR和关系倒退\n */\nfunction protectPureLoveTheme(new_variables, old_variables) {\n    // 检查是否有 stat_data\n    const new_stat_data = _.get(new_variables, 'stat_data');\n    const old_stat_data = _.get(old_variables, 'stat_data');\n    if (!new_stat_data || !old_stat_data) {\n        if (CONFIG.DEBUG) {\n            console.log('[纯爱守护] stat_data 不存在，跳过守护');\n        }\n        return;\n    }\n    try {\n        const new_data = Schema.parse(new_stat_data);\n        const old_data = Schema.parse(old_stat_data);\n        // ========== 红颜关系保护 ==========\n        // 1. 好感度只能增加不能减少（除非明确的负面事件）\n        _.forEach(new_data.红颜, (new_heroine, name) => {\n            const old_heroine = _.get(old_data.红颜, name);\n            if (old_heroine) {\n                // 如果好感度下降超过阈值（排除正常波动），恢复为旧值\n                if (new_heroine.好感度 < old_heroine.好感度 - 5) {\n                    console.warn(`[纯爱守护] 检测到${name}好感度异常下降，已阻止`);\n                    // 只在红颜存在时才修改\n                    if (_.has(new_stat_data, `红颜.${name}.好感度`)) {\n                        _.set(new_stat_data, `红颜.${name}.好感度`, old_heroine.好感度);\n                    }\n                }\n                // 关系不能倒退\n                const relationshipLevels = ['陌生人', '相识', '朋友', '知己', '暧昧', '道侣', '挚爱'];\n                const oldLevel = relationshipLevels.indexOf(old_heroine.关系);\n                const newLevel = relationshipLevels.indexOf(new_heroine.关系);\n                if (oldLevel > 0 && newLevel >= 0 && newLevel < oldLevel) {\n                    console.warn(`[纯爱守护] 检测到${name}关系倒退，已阻止`);\n                    // 只在关系字段存在时才修改\n                    if (_.has(new_stat_data, `红颜.${name}.关系`)) {\n                        _.set(new_stat_data, `红颜.${name}.关系`, old_heroine.关系);\n                    }\n                }\n            }\n        });\n        // 2. 检查是否有红颜被删除（除非角色死亡等合理情况）\n        _.forEach(old_data.红颜, (old_heroine, name) => {\n            if (!_.has(new_data.红颜, name)) {\n                // 检查是否在NPC图鉴中（可能是转移）\n                if (!_.has(new_data.NPC图鉴, name)) {\n                    console.warn(`[纯爱守护] 检测到红颜${name}被删除，已恢复`);\n                    // 确保红颜对象存在后再添加\n                    if (!_.has(new_stat_data, '红颜')) {\n                        _.set(new_stat_data, '红颜', {});\n                    }\n                    _.set(new_stat_data, `红颜.${name}`, old_heroine);\n                }\n            }\n        });\n        // ========== NPC质量控制 ==========\n        // 检查新增NPC的合理性\n        _.forEach(new_data.NPC图鉴, (npc, name) => {\n            const old_npc = _.get(old_data.NPC图鉴, name);\n            // 如果是新增NPC，检查是否符合世界观设定\n            if (!old_npc && CONFIG.DEBUG) {\n                console.info(`[纯爱守护] 新增NPC: ${name}, 所在宗门: ${npc.所在宗门}`);\n            }\n        });\n        // ========== 世界基调维护 ==========\n        // 统计红颜数量和关系状态\n        if (CONFIG.DEBUG) {\n            const heroineCount = _.size(new_data.红颜);\n            const closeRelations = _.filter(new_data.红颜, h => ['知己', '暧昧', '道侣', '挚爱'].includes(h.关系)).length;\n            if (heroineCount > 0) {\n                console.info(`[纯爱守护] 当前红颜数: ${heroineCount}, 亲密关系: ${closeRelations}`);\n            }\n        }\n    }\n    catch (e) {\n        console.error('[纯爱守护] Schema 解析失败，跳过守护', e);\n    }\n}\n// ============================================================================\n// 初始化\n// ============================================================================\n$(() => {\n    errorCatched(async () => {\n        console.info('[红颜转阶段] 脚本已加载（含纯爱基调守护）');\n        // 等待 MVU 初始化\n        await waitGlobalInitialized('Mvu');\n        // 初始检查\n        await updateWorldbookEntries();\n        await updateRelationFields();\n        // 监听消息接收事件\n        eventOn(tavern_events.MESSAGE_RECEIVED, async () => {\n            await updateWorldbookEntries();\n            await updateRelationFields();\n        });\n        // 监听消息发送事件\n        eventOn(tavern_events.MESSAGE_SENT, async () => {\n            await updateWorldbookEntries();\n            await updateRelationFields();\n        });\n        // 监听 MVU 变量更新 - VARIABLE_UPDATE_ENDED 只有 2 个参数\n        eventOn(Mvu.events.VARIABLE_UPDATE_ENDED, async (new_variables, old_variables) => {\n            if (CONFIG.DEBUG) {\n                console.info(`[红颜转阶段] MVU 变量更新事件触发`);\n            }\n            // 纯爱基调守护（所有楼层都执行）\n            protectPureLoveTheme(new_variables, old_variables);\n            // 触发世界书和关系更新（默认更新最后一楼）\n            await updateWorldbookEntries();\n            await updateRelationFields(-1); // -1 表示最后一楼\n        });\n        console.info('[红颜转阶段] 监听器已设置，将自动管理红颜阶段切换并守护纯爱基调');\n        toastr.success('红颜转阶段管理已启用（含纯爱守护）', '踏月寻仙');\n    })();\n});\n"],"names":["z","REALM_NAMES","REALM_STAGES","REALM_THRESHOLDS","REALM_LIFESPANS","ItemSchema","object","string","prefault","coerce","number","transform","v","Math","max","FactionSchema","describe","enum","TechniqueSchema","TreasureSchema","LocationSchema","_","clamp","array","SpiritRootSchema","PhysiqueSchema","Schema","record","layer","danger","desc","connections","boolean","optional","data","pickBy","level","majorIdx","floor","toFixed","Vue","min","CHARACTERS","name","enabled","entryPattern","getFavorStage","favor","stage","range","Object","entries","extractStageFromEntry","entryName","keys","includes","async","updateWorldbookEntries","mvuData","waitGlobalInitialized","variables","getVariables","type","message_id","statData","get","parse","e","console","warn","getMvuData","worldbookName","getCharWorldbookNames","primary","enabledCount","disabledCount","updateWorldbookWith","worldbook","character","currentStage","entry","test","entryStage","shouldBeConstant","wasConstant","strategy","log","info","error","updateRelationFields","updated","newRelation","currentRelation","set","updateVariablesWith","vars","$","errorCatched","eventOn","tavern_events","MESSAGE_RECEIVED","MESSAGE_SENT","Mvu","events","VARIABLE_UPDATE_ENDED","new_variables","old_variables","new_stat_data","old_stat_data","new_data","old_data","forEach","new_heroine","old_heroine","has","relationshipLevels","oldLevel","indexOf","newLevel","npc","heroineCount","size","closeRelations","filter","h","length","protectPureLoveTheme","toastr","success"],"ignoreList":[],"sourceRoot":""}