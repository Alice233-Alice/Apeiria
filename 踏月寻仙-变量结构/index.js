import{registerMvuSchema as r}from'https://testingcf.jsdelivr.net/gh/StageDog/tavern_resource/dist/util/mvu_zod.js';const e=z,t=['练气','筑基','金丹','元婴','化神','炼虚','合体','大乘','渡劫'],n=['初期','中期','后期','大圆满'],a=[100,200,300,400,500,600,700,800,900,1e3,1100,1200,2400,2400,2400,2400,4800,4800,4800,4800,9600,9600,9600,9600,19200,19200,19200,19200,38400,38400,38400,38400,76800,76800,76800,76800],s=[100,100,100,100,200,200,200,200,500,500,500,500,1e3,1e3,1e3,1e3,2e3,2e3,2e3,2e3,5e3,5e3,5e3,5e3,1e4,1e4,1e4,1e4,5e4,5e4,5e4,5e4,1e5,1e5,1e5,1e5];const u={凡:'凡',凡阶:'凡',凡级:'凡',凡品:'凡',黄:'黄',黄阶:'黄',黄级:'黄',黄品:'黄',玄:'玄',玄阶:'玄',玄级:'玄',玄品:'玄',地:'地',地阶:'地',地级:'地',地品:'地',天:'天',天阶:'天',天级:'天',天品:'天',仙:'仙',仙阶:'仙',仙级:'仙',仙品:'仙',圣:'圣',圣阶:'圣',圣级:'圣',圣品:'圣',先天:'先天',先天阶:'先天',先天级:'先天'},c={入门:'入门',初级:'入门',初学:'入门',新手:'入门',熟练:'熟练',中级:'熟练',娴熟:'熟练',精通:'精通',高级:'精通',精湛:'精通',大成:'大成',大师:'大成',宗师:'大成',圆满:'圆满',完美:'圆满',极致:'圆满',化境:'化境',化神:'化境',返璞归真:'化境',出神入化:'化境'},o=e.z.object({名称:e.z.string().prefault(''),描述:e.z.string().prefault(''),品阶:e.z.string().prefault(''),数量:e.z.coerce.number().transform(r=>Math.max(0,r)).prefault(1)}),f=e.z.object({名称:e.z.string().prefault(''),描述:e.z.string().prefault(''),类型:e.z.enum(['功法','神通','秘术']).prefault('神通'),品阶:e.z.string().transform(r=>u[r]||'凡').catch('凡'),熟练度:e.z.string().transform(r=>c[r]||'入门').catch('入门'),领悟时间:e.z.coerce.number().catch(()=>Date.now()),威力等级:e.z.coerce.number().optional()}).transform(r=>{if(!r.威力等级||0===r.威力等级){const e={入门:1,熟练:2,精通:3,大成:4,圆满:5,化境:6},t={凡:1,黄:2,玄:3,地:4,天:5,仙:6,圣:7,先天:8}[r.品阶]||1,n=e[r.熟练度]||1;return{...r,威力等级:10*t+n}}return r}),i=e.z.record(e.z.string().describe('物品名'),o).prefault({}).transform(r=>_.pickBy(r,({数量:r})=>r>0));function l(r,e=!1){const u=r.等级,c=a[u-1]??100,o=s[u-1]??100,f=Math.floor((u-1)/4),i={突破阈值:c,寿元上限:o,境界描述:`${t[f]??'练气'}${n[(u-1)%4]??'初期'}`,寿元状态:`${r.已活岁月}/${o}`,状态:r.尝试突破?'突破中':r.修为>=c?'瓶颈期':'修炼中',进度:`${(r.修为/c*100).toFixed(1)}%`};if(!e)return i;const l=function(r){const e=Math.floor((r-1)/4),t=(r-1)%4,n=Math.pow(10,e+1),a=.2*n*t;return Math.round(n+a)}(u),p=Object.values(r.神通列表||{}),m=l+(p.length>0?Math.max(...p.map(r=>r.威力等级||0)):0)+(()=>{const e=r.体质||'';return e.includes('神')?500:e.includes('圣')?200:e.includes('道')?100:e.includes('灵')?50:0})();return{...i,战力值:m}}const p=e.z.object({级:e.z.coerce.number().transform(r=>_.clamp(r,1,36)),根:e.z.string().describe('灵根'),质:e.z.string().describe('体质'),龄:e.z.string().describe('年龄'),属:e.z.string().describe('所属'),法:e.z.string().describe('功法'),器:e.z.string().describe('本命兵器'),通:e.z.array(e.z.string()).prefault([])}),m=e.z.object({等级:e.z.coerce.number().transform(r=>_.clamp(r,1,36)).prefault(1),修为:e.z.coerce.number().transform(r=>Math.max(0,r)).prefault(0),灵根:e.z.string().prefault('五行杂灵根'),体质:e.z.string().prefault('凡体'),功法:e.z.string().prefault('无'),本命兵器:e.z.string().prefault('无'),神通列表:e.z.record(e.z.string().describe('神通名'),f).prefault({}),灵石:e.z.coerce.number().transform(r=>Math.max(0,r)).prefault(0),已活岁月:e.z.coerce.number().transform(r=>Math.max(0,r)).prefault(0),尝试突破:e.z.boolean().prefault(!1),好感度:e.z.coerce.number().transform(r=>_.clamp(r,-100,100)).prefault(0),关系:e.z.string().prefault('陌生人'),重要性:e.z.string().prefault('路人')}).prefault({等级:1,修为:0,灵根:'五行杂灵根',体质:'凡体',功法:'无',本命兵器:'无',神通列表:{},灵石:0,已活岁月:0,尝试突破:!1,好感度:0,关系:'陌生人',重要性:'路人'}).transform(r=>{const e=l(r,!1);return{...r,...e}}),g=e.z.object({等级:e.z.coerce.number().transform(r=>_.clamp(r,1,36)).prefault(1),所在宗门:e.z.string().prefault('散修'),备注:e.z.string().prefault('')}),b={非战斗:'非战斗',和平:'非战斗',安全:'非战斗',脱战:'非战斗',对峙:'对峙',警戒:'对峙',僵持:'对峙',对视:'对峙',激战:'激战',战斗:'激战',交战:'激战',厮杀:'激战',重伤:'重伤',负伤:'重伤',伤重:'重伤',濒死:'濒死',将死:'濒死',垂危:'濒死',危急:'濒死'},d={无伤:'无伤',无:'无伤',完好:'无伤',健康:'无伤',轻伤:'轻伤',小伤:'轻伤',微伤:'轻伤',重伤:'重伤',伤重:'重伤',大伤:'重伤',濒死:'濒死',将死:'濒死',垂危:'濒死'},j={碾压:'碾压',压倒:'碾压',秒杀:'碾压',吊打:'碾压',优势:'优势',占优:'优势',上风:'优势',有利:'优势',势均力敌:'势均力敌',均势:'势均力敌',平手:'势均力敌',相当:'势均力敌',旗鼓相当:'势均力敌',劣势:'劣势',下风:'劣势',不利:'劣势',落后:'劣势',绝望:'绝望',必死:'绝望',碾压劣势:'绝望',无望:'绝望'},h={完好:'完好',无伤:'完好',健康:'完好',全盛:'完好',轻伤:'轻伤',小伤:'轻伤',微伤:'轻伤',重伤:'重伤',伤重:'重伤',大伤:'重伤',濒死:'濒死',将死:'濒死',垂危:'濒死',已死:'已死',死亡:'已死',击杀:'已死',阵亡:'已死'},M={无:'无','':'无',无劫:'无',雷劫:'雷劫',天雷:'雷劫',雷:'雷劫',心劫:'心劫',心魔:'心劫',魔劫:'心劫',天劫:'天劫',大劫:'天劫',情劫:'情劫',情关:'情劫',因果劫:'因果劫',因果:'因果劫',红尘劫:'红尘劫',红尘:'红尘劫',轮回劫:'轮回劫',轮回:'轮回劫'},x={小劫:'小劫',小:'小劫',初级:'小劫',中劫:'中劫',中:'中劫',中级:'中劫',大劫:'大劫',大:'大劫',高级:'大劫',天罚:'天罚',天:'天罚',极:'天罚',天道:'天罚'},y={无:'无','':'无',未渡劫:'无',成功:'成功',通过:'成功',渡过:'成功',失败:'失败',未过:'失败',失:'失败'},v=e.z.object({正在战斗:e.z.boolean().prefault(!1),当前状态:e.z.string().transform(r=>b[r]||'非战斗').prefault('非战斗'),灵力值:e.z.coerce.number().transform(r=>_.clamp(r,0,100)).prefault(100),伤势等级:e.z.string().transform(r=>d[r]||'无伤').prefault('无伤'),已用底牌:e.z.array(e.z.string()).prefault([]),战斗回合:e.z.coerce.number().prefault(0)}).prefault({正在战斗:!1,当前状态:'非战斗',灵力值:100,伤势等级:'无伤',已用底牌:[],战斗回合:0}),D=e.z.object({名称:e.z.string().prefault('未知敌人'),境界:e.z.string().prefault('未知'),战力评估:e.z.string().transform(r=>j[r]||'势均力敌').prefault('势均力敌'),状态:e.z.string().transform(r=>h[r]||'完好').prefault('完好'),特点:e.z.string().prefault('')}),w=e.z.object({正在渡劫:e.z.boolean().prefault(!1),劫种:e.z.string().transform(r=>M[r]||'无').prefault('无'),劫难等级:e.z.string().transform(r=>x[r]||'小劫').prefault('小劫'),当前阶段:e.z.coerce.number().transform(r=>_.clamp(r,0,9)).prefault(0),总阶段数:e.z.coerce.number().transform(r=>Math.max(1,r)).prefault(3),劫力承受:e.z.coerce.number().transform(r=>_.clamp(r,0,100)).prefault(100),已用护道:e.z.array(e.z.string()).prefault([]),劫难描述:e.z.string().prefault(''),触发原因:e.z.string().prefault(''),上次渡劫结果:e.z.string().transform(r=>y[r]||'无').prefault('无'),渡劫冷却:e.z.coerce.number().transform(r=>Math.max(0,r)).prefault(0),失败惩罚记录:e.z.string().prefault('')}).prefault({正在渡劫:!1,劫种:'无',劫难等级:'小劫',当前阶段:0,总阶段数:3,劫力承受:100,已用护道:[],劫难描述:'',触发原因:'',上次渡劫结果:'无',渡劫冷却:0,失败惩罚记录:''}),V=e.z.object({当前区域:e.z.string().prefault('未知之地'),所属层级:e.z.string().prefault('地层'),环境描述:e.z.string().prefault(''),危险度:e.z.coerce.number().prefault(10),可用通道:e.z.array(e.z.string()).prefault([]),导航信息:e.z.string().prefault('')}).prefault({当前区域:'未知之地',所属层级:'地层',环境描述:'',危险度:10,可用通道:[],导航信息:''}),C=e.z.object({姓名:e.z.string().prefault('无名氏'),宗门:e.z.string().prefault('散修'),出身:e.z.string().prefault('凡人')}).prefault({姓名:'无名氏',宗门:'散修',出身:'凡人'}),N=e.z.object({等级:e.z.coerce.number().transform(r=>_.clamp(r,1,36)).prefault(1),修为:e.z.coerce.number().transform(r=>Math.max(0,r)).prefault(0),灵根:e.z.string().prefault('五行杂灵根'),体质:e.z.string().prefault('凡体'),功法:e.z.string().prefault('无'),本命兵器:e.z.string().prefault('无'),神通列表:e.z.record(e.z.string().describe('神通名'),f).prefault({}),灵石:e.z.coerce.number().transform(r=>Math.max(0,r)).prefault(0),已活岁月:e.z.coerce.number().transform(r=>Math.max(0,r)).prefault(0),尝试突破:e.z.boolean().prefault(!1),行踪:V,身份:C,背包:i,法宝:i,杂物袋:i,战斗状态:v,当前敌人:e.z.array(D).prefault([]),渡劫状态:w}).prefault({等级:1,修为:0,灵根:'五行杂灵根',体质:'凡体',功法:'无',本命兵器:'无',神通列表:{},灵石:0,已活岁月:0,尝试突破:!1,行踪:{当前区域:'未知之地',所属层级:'地层',环境描述:'',危险度:10,可用通道:[],导航信息:''},身份:{姓名:'无名氏',宗门:'散修',出身:'凡人'},背包:{},法宝:{},杂物袋:{},战斗状态:{正在战斗:!1,当前状态:'非战斗',灵力值:100,伤势等级:'无伤',已用底牌:[],战斗回合:0},当前敌人:[],渡劫状态:{正在渡劫:!1,劫种:'无',劫难等级:'小劫',当前阶段:0,总阶段数:3,劫力承受:100,已用护道:[],劫难描述:'',触发原因:'',上次渡劫结果:'无',渡劫冷却:0,失败惩罚记录:''}}).transform(r=>{const e=l(r,!0);return{...r,...e}}),P=e.z.object({名称:e.z.string().prefault(''),类型:e.z.enum(['主线','支线','每日','临危受命','秘境探索']).prefault('主线'),目标:e.z.string().prefault(''),状态:e.z.enum(['进行中','已完成','已失败']).prefault('进行中'),秘境信息:e.z.object({域:e.z.enum(['天层','神州','东苍','南炎','西庚','北冥','下层','四海']).optional(),危:e.z.coerce.number().transform(r=>_.clamp(r,0,100)).optional(),特:e.z.string().optional(),奖:e.z.union([e.z.array(e.z.string()),e.z.string().transform(r=>r?[r]:[])]).prefault([]),限:e.z.string().optional()}).optional(),创建时间:e.z.union([e.z.coerce.number(),e.z.string().transform(()=>Date.now())]).prefault(()=>Date.now())}),S=e.z.object({值:e.z.coerce.number().transform(r=>_.clamp(r,-100,100)).prefault(0),关系:e.z.string().prefault('陌生'),更新时间:e.z.coerce.number().prefault(()=>Date.now())}),U=e.z.record(e.z.string().describe('势力名'),S).prefault({}).transform(r=>_(r).mapValues(r=>{const e=r.值;let t;t=e>=80?'盟友':e>=60?'友善':e>=30?'友好':e>=10?'中立偏好':e>=-10?'中立':e>=-30?'中立偏恶':e>=-60?'敌对':e>=-80?'仇恨':'不死不休';const n=r.关系&&'陌生'!==r.关系?r.关系:t;return{...r,关系:n}}).value()),k=e.z.object({名称:e.z.string().prefault(''),来源:e.z.string().prefault(''),类型:e.z.enum(['探索','任务','交易','结交','争夺','修炼','红颜','随机']).prefault('探索'),描述:e.z.string().prefault(''),回报预期:e.z.string().prefault(''),风险评估:e.z.string().prefault(''),时限:e.z.string().optional(),关联事件:e.z.string().optional(),优先级:e.z.coerce.number().transform(r=>_.clamp(r,1,5)).prefault(3)}),B=e.z.object({地:e.z.string().describe('所在地'),特:e.z.string().describe('核心特点'),力:e.z.string().describe('最高战力'),营:e.z.enum(['正','魔','中']),模:e.z.enum(['超大','大','小','微','特'])}),F=e.z.object({阶:e.z.string().transform(r=>u[r]||'凡').catch('凡'),性:e.z.string().describe('属性'),效:e.z.string().describe('效果')}),I=e.z.object({阶:e.z.enum(['凡器','法器','灵器','法宝','灵宝','仙器','圣器','道器','本命']),类:e.z.string().describe('类型'),本命特性:e.z.string().optional().describe('本命法宝独有特性'),器灵:e.z.string().optional().describe('器灵名称')}).transform(r=>({...r,特:'本命'===r.阶?'至尊':'道器'===r.阶?'超凡':'圣器'===r.阶?'极品':'仙器'===r.阶?'顶级':'灵宝'===r.阶?'强':'法宝'===r.阶?'中':'普通'})),O=e.z.object({域:e.z.enum(['天层','神州','东苍','南炎','西庚','北冥','下层','四海']),类:e.z.enum(['秘境','城镇','宗门','禁地','遗迹','地形']),危:e.z.coerce.number().transform(r=>_.clamp(r,0,100)),特:e.z.string().describe('特点'),资:e.z.union([e.z.array(e.z.string()),e.z.string().transform(r=>r?[r]:[])]).prefault([])}),q=e.z.object({质:e.z.enum(['劣','下','中','上','极','天','异']),性:e.z.string().describe('属性'),稀:e.z.enum(['常','少','罕','稀','传'])}).transform(r=>({...r,速:{劣:'0.3倍',下:'0.5倍',中:'1倍',上:'2倍',极:'3倍',天:'5倍',异:'4倍'}[r.质]||'1倍',特:'天'===r.质?'单系顶级':'异'===r.质?'变异稀有':'极'===r.质?'双系优秀':'常规'})),A=e.z.object({质:e.z.enum(['凡','灵','道','圣','神']),特:e.z.string().describe('特性'),稀:e.z.enum(['常','少','罕','稀','传'])}).transform(r=>({...r,优:'神'===r.质?'至高':'圣'===r.质?'极强':'道'===r.质?'强':'灵'===r.质?'中':'无'})),E=e.z.object({世界时钟:e.z.object({纪元:e.z.string().prefault('末法时代'),年份:e.z.coerce.number().prefault(1),月份:e.z.coerce.number().transform(r=>_.clamp(r,1,12)).prefault(1),日期:e.z.coerce.number().transform(r=>_.clamp(r,1,30)).prefault(1),时辰:e.z.string().prefault('子时')}).prefault({纪元:'末法时代',年份:1,月份:1,日期:1,时辰:'子时'}),世界地图:e.z.record(e.z.string().describe('区域名'),e.z.object({layer:e.z.enum(['天层','地层','下层']).prefault('地层'),danger:e.z.coerce.number().transform(r=>_.clamp(r,0,100)),desc:e.z.string().prefault(''),connections:e.z.array(e.z.string()).prefault([])})).prefault({}),世界图志:e.z.record(e.z.string().describe('事件名'),e.z.object({状态:e.z.string().prefault(''),事件:e.z.string().prefault('')})).prefault({}),宗门势力库:e.z.record(e.z.string().describe('宗门名'),B).prefault({剑阁:{地:'神州剑门关',特:'剑道源头',力:'渡劫后期',营:'正',模:'超大'},万法宗:{地:'神州问道峰',特:'万法本源',力:'渡劫初期',营:'正',模:'超大'},金刚寺:{地:'西天佛山',特:'佛修炼体',力:'大乘中期',营:'正',模:'大'},药王谷:{地:'神农架',特:'医炼丹药',力:'大乘初期',营:'正',模:'大'},儒门:{地:'文圣山',特:'浩然正气',力:'大乘中期',营:'正',模:'大'},青龙殿:{地:'东苍青龙山',特:'守护青帝',力:'大乘初期',营:'正',模:'大'},玄武宗:{地:'北冥玄冰山',特:'镇守归墟',力:'大乘后期',营:'正',模:'大'},青云门:{地:'神州青云山',特:'水脉一系',力:'大乘初期',营:'正',模:'大'},建木宗:{地:'东苍建木树',特:'木系道法',力:'合体中期',营:'正',模:'小'},百花谷:{地:'百花秘境',特:'女修花道',力:'合体后期',营:'正',模:'小'},血神教:{地:'血魔渊',特:'血道炼法',力:'渡劫中期',营:'魔',模:'超大'},天魔宗:{地:'天魔山',特:'天魔大道',力:'大乘中期',营:'魔',模:'大'},妖盟:{地:'万妖森林',特:'妖族联盟',力:'渡劫中期',营:'中',模:'超大'},大夏王朝:{地:'中州皇城',特:'世俗统治',力:'大乘初期',营:'中',模:'大'},九州商会:{地:'九大主城',特:'商业联盟',力:'大乘初期',营:'中',模:'大'},离火宫:{地:'南炎火山',特:'朱雀供奉',力:'合体圆满',营:'中',模:'小'},铸剑山庄:{地:'南炎地火',特:'炼器第一',力:'合体后期',营:'中',模:'小'}}),功法库:e.z.record(e.z.string().describe('功法名'),F).prefault({}),法宝库:e.z.record(e.z.string().describe('法宝名'),I).prefault({镇渊剑:{阶:'仙器',类:'剑'},双鱼佩:{阶:'本命',类:'玉佩',本命特性:'源血契约、阴阳双生、器灵化形、与主共修、生死相依、锁血护主',器灵:'虞汐颜'}}),地点库:e.z.record(e.z.string().describe('地点名'),O).prefault({天渊:{域:'天层',类:'禁地',危:95,特:'星辰裂隙',资:['星辰碎片','陨铁']},罡风带:{域:'天层',类:'禁地',危:90,特:'罡风屏障',资:['罡风精华']},问道峰:{域:'神州',类:'宗门',危:10,特:'万法宗',资:['功法','灵药']},剑门关:{域:'神州',类:'宗门',危:15,特:'剑阁',资:['剑意','飞剑']},藏书阁:{域:'神州',类:'宗门',危:5,特:'古籍',资:['功法','秘术']},酆都城:{域:'神州',类:'城镇',危:30,特:'鬼市',资:['幽冥材料']},龙门瀑:{域:'神州',类:'秘境',危:40,特:'化龙',资:['龙气']},建木林:{域:'东苍',类:'地形',危:50,特:'古树精',资:['灵木','妖丹']},青帝陵:{域:'东苍',类:'遗迹',危:85,特:'青帝传承',资:['青帝传承']},百花境:{域:'东苍',类:'秘境',危:20,特:'花海',资:['灵花']},不灭火山:{域:'南炎',类:'地形',危:80,特:'朱雀涅槃',资:['朱雀火']},涅槃台:{域:'南炎',类:'遗迹',危:70,特:'涅槃',资:['涅槃感悟']},万剑冢:{域:'西庚',类:'禁地',危:85,特:'剑意',资:['剑意','古剑']},玄冰山:{域:'北冥',类:'宗门',危:50,特:'玄武宗',资:['玄冰']},归墟眼:{域:'北冥',类:'禁地',危:99,特:'归墟',资:['归墟感悟']},黄泉迹:{域:'下层',类:'遗迹',危:90,特:'幽冥',资:['黄泉水']},炎渊:{域:'下层',类:'禁地',危:95,特:'地心火',资:['地心火']}}),灵根库:e.z.record(e.z.string().describe('灵根名'),q).prefault({}),体质库:e.z.record(e.z.string().describe('体质名'),A).prefault({}),本尊:N,红颜角色库:e.z.record(e.z.string().describe('角色名'),p).prefault({许听雨:{级:33,根:'水本源天',质:'归墟神体',龄:'外26实12000',属:'归墟之主',法:'万水归源先天',器:'沧海遗珠先天',通:['归墟歌','逆流虚妄','寂灭海域','万水同源']},虞汐颜:{级:12,根:'水阴阳异',质:'双鱼体',龄:'化形0年',属:'{{user}}玉佩',法:'双生天极/阴阳',器:'双鱼佩本体',通:['枯木春','夺命妆','双鱼梦']},白清弦:{级:29,根:'金天根',质:'剑体',龄:'外30实1000+',属:'散修剑宗师',法:'剑意仙/天音天',器:'清弦琴剑灵宝',通:['琴剑杀','剑意歌','万剑心']},南宫云裳:{级:16,根:'火天根',质:'神凰道体',龄:'外10实118',属:'大夏栖凤宫主',法:'九转涅槃仙',器:'栖梧簪灵宝',通:['南明离火','凰威镇世','羽化虚空']},梦杳泠:{级:23,根:'瑞兽异根',质:'乘黄圣体',龄:'外8实万年+',属:'无(末代乘黄)',法:'乘黄本源天',器:'无',通:['瑞光庇佑','灵觉通明','本源爆发']},幻千丝:{级:13,根:'暗幻双根',质:'梦魇体',龄:'外20未知',属:'散修幽冥',法:'织梦天',器:'千丝网灵宝',通:['织梦笼','心魔境','千丝缚']},晚棠:{级:15,根:'幽冥灵根',质:'噬魂之体',龄:'未知',属:'散修',法:'幽冥归魂经天',器:'引魂铃灵宝',通:['冥河指引','冥莲沉梦','归魂摆舟']}}),红颜:e.z.record(e.z.string().describe('红颜名'),m).prefault({}),NPC图鉴:e.z.record(e.z.string().describe('NPC名'),g).prefault({}),任务列表:e.z.record(e.z.string().describe('任务ID'),P).prefault({}),声望系统:U,可参与机遇:e.z.array(k).prefault([]),当前处境:e.z.string().prefault('')});$(()=>{r(E),console.info('[灯火阑珊] MVU 变量结构已注册'),toastr.success('MVU 变量结构已成功注册','灯火阑珊')});
//# sourceMappingURL=index.js.map